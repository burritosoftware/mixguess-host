/*

 Rat is owned by Wahoo Studios, Inc.  See rat.js license.
 game-specific code is owned by Microsoft.

 howler.js v2.0.13
  howlerjs.com

  (c) 2013-2018, James Simpson of GoldFire Studios
  goldfirestudios.com

  MIT License
 Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.

  howler.js v2.0.13
  howlerjs.com

  (c) 2013-2018, James Simpson of GoldFire Studios
  goldfirestudios.com

  MIT License
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,d,a){c!=Array.prototype&&c!=Object.prototype&&(c[d]=a.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var d=0;return $jscomp.iteratorPrototype(function(){return d<c.length?{done:!1,value:c[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=c[Symbol.iterator];return d?d.call(c):$jscomp.arrayIterator(c)};
$jscomp.iteratorFromArray=function(c,d){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var a=0,b={next:function(){if(a<c.length){var e=a++;return{value:d(e,c[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(c,d,a,b){if(d){a=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var e=c[b];e in a||(a[e]={});a=a[e]}c=c[c.length-1];b=a[c];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
$jscomp.polyfill("Object.is",function(c){return c?c:function(c,a){return c===a?0!==c||1/c===1/a:c!==c&&a!==a}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(c){return c?c:function(c,a){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(a=a||0;a<e;a++)if(b[a]==c||Object.is(b[a],c))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(c,d,a){if(null==c)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return c+""};$jscomp.polyfill("String.prototype.includes",function(c){return c?c:function(c,a){return-1!==$jscomp.checkStringArgs(this,c,"includes").indexOf(c,a||0)}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(c){return c?c:function(c,a){var b=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var e=b.length,f=c.length;a=Math.max(0,Math.min(a|0,b.length));for(var d=0;d<f&&a<e;)if(b[a++]!=c[d++])return!1;return d>=f}},"es6","es3");$jscomp.owns=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)};
$jscomp.polyfill("Object.entries",function(c){return c?c:function(c){var a=[],b;for(b in c)$jscomp.owns(c,b)&&a.push([b,c[b]]);return a}},"es8","es3");$jscomp.polyfill("String.prototype.endsWith",function(c){return c?c:function(c,a){var b=$jscomp.checkStringArgs(this,c,"endsWith");c+="";void 0===a&&(a=b.length);a=Math.max(0,Math.min(a|0,b.length));for(var e=c.length;0<e&&0<a;)if(b[--a]!=c[--e])return!1;return 0>=e}},"es6","es3");
$jscomp.polyfill("Object.values",function(c){return c?c:function(c){var a=[],b;for(b in c)$jscomp.owns(c,b)&&a.push(c[b]);return a}},"es8","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function d(){this.batch_=null}function a(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var b=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(a){b(a,
0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(e){c||(c=!0,a.call(b,e))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new d;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{f(a(b))}catch(v){d(v)}}:b}var f,d,g=new e(function(a,
b){f=a;d=b});this.callWhenSettled_(c(a,f),c(b,d));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=a;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(b){return new e(function(c,
e){for(var f=$jscomp.makeIterator(b),d=f.next();!d.done;d=f.next())a(d.value).callWhenSettled_(c,e)})};e.all=function(b){var c=$jscomp.makeIterator(b),f=c.next();return f.done?a([]):new e(function(b,e){function d(a){return function(c){m[a]=c;g--;0==g&&b(m)}}var m=[],g=0;do m.push(void 0),g++,a(f.value).callWhenSettled_(d(m.length-1),e),f=c.next();while(!f.done)})};return e},"es6","es3");
$jscomp.polyfill("Array.from",function(c){return c?c:function(c,a,b){$jscomp.initSymbolIterator();a=null!=a?a:function(a){return a};var e=[],f=c[Symbol.iterator];if("function"==typeof f)for(c=f.call(c);!(f=c.next()).done;)e.push(a.call(b,f.value));else{f=c.length;for(var d=0;d<f;d++)e.push(a.call(b,c[d]))}return e}},"es6","es3");function load(){rat.load({exclude:[],addAsync:["js/app.js","js/utils/howler.js"],addSync:[],update:function(c){},done:function(){app.init()}})}console.log("-- MixGuess loading --");
rat.console.logPrefix="/";rat.load.setEntryPoint(load);var app={release:!1,types:{},id:"pe"};
rat.modules.add("js.app","rat.debug.r_console rat.debug.r_argus rat.debug.r_show_set rat.os.r_system rat.storage.r_storage rat.graphics.r_graphics rat.utils.r_utils rat.utils.r_string rat.audio.r_audio_howler rat.live.r_telemetry_manager rat.live.r_telemetry_data js.mixer_participant js.message_track js.user_info_manager js.audio js.game js.data.data js.event_manager js.graphics.gfx js.graphics.effects js.graphics.background_effects js.ui.ui js.ui.game_screen js.ui.ready_screen js.ui.waiting_screen js.ui.mod_permission_screen js.ui.ui_audio".split(" "),function(c){window.reportError=
function(d,a){if(!0===window.reportErrorsToGC){for(var b=JSON.stringify(d),e=0;e<window.reportedErrors.length;e++)if(window.reportedErrors[e].errorString===b){window.reportedErrors[e].count++;return}window.reportedErrors.push({errorString:b,count:1});d&&peSync&&(c.console.log("sending error report with error: "+b),peSync.sendMessageWithCode("error_report",{message:b,severity:a}))}};window.reportedErrors=[];window.myGlobalErrorHandler=function(d,a,b,e,f){c&&c.console&&(c.console.log("XERROR: uncaught exception : "+
d),f&&c.console.dumpValue(f),window.reportError(d,"error"))};window.onerror=window.myGlobalErrorHandler;console.log("-- MixGuess PE loading --");app.versionInfo&&c.console.redirectSystemConsole();app.defaultSettings={version:1,soundOn:!0,musicOn:!1,actionPanelOn:!1,sparkBoardActive:!1,modView:!0,admin:!1,showIntro:!0,seenSparkButton:!1,debug:{set:{},show:{}},chatBot:{active:!1,settings:{newOffer:!0,newRound:!0,endRound:!0,resolution:!1}},playerActionButtons:{},autoFeeds:{},watchFor:{enabled:!0},gamePrefs:{}};
app.settings={};app.supportedGamesList={};app.playerActionButtonsUserCooldown=[];for(i=0;15>i;i++)app.playerActionButtonsUserCooldown.push(!1);app.playerActionInfo={acceptedOfferCount:0,adjustedValues:0};app.config={IDEAL_W:1920,IDEAL_H:1080,TOP_STRIP_H:60,STRIP_H:13,SIDE_W:130,RIGHT_SIDE_W:0,UI_Y_OFFSET_PERCENT:6E3/1080,UI_X_OFFSET_PERCENT:6.78,UI_RIGHT_OFFSET_PERCENT:0,MAX_OFFER_SLOTS:5};app.connected=!0;app.platform="web";app.platform="web";c.system.has.msAppHost&&!c.system.has.mobile&&(app.platform=
"xbox");c.system.has.mobile&&(app.platform="mobile");"mobile"===app.platform&&(app.config.IDEAL_W=900,app.config.IDEAL_H=900,app.config.UI_Y_OFFSET_PERCENT=0,app.config.UI_X_OFFSET_PERCENT=0);app.browser="unknown";(function(){if(!0===(!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/")))app.browser="opera";else if("undefined"!==typeof InstallTrigger===!0)app.browser="firefox";else if(!0===(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===
(!window.safari||"undefined"!==typeof safari&&safari.pushNotification).toString()))app.browser="safari";else{var c=!!document.documentMode;!0===c?app.browser="ie":!0===(!c&&!!window.StyleMedia)?app.browser="edge":!0===(!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime))&&(app.browser="chrome")}})();app.os="unknown";(function(){var c=window.navigator.userAgent,a=window.navigator.platform,b=["Win32","Win64","Windows","WinCE"],e=["iPhone","iPad","iPod"];-1!==["Macintosh","MacIntel",
"MacPPC","Mac68K"].indexOf(a)?app.os="macOS":-1!==e.indexOf(a)?app.os="iOS":-1!==b.indexOf(a)?app.os="windows":/Android/.test(c)?app.os="android":""!==app.os&&/Linux/.test(a)&&(app.os="linux")})();app.canvasElement=null;app.ctx=null;app.state="loading";app.visibility="visible";app.init=function(){c.console.copyToSystem=!0;app.versionInfo&&(c.console.copyToSystem=!1);c.console.log("--- PE app.init");app.startTime=Date.now();var d=document.getElementById("canvas");app.canvasElement=d;app.ctx=d.getContext("2d");
d={useProtectedCycle:!0,protectedCycleAllowMultipleErrors:!0,protectedCycleErrorHandler:function(a){window.reportError(a.toString(),"error")}};c.init(void 0,"xbox"===app.platform&&!0===window.reportErrorsToGC?d:void 0);app.mixer=mixerParticipant;app.mixer.initMixer();messageTrack.init();audio.init();c.system.has.msAppHost||(c.audio.suppressSound=!0);ui.init();c.string.init(["strings/strings.xml"]);c.string.selectLanguage();c.string.setDefaultLanguage("english");c.string.setAutoTokenReplacement("{CREDITS}",
peSync.creditName);c.string.setAutoTokenReplacement("{USERNAME}",peSync.playerInfo.username);c.string.setAutoTokenReplacement("{A_BUTTON}",c.ui.TextBox.makeSpecialImageString("a_button"));c.string.setAutoTokenReplacement("{B_BUTTON}",c.ui.TextBox.makeSpecialImageString("b_button"));c.string.setAutoTokenReplacement("{SPARK}",c.ui.TextBox.makeSpecialImageString("mixer_spark_emblem"));app.setupGraphics();c.setDraw(app.draw);c.setPostUIDraw(app.postDraw);c.setUpdate(app.update);c.addEventListener("resize",
app.resizeHandler,null,0);app.setupDebugging();c.graphics.preLoadImages([]);gfx.oneTimeInit();effects.oneTimeInit();backgroundEffects.oneTimeInit();game.oneTimeInit();app.eventManager.oneTimeInit();app.initTelemetry();app.storage=c.storage.getStorage(c.storage.permanentLocal);app.storage.setPrefix("mixbethost_");app.readSettings();c.debug.showSet.configure(app.settings.debug,app.writeSettings);app.state="loading";c.addEventListener("visibility",function(a){app.visibility=a;audio.visibilityChange(a);
game.hud&&game.hud.actionLog&&game.hud.actionLog.rebuildLogs()});c.console.log("--- app.init done")};app.initAfterLoad=function(){app.detectMixerPlatform();gfx.initAfterLoad();game.initAfterLoad();var d="game";app.settings.debug.skipTo&&(d=app.settings.debug.skipTo);app.gotoScreen(d);peSync.init();app.mixer.initMixerEvents();app.mixer.mixerAfterLoad();game.hud.checkForWaitingScreen();c.console.log("app.platform: "+app.platform+", integrated: "+app.isIntegratedMode());c.console.log(navigator.userAgent);
"xbox"===app.platform||app.isIntegratedMode()||document.hasFocus()||(c.console.log(">> pe APP focus after load"),app.canvasElement.focus());app.xboxMixerPreventExit();c.console.log("initAfterLoad done")};app.xboxMixerPreventExit=function(){"xbox"!==app.platform||null==mixerParticipant.mixerHandle&&null==mixerParticipant.mixerHandle.navigation||(0!==app.canvasElement.tabIndex&&(c.console.log("PreventExit: setting tab index to 0 from "+app.canvasElement.tabIndex),app.canvasElement.tabIndex=0),!1===
document.hasFocus()&&(c.console.log(">> PreventExit: setting focus"),app.canvasElement.focus()),mixerParticipant.mixerHandle.navigation.preventExit())};app.xboxMixerAllowExit=function(){"xbox"!==app.platform||null==mixerParticipant.mixerHandle&&null==mixerParticipant.mixerHandle.navigation||mixerParticipant.mixerHandle.navigation.allowExit()};app.xboxMixerExitInteractive=function(){"xbox"!==app.platform||null==mixerParticipant.mixerHandle&&null==mixerParticipant.mixerHandle.navigation||mixerParticipant.mixerHandle.navigation.rpc.call("focusOut",
{},!1)};app.initTelemetry=function(){};app.setupDebugging=function(){c.console.maxLogLines=1E3;c.console.config.bgColor="rgba(0,0,0,0.7)";c.console.config.textColor="#FFFFA0";c.console.config.identifier="PE CONSOLE";c.console.allow(!app.release);c.console.setTextSize(24);c.console.registerCommand("exception",function(c,a){if(a[0])throw a[0];throw{name:"my error",message:"is a custom error"};},["throw","crash"]);c.console.registerCommand("clearsettings",function(c,a){app.clearSettings()},["reset",
"resetsettings"]);c.console.registerCommand("donateSparks",function(c,a){mixer&&mixer.socket.call("giveInput",{controlID:"mixguess-sparkSpend0",event:"mousedown",button:0})},[]);c.console.registerCommand("initGCTest",function(c,a){c=a[0]?parseInt(a[0]):void 0;var b=a[1]?"true"===a[1]:void 0;a=a[2]?parseInt(a[2]):void 0;peSync.sendCommandMessage({command:"window.test.gcTest.init("+c+", "+b+", "+a+");"})},[]);c.console.registerCommand("pauseGCTest",function(c,a){peSync.sendCommandMessage({command:"window.test.gcTest.pause();"})},
[]);c.console.registerCommand("resumeGCTest",function(c,a){peSync.sendCommandMessage({command:"window.test.gcTest.resume();"})},[]);c.console.registerCommand("enableLogType",function(c,a){null!=a[0]&&peSync.sendCommandMessage({command:'logFile.setSetting("'+a[0]+'", true);'})},[]);c.console.registerCommand("disableLogType",function(c,a){null!=a[0]&&peSync.sendCommandMessage({command:'logFile.setSetting("'+a[0]+'", false);'})},[]);c.console.registerCommand("setLanguage",function(c,a){null!=a[0]&&peSync.setLanguage(a[0])},
[]);c.console.registerCommand("skipTo",function(c,a){(c=a[0])?("'"===c.charAt(0)&&(c=c.substring(1,c.length-1)),app.skipTo(c)):(delete app.settings.debug.skipTo,app.writeSettings())},["skip"]);c.console.registerCommand("userid",function(d,a){(d=a[0])?(d=parseInt(d),isNaN(d)?c.console.log("invalid id "+a[0]):(app.settings.debug.fakeMixerUserID=d,app.settings.debug.fakeMixerUserIDSet=!0,app.writeSettings())):c.console.log("Current fake mixer userID: "+app.settings.debug.fakeMixerUserID)},["setuserid"]);
c.console.registerCommand("nomod",function(c,a){app.applyDebugModOwnerFlags({canEdit:!1,canConfig:!1,isOwner:!1,save:a[0]})});c.console.registerCommand("mod",function(c,a){app.applyDebugModOwnerFlags({canEdit:!0,canConfig:!0,save:a[0]})});c.console.registerCommand("modedit",function(c,a){app.applyDebugModOwnerFlags({canEdit:!0,canConfig:!1,save:a[0]})});c.console.registerCommand("modconfig",function(c,a){app.applyDebugModOwnerFlags({canEdit:!1,canConfig:!0,save:a[0]})});c.console.registerCommand("noowner",
function(c,a){app.applyDebugModOwnerFlags({isOwner:!1,save:a[0]})});c.console.registerCommand("owner",function(c,a){app.applyDebugModOwnerFlags({isOwner:!0,canEdit:!0,canConfig:!0,save:a[0]})});c.console.registerCommand("winner",function(c,a){peSync.fakeRoundResults()},["showwinner","showwinners"]);c.console.registerCommand("watch",function(c,a){(c=a[0])?peSync.sendCommandMessage({command:'app.debugSetWatchName("'+c+'");'}):peSync.sendCommandMessage({command:"app.debugSetWatchName(null);"})},["watchfor"]);
c.console.registerCommand("reloadServer",function(c,a){peSync.sendMessageWithCode("reload_server",{})},["resetServer"]);c.console.registerCommand("queryPlayer",function(c,a){a[0]&&peSync.sendMessageWithCode("query_player_data",{playerName:""+a[0]})},["queryPlayerData","queryUser"]);c.console.registerCommand("queryValue",function(d,a,b){a[0]&&(d=b.indexOf(" ")+1,0<=d&&(b=b.substring(d),c.console.log("query value : "+b),peSync.sendMessageWithCode("query_value",{value:""+b})))});c.console.registerCommand("exportStats",
function(c,a){peSync.sendMessageWithCode("export_stats");peSync.waitingForStats=!0});c.console.registerCommand("exportLog",function(c,a){c=2E3;a[0]&&(c=parseInt(a[0]));var b=-1;a[1]&&(b=parseInt(a[1]));peSync.sendMessageWithCode("export_log",{lineCount:c,startingLine:b});peSync.waitingForLog=!0});c.console.registerCommand("exportRatLog",function(c,a){c=2E3;a[0]&&(c=parseInt(a[0]));var b=-1;a[1]&&(b=parseInt(a[1]));peSync.sendMessageWithCode("export_rat_log",{lineCount:c,startingLine:b});peSync.waitingForRatLog=
!0});c.console.registerCommand("exportErrorLog",function(c,a){c=2E3;a[0]&&(c=parseInt(a[0]));var b=-1;a[1]&&(b=parseInt(a[1]));peSync.sendMessageWithCode("export_error_log",{lineCount:c,startingLine:b});peSync.waitingForLog=!0});c.console.registerCommand("keyword",function(c,a,b){a[0]&&(a[1]?(c=b.indexOf(a[0])+a[0].length+1,b=b.substring(c),peSync.sendMessageWithCode("set_keyword",{keyword:a[0],value:b})):peSync.sendMessageWithCode("set_keyword",{keyword:a[0],value:null}))});c.console.registerCommand("custommessage",
function(c,a,b){a[0]&&(c=b.indexOf(a[0]),b=b.substring(c),peSync.sendCustomMessage(b))});c.console.registerCommand("mixopen",function(c,a,b){mixer&&mixer.navigation&&mixer.navigation.openLink&&mixer.navigation.openLink("http://mixer.com")});messageTrack.registerCommands();c.console.registerCommand("guesszonemessage",function(d,a,b){(a=a||[],-1==a.indexOf("-help"))&&a[0]?(a[0]=a[0].toUpperCase(),peSync.sendMessageWithCode("GZ_"+a[0],{text:a[1]||""})):(c.console.log("GzMsg Syntax:"),c.console.log("  guesszonemessage -help  : show this help."),
c.console.log("  guesszonemessage <code> [message] : the mesage to send."))},["gzmsg","gzmessage","guesszonemsg"])};app.applyDebugModOwnerFlags=function(c){void 0!==c.canEdit&&(app.settings.debug.canEdit=c.canEdit);void 0!==c.canConfig&&(app.settings.debug.canConfig=c.canConfig);void 0!==c.isOwner&&(app.settings.debug.isOwner=c.isOwner);peSync.setAndShowPermissions(c);peSync.displayStateChange(peSync.knownGlobalState.displayState);void 0===c.save||!0!==c.save&&"save"!==c.save||app.writeSettings()};
app.setupGraphics=function(){var d=app.config.IDEAL_W,a=app.config.IDEAL_H;"web"===app.platform&&(app.tooltipLayer=c.screenManager.makeTooltipContext(app.canvasElement));app.hasMixer&&"mobile"!==app.platform&&app.mixer.setupViewHandler({idealW:d,idealH:a,moveVideoPercent:{x:app.config.UI_X_OFFSET_PERCENT,right:app.config.UI_RIGHT_OFFSET_PERCENT,y:app.config.UI_Y_OFFSET_PERCENT},moveCanvasPercent:{x:0,y:0}});c.graphics.autoClearCanvas=!0;c.graphics.autoClearColor="";app.resizeHandler()};app.isModMixer=
function(){return peSync.permissions.canConfig};app.isModConfig=function(){return peSync.permissions.canConfig&&app.settings.modView};app.isModEdit=function(){return peSync.permissions.canEdit&&app.settings.modView};app.isModAny=function(){return(peSync.permissions.canEdit||peSync.permissions.canConfig)&&app.settings.modView};app.isOwner=function(){return peSync.permissions.isOwner&&app.settings.modView};app.isIntegratedMode=function(){return window.mixIntegratedHost||window.mixIntegratedFrame};app.isIntegratedElectron=
function(){return window.mixIntegratedFrame&&window.top&&window.top.rat&&window.top.rat.system.has.electron};app.getIntegratedServer=function(){return window.frames.length&&window.frames[0].server&&window.frames[0].server.receiveMessage?window.frames[0].server:window.mixIntegratedFrame&&window.top.server&&window.top.server.receiveMessage?window.top.server:null};app.getIntegratedSync=function(){return window.frames.length&&window.frames[0].gcSync?window.frames[0].gcSync:window.mixIntegratedFrame&&
window.top.gcSync?window.top.gcSync:null};app.detectMixerPlatform=function(){if(window.mixer&&mixer.display){c.console.log("checking mixer settings...");var d=mixer.display.settings();d&&d.value&&(c.console.log("mixer reports platform "+d.value.platform),c.console.log(d.value))}};app.updateMixerVideoPosition=function(c){if("mobile"!==app.platform){var a=app.config.UI_X_OFFSET_PERCENT,b=app.config.UI_Y_OFFSET_PERCENT,e=app.config.UI_RIGHT_OFFSET_PERCENT;"hide"===c&&!1===app.isModConfig()&&(b=e=a=0);
c={idealW:app.config.IDEAL_W,idealH:app.config.IDEAL_H,moveVideoPercent:{x:a,right:e,y:b},moveCanvasPercent:{x:app.config.UI_X_OFFSET_PERCENT,y:app.config.UI_Y_OFFSET_PERCENT}};"web"===app.platform&&(c.animateOffsetTime=.4);mixerParticipant.setViewOpts(c);mixerParticipant.setPlayerPosition();"web"!==app.platform&&setTimeout(mixerParticipant.setPlayerPosition,5)}};app.gotoScreen=function(d,a){c.screenManager.popAllScreens();var b;"ready"===d&&(b=new app.types.ReadyScreen);"game"!==d&&b?(app.state=
"menus",b?c.screenManager.pushScreen(b):c.console.log("Error: tried to go to unknown screen."+d)):app.gotoGame()};app.gotoGame=function(){game.init();app.state="play"};app.resizeHandler=function(){var d=c.utils.getWindowSize();if("mobile"===app.platform||!app.hasMixer){var a=d.w;d=d.h;if(a>=d){var b=d/app.config.IDEAL_H;c.graphics.SCREEN_HEIGHT=app.config.IDEAL_H;c.graphics.SCREEN_WIDTH=a/d*app.config.IDEAL_H+1|0}else b=a/app.config.IDEAL_W,c.graphics.SCREEN_WIDTH=app.config.IDEAL_W,c.graphics.SCREEN_HEIGHT=
d/a*app.config.IDEAL_W+1|0;app.canvasElement.width=c.graphics.SCREEN_WIDTH;app.canvasElement.height=c.graphics.SCREEN_HEIGHT;app.canvasElement.style.width=""+a+"px";app.canvasElement.style.height=""+d+"px";c.graphics.outerScale=b}c.screenManager.updateTooltipContext();ui.resizeHandler()};app.update=function(d){if("loading"===app.state){var a=function(){if(window.mixIntegratedHost){if(window.frames.length&&window.frames[0].app&&"gc"===window.frames[0].app.id&&("play"==window.frames[0].app.state||"menus"==
window.frames[0].app.state))return!0;app.waitTimer=app.waitTimer||0;app.waitTimer+=d;1<app.waitTimer&&(app.waitTimer=0,c.console.log("waiting for integrated GC to load."));return!1}return!0},b=Date.now()-app.startTime;c.graphics.isCacheLoaded()&&c.audio.isCacheLoaded()&&a()&&c.string.isReady()&&(c.console.log("Load complete: "+b+" ms"),app.initAfterLoad())}else"play"===app.state&&(game.update(d),app.eventManager.update(d));peSync.update(d);gfx.update(d);effects.update(d);backgroundEffects.update(d);
mixerParticipant.update(d);audio.update(d)};app.draw=function(){var d=app.ctx,a=c.graphics.SCREEN_WIDTH,b=c.graphics.SCREEN_HEIGHT;"loading"===app.state?(d.fillStyle="rgba(0,0,0,0.5)",d.fillRect(.3*a,.435*b,.4*a,.1*b),d.font="42px "+ui.config.mainFont.font,d.textAlign="left",d.fillStyle="#FFFFFF",d.fillText("Loading...",.45*a,b/2,.5*a)):"play"===app.state&&(app.settings.debug.show.frame&&(d.strokeStyle="#808080",d.lineWidth=8,d.strokeRect(0,0,a,b)),game.draw(d))};app.drawVersion=function(){var d=
"v. ";d=app.versionInfo?d+app.versionInfo.version:d+" dev";var a=c.graphics.getContext();a.fillStyle="rgba(250, 250, 250, 0.5)";var b=c.graphics.SCREEN_HEIGHT-20;c.system.kong&&c.system.kong.fake&&(d+=" F");a.font="24px "+ui.mainFontName;a.textAlign="left";a.fillText(d,10,b,800)};app.postDraw=function(){var d=c.graphics.getContext();if(app.settings.debug.show.inputmap&&c.screenManager.getTopScreen()){var a=c.screenManager.getTopScreen().inputMap;a&&a.drawDebug(d)}};app.skipTo=function(d){app.settings.debug.skipTo=
d;app.writeSettings();c.console.log("set skipTo to "+d)};app.writeSettings=function(){app.storage.setObject("settings",app.settings)};app.readSettings=function(){c.console.log("read settings");var d=!1,a=app.storage.getObject("settings");a?app.settings=a:(app.settings=c.utils.copyObject(app.defaultSettings,!0),c.console.log("no settings"),d=!0);if("undefined"===typeof app.settings.userID){d=new Date;a=d.getUTCMonth();var b=d.getUTCDate();d=""+(d.getUTCFullYear()-2E3)+(9>a?"0":"")+(a+1)+(10>b?"0":
"")+b;app.settings.userID=d+"_"+c.utils.makeID(10);d=!0}c.utils.extendObject(app.settings,app.defaultSettings,!0);app.settings.chatBot.active=!1;"undefined"===typeof app.settings.debug&&(app.settings.debug={},d=!0);"undefined"===typeof app.settings.debug.fakeMixerUserID?(app.settings.debug.fakeMixerUserID=(1E5*Math.random()|0)+9E5,d=!0):"string"===typeof app.settings.debug.fakeMixerUserID&&(app.settings.debug.fakeMixerUserID=parseInt(app.settings.debug.fakeMixerUserID));d&&app.writeSettings();audio.updateFromSettings()};
app.clearSettings=function(){app.settings=c.utils.copyObject(app.defaultSettings,!0);app.writeSettings()};app.updateSupportedGamesList=function(c){app.supportedGamesList=c};app.openFeedback=function(){console.log("attempting to open email for feedback");mixerParticipant.openWindow("https://aka.ms/MixGuessBugReporter")}});
(function(){var c=function(){this.init()};c.prototype={init:function(){var a=this||d;a._counter=1E3;a._codecs={};a._howls=[];a._muted=!1;a._volume=1;a._canPlayEvent="canplaythrough";a._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;a.masterGain=null;a.noAudio=!1;a.usingWebAudio=!0;a.autoSuspend=!0;a.ctx=null;a.mobileAutoEnable=!0;a._setup();return a},volume:function(a){var b=this||d;a=parseFloat(a);b.ctx||l();if("undefined"!==typeof a&&0<=a&&1>=a){b._volume=a;if(b._muted)return b;
b.usingWebAudio&&b.masterGain.gain.setValueAtTime(a,d.ctx.currentTime);for(var c=0;c<b._howls.length;c++)if(!b._howls[c]._webAudio)for(var e=b._howls[c]._getSoundIds(),f=0;f<e.length;f++){var m=b._howls[c]._soundById(e[f]);m&&m._node&&(m._node.volume=m._volume*a)}return b}return b._volume},mute:function(a){var b=this||d;b.ctx||l();b._muted=a;b.usingWebAudio&&b.masterGain.gain.setValueAtTime(a?0:b._volume,d.ctx.currentTime);for(var c=0;c<b._howls.length;c++)if(!b._howls[c]._webAudio)for(var e=b._howls[c]._getSoundIds(),
f=0;f<e.length;f++){var m=b._howls[c]._soundById(e[f]);m&&m._node&&(m._node.muted=a?!0:m._muted)}return b},unload:function(){for(var a=this||d,b=a._howls.length-1;0<=b;b--)a._howls[b].unload();a.usingWebAudio&&a.ctx&&"undefined"!==typeof a.ctx.close&&(a.ctx.close(),a.ctx=null,l());return a},codecs:function(a){return(this||d)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||d;a.state=a.ctx?a.ctx.state||"running":"running";a._autoSuspend();if(!a.usingWebAudio)if("undefined"!==typeof Audio)try{var b=
new Audio;"undefined"===typeof b.oncanplaythrough&&(a._canPlayEvent="canplay")}catch(t){a.noAudio=!0}else a.noAudio=!0;try{b=new Audio,b.muted&&(a.noAudio=!0)}catch(t){}a.noAudio||a._setupCodecs();return a},_setupCodecs:function(){var a=this||d,b=null;try{b="undefined"!==typeof Audio?new Audio:null}catch(q){return a}if(!b||"function"!==typeof b.canPlayType)return a;var c=b.canPlayType("audio/mpeg;").replace(/^no$/,""),e=a._navigator&&a._navigator.userAgent.match(/OPR\/([0-6].)/g);e=e&&33>parseInt(e[0].split("/")[1],
10);a._codecs={mp3:!(e||!c&&!b.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!c,opus:!!b.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!b.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!b.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(b.canPlayType("audio/x-m4a;")||
b.canPlayType("audio/m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(b.canPlayType("audio/x-mp4;")||b.canPlayType("audio/mp4;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!b.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(b.canPlayType("audio/x-flac;")||b.canPlayType("audio/flac;")).replace(/^no$/,"")};return a},
_enableMobileAudio:function(){var a=this||d,b=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(a._navigator&&a._navigator.userAgent),c=!!("ontouchend"in window||a._navigator&&0<a._navigator.maxTouchPoints||a._navigator&&0<a._navigator.msMaxTouchPoints);if(!a._mobileEnabled&&a.ctx&&(b||c)){a._mobileEnabled=!1;a._mobileUnloaded||44100===a.ctx.sampleRate||(a._mobileUnloaded=!0,a.unload());a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var e=function(){d._autoResume();var b=a.ctx.createBufferSource();
b.buffer=a._scratchBuffer;b.connect(a.ctx.destination);"undefined"===typeof b.start?b.noteOn(0):b.start(0);"function"===typeof a.ctx.resume&&a.ctx.resume();b.onended=function(){b.disconnect(0);a._mobileEnabled=!0;a.mobileAutoEnable=!1;document.removeEventListener("touchstart",e,!0);document.removeEventListener("touchend",e,!0)}};document.addEventListener("touchstart",e,!0);document.addEventListener("touchend",e,!0);return a}},_autoSuspend:function(){var a=this;if(a.autoSuspend&&a.ctx&&"undefined"!==
typeof a.ctx.suspend&&d.usingWebAudio){for(var b=0;b<a._howls.length;b++)if(a._howls[b]._webAudio)for(var c=0;c<a._howls[b]._sounds.length;c++)if(!a._howls[b]._sounds[c]._paused)return a;a._suspendTimer&&clearTimeout(a._suspendTimer);a._suspendTimer=setTimeout(function(){a.autoSuspend&&(a._suspendTimer=null,a.state="suspending",a.ctx.suspend().then(function(){a.state="suspended";a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())}))},3E4);return a}},_autoResume:function(){var a=
this;if(a.ctx&&"undefined"!==typeof a.ctx.resume&&d.usingWebAudio)return"running"===a.state&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):"suspended"===a.state?(a.ctx.resume().then(function(){a.state="running";for(var b=0;b<a._howls.length;b++)a._howls[b]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):"suspending"===a.state&&(a._resumeAfterSuspend=!0),a}};var d=new c,a=function(a){a.src&&0!==a.src.length?this.init(a):console.error("An array of source files must be passed with any new Howl.")};
a.prototype={init:function(a){var b=this;d.ctx||l();b._autoplay=a.autoplay||!1;b._format="string"!==typeof a.format?a.format:[a.format];b._html5=a.html5||!1;b._muted=a.mute||!1;b._loop=a.loop||!1;b._pool=a.pool||5;b._preload="boolean"===typeof a.preload?a.preload:!0;b._rate=a.rate||1;b._sprite=a.sprite||{};b._src="string"!==typeof a.src?a.src:[a.src];b._volume=void 0!==a.volume?a.volume:1;b._xhrWithCredentials=a.xhrWithCredentials||!1;b._duration=0;b._state="unloaded";b._sounds=[];b._endTimers={};
b._queue=[];b._playLock=!1;b._onend=a.onend?[{fn:a.onend}]:[];b._onfade=a.onfade?[{fn:a.onfade}]:[];b._onload=a.onload?[{fn:a.onload}]:[];b._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[];b._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[];b._onpause=a.onpause?[{fn:a.onpause}]:[];b._onplay=a.onplay?[{fn:a.onplay}]:[];b._onstop=a.onstop?[{fn:a.onstop}]:[];b._onmute=a.onmute?[{fn:a.onmute}]:[];b._onvolume=a.onvolume?[{fn:a.onvolume}]:[];b._onrate=a.onrate?[{fn:a.onrate}]:[];b._onseek=a.onseek?[{fn:a.onseek}]:
[];b._onresume=[];b._webAudio=d.usingWebAudio&&!b._html5;"undefined"!==typeof d.ctx&&d.ctx&&d.mobileAutoEnable&&d._enableMobileAudio();d._howls.push(b);b._autoplay&&b._queue.push({event:"play",action:function(){b.play()}});b._preload&&b.load();return b},load:function(){var a=null;if(d.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var c=0;c<this._src.length;c++){if(this._format&&this._format[c])var e=this._format[c];else{var g=
this._src[c];if("string"!==typeof g){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(e=/^data:audio\/([^;,]+);/i.exec(g))||(e=/\.([^.]+)$/.exec(g.split("?",1)[0]));e&&(e=e[1].toLowerCase())}e||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');if(e&&d.codecs(e)){a=this._src[c];break}}if(a)return this._src=a,this._state="loading","https:"===window.location.protocol&&"http:"===a.slice(0,5)&&(this._html5=
!0,this._webAudio=!1),new b(this),this._webAudio&&f(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(a,b){var c=this,e=null;if("number"===typeof a)e=a,a=null;else{if("string"===typeof a&&"loaded"===c._state&&!c._sprite[a])return null;if("undefined"===typeof a){a="__default";for(var f=0,g=0;g<c._sounds.length;g++)c._sounds[g]._paused&&!c._sounds[g]._ended&&(f++,e=c._sounds[g]._id);1===f?a=null:e=null}}var m=e?c._soundById(e):c._inactiveSound();
if(!m)return null;e&&!a&&(a=m._sprite||"__default");if("loaded"!==c._state){m._sprite=a;m._ended=!1;var k=m._id;c._queue.push({event:"play",action:function(){c.play(k)}});return k}if(e&&!m._paused)return b||c._loadQueue("play"),m._id;c._webAudio&&d._autoResume();var x=Math.max(0,0<m._seek?m._seek:c._sprite[a][0]/1E3),h=Math.max(0,(c._sprite[a][0]+c._sprite[a][1])/1E3-x),l=1E3*h/Math.abs(m._rate);m._paused=!1;m._ended=!1;m._sprite=a;m._seek=x;m._start=c._sprite[a][0]/1E3;m._stop=(c._sprite[a][0]+c._sprite[a][1])/
1E3;m._loop=!(!m._loop&&!c._sprite[a][2]);var n=m._node;if(c._webAudio)e=function(){c._refreshBuffer(m);n.gain.setValueAtTime(m._muted||c._muted?0:m._volume,d.ctx.currentTime);m._playStart=d.ctx.currentTime;"undefined"===typeof n.bufferSource.start?m._loop?n.bufferSource.noteGrainOn(0,x,86400):n.bufferSource.noteGrainOn(0,x,h):m._loop?n.bufferSource.start(0,x,86400):n.bufferSource.start(0,x,h);Infinity!==l&&(c._endTimers[m._id]=setTimeout(c._ended.bind(c,m),l));b||setTimeout(function(){c._emit("play",
m._id)},0)},"running"===d.state?e():(c.once("resume",e),c._clearTimer(m._id));else{var z=function(){n.currentTime=x;n.muted=m._muted||c._muted||d._muted||n.muted;n.volume=m._volume*d.volume();n.playbackRate=m._rate;try{var e=n.play();if("undefined"!==typeof Promise&&e instanceof Promise){c._playLock=!0;var f=function(){c._playLock=!1;b||c._emit("play",m._id)};e.then(f,f)}else b||c._emit("play",m._id);n.playbackRate=m._rate;n.paused?c._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction."):
"__default"!==a||m._loop?c._endTimers[m._id]=setTimeout(c._ended.bind(c,m),l):(c._endTimers[m._id]=function(){c._ended(m);n.removeEventListener("ended",c._endTimers[m._id],!1)},n.addEventListener("ended",c._endTimers[m._id],!1))}catch(C){c._emit("playerror",m._id,C)}};e=window&&window.ejecta||!n.readyState&&d._navigator.isCocoonJS;if(3<=n.readyState||e)z();else{var A=function(){z();n.removeEventListener(d._canPlayEvent,A,!1)};n.addEventListener(d._canPlayEvent,A,!1);c._clearTimer(m._id)}}return m._id},
pause:function(a,b){var c=this;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"pause",action:function(){c.pause(a)}}),c;for(var e=c._getSoundIds(a),f=0;f<e.length;f++){c._clearTimer(e[f]);var d=c._soundById(e[f]);if(d&&!d._paused&&(d._seek=c.seek(e[f]),d._rateSeek=0,d._paused=!0,c._stopFade(e[f]),d._node))if(c._webAudio){if(!d._node.bufferSource)continue;"undefined"===typeof d._node.bufferSource.stop?d._node.bufferSource.noteOff(0):d._node.bufferSource.stop(0);c._cleanBuffer(d._node)}else isNaN(d._node.duration)&&
Infinity!==d._node.duration||d._node.pause();b||c._emit("pause",d?d._id:null)}return c},stop:function(a,b){var c=this;if("loaded"!==c._state)return c._queue.push({event:"stop",action:function(){c.stop(a)}}),c;for(var e=c._getSoundIds(a),f=0;f<e.length;f++){c._clearTimer(e[f]);var d=c._soundById(e[f]);d&&(d._seek=d._start||0,d._rateSeek=0,d._paused=!0,d._ended=!0,c._stopFade(e[f]),d._node&&(c._webAudio?d._node.bufferSource&&("undefined"===typeof d._node.bufferSource.stop?d._node.bufferSource.noteOff(0):
d._node.bufferSource.stop(0),c._cleanBuffer(d._node)):isNaN(d._node.duration)&&Infinity!==d._node.duration||(d._node.currentTime=d._start||0,d._node.pause())),b||c._emit("stop",d._id))}return c},mute:function(a,b){var c=this;if("loaded"!==c._state)return c._queue.push({event:"mute",action:function(){c.mute(a,b)}}),c;if("undefined"===typeof b)if("boolean"===typeof a)c._muted=a;else return c._muted;for(var e=c._getSoundIds(b),f=0;f<e.length;f++){var g=c._soundById(e[f]);g&&(g._muted=a,g._interval&&
c._stopFade(g._id),c._webAudio&&g._node?g._node.gain.setValueAtTime(a?0:g._volume,d.ctx.currentTime):g._node&&(g._node.muted=d._muted?!0:a),c._emit("mute",g._id))}return c},volume:function(){var a=this,b=arguments,c,e;if(0===b.length)return a._volume;1===b.length||2===b.length&&"undefined"===typeof b[1]?0<=a._getSoundIds().indexOf(b[0])?e=parseInt(b[0],10):c=parseFloat(b[0]):2<=b.length&&(c=parseFloat(b[0]),e=parseInt(b[1],10));var f;if("undefined"!==typeof c&&0<=c&&1>=c){if("loaded"!==a._state)return a._queue.push({event:"volume",
action:function(){a.volume.apply(a,b)}}),a;"undefined"===typeof e&&(a._volume=c);e=a._getSoundIds(e);for(var g=0;g<e.length;g++)if(f=a._soundById(e[g]))f._volume=c,b[2]||a._stopFade(e[g]),a._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(c,d.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=c*d.volume()),a._emit("volume",f._id)}else return(f=e?a._soundById(e):a._sounds[0])?f._volume:0;return a},fade:function(a,b,c,e){var f=this;if("loaded"!==f._state)return f._queue.push({event:"fade",
action:function(){f.fade(a,b,c,e)}}),f;f.volume(a,e);for(var g=f._getSoundIds(e),m=0;m<g.length;m++){var k=f._soundById(g[m]);if(k){e||f._stopFade(g[m]);if(f._webAudio&&!k._muted){var x=d.ctx.currentTime,h=x+c/1E3;k._volume=a;k._node.gain.setValueAtTime(a,x);k._node.gain.linearRampToValueAtTime(b,h)}f._startFadeInterval(k,a,b,c,g[m],"undefined"===typeof e)}}return f},_startFadeInterval:function(a,b,c,e,f,d){var g=this,m=b,k=c-b;f=Math.abs(k/.01);f=Math.max(4,0<f?e/f:e);var h=Date.now();a._fadeTo=
c;a._interval=setInterval(function(){var f=(Date.now()-h)/e;h=Date.now();m+=k*f;m=Math.max(0,m);m=Math.min(1,m);m=Math.round(100*m)/100;g._webAudio?a._volume=m:g.volume(m,a._id,!0);d&&(g._volume=m);if(c<b&&m<=c||c>b&&m>=c)clearInterval(a._interval),a._interval=null,a._fadeTo=null,g.volume(c,a._id),g._emit("fade",a._id)},f)},_stopFade:function(a){var b=this._soundById(a);b&&b._interval&&(this._webAudio&&b._node.gain.cancelScheduledValues(d.ctx.currentTime),clearInterval(b._interval),b._interval=null,
this.volume(b._fadeTo,a),b._fadeTo=null,this._emit("fade",a));return this},loop:function(){var a=arguments,b;if(0===a.length)return this._loop;if(1===a.length)if("boolean"===typeof a[0])this._loop=b=a[0];else return(a=this._soundById(parseInt(a[0],10)))?a._loop:!1;else if(2===a.length){b=a[0];var c=parseInt(a[1],10)}c=this._getSoundIds(c);for(var e=0;e<c.length;e++)if(a=this._soundById(c[e]))if(a._loop=b,this._webAudio&&a._node&&a._node.bufferSource&&(a._node.bufferSource.loop=b))a._node.bufferSource.loopStart=
a._start||0,a._node.bufferSource.loopEnd=a._stop;return this},rate:function(){var a=this,b=arguments,c;if(0===b.length)var e=a._sounds[0]._id;else 1===b.length?0<=a._getSoundIds().indexOf(b[0])?e=parseInt(b[0],10):c=parseFloat(b[0]):2===b.length&&(c=parseFloat(b[0]),e=parseInt(b[1],10));var f;if("number"===typeof c){if("loaded"!==a._state)return a._queue.push({event:"rate",action:function(){a.rate.apply(a,b)}}),a;"undefined"===typeof e&&(a._rate=c);e=a._getSoundIds(e);for(var g=0;g<e.length;g++)if(f=
a._soundById(e[g])){f._rateSeek=a.seek(e[g]);f._playStart=a._webAudio?d.ctx.currentTime:f._playStart;f._rate=c;a._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(c,d.ctx.currentTime):f._node&&(f._node.playbackRate=c);var k=a.seek(e[g]);k=1E3*((a._sprite[f._sprite][0]+a._sprite[f._sprite][1])/1E3-k)/Math.abs(f._rate);if(a._endTimers[e[g]]||!f._paused)a._clearTimer(e[g]),a._endTimers[e[g]]=setTimeout(a._ended.bind(a,f),k);a._emit("rate",f._id)}}else return(f=
a._soundById(e))?f._rate:a._rate;return a},seek:function(){var a=this,b=arguments;if(0===b.length)var c=a._sounds[0]._id;else if(1===b.length)if(0<=a._getSoundIds().indexOf(b[0]))c=parseInt(b[0],10);else{if(a._sounds.length){c=a._sounds[0]._id;var e=parseFloat(b[0])}}else 2===b.length&&(e=parseFloat(b[0]),c=parseInt(b[1],10));if("undefined"===typeof c)return a;if("loaded"!==a._state)return a._queue.push({event:"seek",action:function(){a.seek.apply(a,b)}}),a;var f=a._soundById(c);if(f)if("number"===
typeof e&&0<=e){var g=a.playing(c);g&&a.pause(c,!0);f._seek=e;f._ended=!1;a._clearTimer(c);g&&a.play(c,!0);!a._webAudio&&f._node&&(f._node.currentTime=e);if(g&&!a._webAudio){var k=function(){a._playLock?setTimeout(k,0):a._emit("seek",c)};setTimeout(k,0)}else a._emit("seek",c)}else return a._webAudio?(e=a.playing(c)?d.ctx.currentTime-f._playStart:0,f._seek+((f._rateSeek?f._rateSeek-f._seek:0)+e*Math.abs(f._rate))):f._node.currentTime;return a},playing:function(a){if("number"===typeof a)return(a=this._soundById(a))?
!a._paused:!1;for(a=0;a<this._sounds.length;a++)if(!this._sounds[a]._paused)return!0;return!1},duration:function(a){var b=this._duration;(a=this._soundById(a))&&(b=this._sprite[a._sprite][1]/1E3);return b},state:function(){return this._state},unload:function(){for(var a=this._sounds,b=0;b<a.length;b++)a[b]._paused||this.stop(a[b]._id),this._webAudio||(/MSIE |Trident\//.test(d._navigator&&d._navigator.userAgent)||(a[b]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),
a[b]._node.removeEventListener("error",a[b]._errorFn,!1),a[b]._node.removeEventListener(d._canPlayEvent,a[b]._loadFn,!1)),delete a[b]._node,this._clearTimer(a[b]._id);b=d._howls.indexOf(this);0<=b&&d._howls.splice(b,1);a=!0;for(b=0;b<d._howls.length;b++)if(d._howls[b]._src===this._src){a=!1;break}e&&a&&delete e[this._src];d.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(a,b,c,e){a=this["_on"+a];"function"===typeof b&&a.push(e?{id:c,fn:b,once:e}:{id:c,fn:b});return this},
off:function(a,b,c){var e=this["_on"+a];"number"===typeof b&&(c=b,b=null);if(b||c)for(a=0;a<e.length;a++){var f=c===e[a].id;if(b===e[a].fn&&f||!b&&f){e.splice(a,1);break}}else if(a)this["_on"+a]=[];else for(b=Object.keys(this),a=0;a<b.length;a++)0===b[a].indexOf("_on")&&Array.isArray(this[b[a]])&&(this[b[a]]=[]);return this},once:function(a,b,c){this.on(a,b,c,1);return this},_emit:function(a,b,c){for(var e=this["_on"+a],f=e.length-1;0<=f;f--)e[f].id&&e[f].id!==b&&"load"!==a||(setTimeout(function(a){a.call(this,
b,c)}.bind(this,e[f].fn),0),e[f].once&&this.off(a,e[f].fn,e[f].id));this._loadQueue(a);return this},_loadQueue:function(a){if(0<this._queue.length){var b=this._queue[0];b.event===a&&(this._queue.shift(),this._loadQueue());a||b.action()}return this},_ended:function(a){var b=a._sprite;if(!this._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(this._ended.bind(this,a),100),this;b=!(!a._loop&&!this._sprite[b][2]);this._emit("end",a._id);!this._webAudio&&
b&&this.stop(a._id,!0).play(a._id);if(this._webAudio&&b){this._emit("play",a._id);a._seek=a._start||0;a._rateSeek=0;a._playStart=d.ctx.currentTime;var c=1E3*(a._stop-a._start)/Math.abs(a._rate);this._endTimers[a._id]=setTimeout(this._ended.bind(this,a),c)}this._webAudio&&!b&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,this._clearTimer(a._id),this._cleanBuffer(a._node),d._autoSuspend());this._webAudio||b||this.stop(a._id,!0);return this},_clearTimer:function(a){if(this._endTimers[a]){if("function"!==
typeof this._endTimers[a])clearTimeout(this._endTimers[a]);else{var b=this._soundById(a);b&&b._node&&b._node.removeEventListener("ended",this._endTimers[a],!1)}delete this._endTimers[a]}return this},_soundById:function(a){for(var b=0;b<this._sounds.length;b++)if(a===this._sounds[b]._id)return this._sounds[b];return null},_inactiveSound:function(){this._drain();for(var a=0;a<this._sounds.length;a++)if(this._sounds[a]._ended)return this._sounds[a].reset();return new b(this)},_drain:function(){var a=
this._pool,b=0,c;if(!(this._sounds.length<a)){for(c=0;c<this._sounds.length;c++)this._sounds[c]._ended&&b++;for(c=this._sounds.length-1;0<=c&&!(b<=a);c--)this._sounds[c]._ended&&(this._webAudio&&this._sounds[c]._node&&this._sounds[c]._node.disconnect(0),this._sounds.splice(c,1),b--)}},_getSoundIds:function(a){if("undefined"===typeof a){a=[];for(var b=0;b<this._sounds.length;b++)a.push(this._sounds[b]._id);return a}return[a]},_refreshBuffer:function(a){a._node.bufferSource=d.ctx.createBufferSource();
a._node.bufferSource.buffer=e[this._src];a._panner?a._node.bufferSource.connect(a._panner):a._node.bufferSource.connect(a._node);if(a._node.bufferSource.loop=a._loop)a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop;a._node.bufferSource.playbackRate.setValueAtTime(a._rate,d.ctx.currentTime);return this},_cleanBuffer:function(a){if(d._scratchBuffer&&a.bufferSource){a.bufferSource.onended=null;a.bufferSource.disconnect(0);try{a.bufferSource.buffer=d._scratchBuffer}catch(n){}}a.bufferSource=
null;return this}};var b=function(a){this._parent=a;this.init()};b.prototype={init:function(){var a=this._parent;this._muted=a._muted;this._loop=a._loop;this._volume=a._volume;this._rate=a._rate;this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=++d._counter;a._sounds.push(this);this.create();return this},create:function(){var a=this._parent,b=d._muted||this._muted||this._parent._muted?0:this._volume;a._webAudio?(this._node="undefined"===typeof d.ctx.createGain?d.ctx.createGainNode():
d.ctx.createGain(),this._node.gain.setValueAtTime(b,d.ctx.currentTime),this._node.paused=!0,this._node.connect(d.masterGain)):(this._node=new Audio,this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(d._canPlayEvent,this._loadFn,!1),this._node.src=a._src,this._node.preload="auto",this._node.volume=b*d.volume(),this._node.load());return this},reset:function(){var a=this._parent;this._muted=
a._muted;this._loop=a._loop;this._volume=a._volume;this._rate=a._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=++d._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var a=this._parent;a._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,
1E3*a._duration]});"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue());this._node.removeEventListener(d._canPlayEvent,this._loadFn,!1)}};var e={},f=function(a){var b=a._src;if(e[b])a._duration=e[b].duration,h(a);else if(/^data:[^;]+;base64,/.test(b)){for(var c=atob(b.split(",")[1]),f=new Uint8Array(c.length),d=0;d<c.length;++d)f[d]=c.charCodeAt(d);k(f.buffer,a)}else{var l=new XMLHttpRequest;l.open("GET",b,!0);l.withCredentials=a._xhrWithCredentials;l.responseType="arraybuffer";
l.onload=function(){var b=(l.status+"")[0];"0"!==b&&"2"!==b&&"3"!==b?a._emit("loaderror",null,"Failed loading audio file with status: "+l.status+"."):k(l.response,a)};l.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete e[b],a.load())};g(l)}},g=function(a){try{a.send()}catch(n){a.onerror()}},k=function(a,b){d.ctx.decodeAudioData(a,function(a){a&&0<b._sounds.length&&(e[b._src]=a,h(b,a))},function(){b._emit("loaderror",null,"Decoding audio data failed.")})},h=function(a,
b){b&&!a._duration&&(a._duration=b.duration);0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,1E3*a._duration]});"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue())},l=function(){try{"undefined"!==typeof AudioContext?d.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?d.ctx=new webkitAudioContext:d.usingWebAudio=!1}catch(t){d.usingWebAudio=!1}var a=/iP(hone|od|ad)/.test(d._navigator&&d._navigator.platform),b=d._navigator&&d._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);
b=b?parseInt(b[1],10):null;a&&b&&9>b&&(a=/safari/.test(d._navigator&&d._navigator.userAgent.toLowerCase()),d._navigator&&d._navigator.standalone&&!a||d._navigator&&!d._navigator.standalone&&!a)&&(d.usingWebAudio=!1);d.usingWebAudio&&(d.masterGain="undefined"===typeof d.ctx.createGain?d.ctx.createGainNode():d.ctx.createGain(),d.masterGain.gain.setValueAtTime(d._muted?0:1,d.ctx.currentTime),d.masterGain.connect(d.ctx.destination));d._setup()};"function"===typeof define&&define.amd&&define([],function(){return{Howler:d,
Howl:a}});"undefined"!==typeof exports&&(exports.Howler=d,exports.Howl=a);"undefined"!==typeof window?(window.HowlerGlobal=c,window.Howler=d,window.Howl=a,window.Sound=b):"undefined"!==typeof global&&(global.HowlerGlobal=c,global.Howler=d,global.Howl=a,global.Sound=b)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(c){if(!this.ctx||!this.ctx.listener)return this;for(var a=this._howls.length-1;0<=a;a--)this._howls[a].stereo(c);return this};HowlerGlobal.prototype.pos=function(c,a,b){if(!this.ctx||!this.ctx.listener)return this;a="number"!==typeof a?this._pos[1]:a;b="number"!==typeof b?this._pos[2]:b;if("number"===typeof c)this._pos=[c,a,b],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(c,a,b,e,f,g){if(!this.ctx||!this.ctx.listener)return this;var d=this._orientation;a="number"!==typeof a?
d[1]:a;b="number"!==typeof b?d[2]:b;e="number"!==typeof e?d[3]:e;f="number"!==typeof f?d[4]:f;g="number"!==typeof g?d[5]:g;if("number"===typeof c)this._orientation=[c,a,b,e,f,g],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(c,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(a,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(b,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(c,Howler.ctx.currentTime,
.1),this.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(b,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(c,a,b,e,f,g);else return d;return this};Howl.prototype.init=function(c){return function(a){this._orientation=a.orientation||[1,0,0];this._stereo=a.stereo||null;this._pos=a.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof a.coneInnerAngle?a.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof a.coneOuterAngle?a.coneOuterAngle:
360,coneOuterGain:"undefined"!==typeof a.coneOuterGain?a.coneOuterGain:0,distanceModel:"undefined"!==typeof a.distanceModel?a.distanceModel:"inverse",maxDistance:"undefined"!==typeof a.maxDistance?a.maxDistance:1E4,panningModel:"undefined"!==typeof a.panningModel?a.panningModel:"HRTF",refDistance:"undefined"!==typeof a.refDistance?a.refDistance:1,rolloffFactor:"undefined"!==typeof a.rolloffFactor?a.rolloffFactor:1};this._onstereo=a.onstereo?[{fn:a.onstereo}]:[];this._onpos=a.onpos?[{fn:a.onpos}]:
[];this._onorientation=a.onorientation?[{fn:a.onorientation}]:[];return c.call(this,a)}}(Howl.prototype.init);Howl.prototype.stereo=function(d,a){var b=this;if(!b._webAudio)return b;if("loaded"!==b._state)return b._queue.push({event:"stereo",action:function(){b.stereo(d,a)}}),b;var e="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof a)if("number"===typeof d)b._stereo=d,b._pos=[d,0,0];else return b._stereo;for(var f=b._getSoundIds(a),g=0;g<f.length;g++){var k=
b._soundById(f[g]);if(k)if("number"===typeof d)k._stereo=d,k._pos=[d,0,0],k._node&&(k._pannerAttr.panningModel="equalpower",k._panner&&k._panner.pan||c(k,e),"spatial"===e?"undefined"!==typeof k._panner.positionX?(k._panner.positionX.setValueAtTime(d,Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):k._panner.setPosition(d,0,0):k._panner.pan.setValueAtTime(d,Howler.ctx.currentTime)),b._emit("stereo",k._id);
else return k._stereo}return b};Howl.prototype.pos=function(d,a,b,e){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"pos",action:function(){f.pos(d,a,b,e)}}),f;a="number"!==typeof a?0:a;b="number"!==typeof b?-.5:b;if("undefined"===typeof e)if("number"===typeof d)f._pos=[d,a,b];else return f._pos;for(var g=f._getSoundIds(e),k=0;k<g.length;k++){var h=f._soundById(g[k]);if(h)if("number"===typeof d)h._pos=[d,a,b],h._node&&(h._panner&&!h._panner.pan||c(h,"spatial"),
"undefined"!==typeof h._panner.positionX?(h._panner.positionX.setValueAtTime(d,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(a,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(b,Howler.ctx.currentTime)):h._panner.setOrientation(d,a,b)),f._emit("pos",h._id);else return h._pos}return f};Howl.prototype.orientation=function(d,a,b,e){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"orientation",action:function(){f.orientation(d,a,b,e)}}),f;
a="number"!==typeof a?f._orientation[1]:a;b="number"!==typeof b?f._orientation[2]:b;if("undefined"===typeof e)if("number"===typeof d)f._orientation=[d,a,b];else return f._orientation;for(var g=f._getSoundIds(e),k=0;k<g.length;k++){var h=f._soundById(g[k]);if(h)if("number"===typeof d)h._orientation=[d,a,b],h._node&&(h._panner||(h._pos||(h._pos=f._pos||[0,0,-.5]),c(h,"spatial")),h._panner.orientationX.setValueAtTime(d,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(a,Howler.ctx.currentTime),
h._panner.orientationZ.setValueAtTime(b,Howler.ctx.currentTime)),f._emit("orientation",h._id);else return h._orientation}return f};Howl.prototype.pannerAttr=function(){var d=arguments;if(!this._webAudio)return this;if(0===d.length)return this._pannerAttr;if(1===d.length)if("object"===typeof d[0]){var a=d[0];"undefined"===typeof b&&(a.pannerAttr||(a.pannerAttr={coneInnerAngle:a.coneInnerAngle,coneOuterAngle:a.coneOuterAngle,coneOuterGain:a.coneOuterGain,distanceModel:a.distanceModel,maxDistance:a.maxDistance,
refDistance:a.refDistance,rolloffFactor:a.rolloffFactor,panningModel:a.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof a.pannerAttr.coneInnerAngle?a.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof a.pannerAttr.coneOuterAngle?a.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof a.pannerAttr.coneOuterGain?a.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof a.pannerAttr.distanceModel?
a.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof a.pannerAttr.maxDistance?a.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof a.pannerAttr.refDistance?a.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof a.pannerAttr.rolloffFactor?a.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof a.pannerAttr.panningModel?a.pannerAttr.panningModel:this._panningModel})}else return(d=this._soundById(parseInt(d[0],
10)))?d._pannerAttr:this._pannerAttr;else if(2===d.length){a=d[0];var b=parseInt(d[1],10)}b=this._getSoundIds(b);for(var e=0;e<b.length;e++)if(d=this._soundById(b[e])){var f=d._pannerAttr;f={coneInnerAngle:"undefined"!==typeof a.coneInnerAngle?a.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:"undefined"!==typeof a.coneOuterAngle?a.coneOuterAngle:f.coneOuterAngle,coneOuterGain:"undefined"!==typeof a.coneOuterGain?a.coneOuterGain:f.coneOuterGain,distanceModel:"undefined"!==typeof a.distanceModel?a.distanceModel:
f.distanceModel,maxDistance:"undefined"!==typeof a.maxDistance?a.maxDistance:f.maxDistance,refDistance:"undefined"!==typeof a.refDistance?a.refDistance:f.refDistance,rolloffFactor:"undefined"!==typeof a.rolloffFactor?a.rolloffFactor:f.rolloffFactor,panningModel:"undefined"!==typeof a.panningModel?a.panningModel:f.panningModel};var g=d._panner;g?(g.coneInnerAngle=f.coneInnerAngle,g.coneOuterAngle=f.coneOuterAngle,g.coneOuterGain=f.coneOuterGain,g.distanceModel=f.distanceModel,g.maxDistance=f.maxDistance,
g.refDistance=f.refDistance,g.rolloffFactor=f.rolloffFactor,g.panningModel=f.panningModel):(d._pos||(d._pos=this._pos||[0,0,-.5]),c(d,"spatial"))}return this};Sound.prototype.init=function(c){return function(){var a=this._parent;this._orientation=a._orientation;this._stereo=a._stereo;this._pos=a._pos;this._pannerAttr=a._pannerAttr;c.call(this);this._stereo?a.stereo(this._stereo):this._pos&&a.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(c){return function(){var a=
this._parent;this._orientation=a._orientation;this._stereo=a._stereo;this._pos=a._pos;this._pannerAttr=a._pannerAttr;this._stereo?a.stereo(this._stereo):this._pos?a.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,a._refreshBuffer(this));return c.call(this)}}(Sound.prototype.reset);var c=function(c,a){"spatial"===(a||"spatial")?(c._panner=Howler.ctx.createPanner(),c._panner.coneInnerAngle=c._pannerAttr.coneInnerAngle,c._panner.coneOuterAngle=
c._pannerAttr.coneOuterAngle,c._panner.coneOuterGain=c._pannerAttr.coneOuterGain,c._panner.distanceModel=c._pannerAttr.distanceModel,c._panner.maxDistance=c._pannerAttr.maxDistance,c._panner.refDistance=c._pannerAttr.refDistance,c._panner.rolloffFactor=c._pannerAttr.rolloffFactor,c._panner.panningModel=c._pannerAttr.panningModel,"undefined"!==typeof c._panner.positionX?(c._panner.positionX.setValueAtTime(c._pos[0],Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(c._pos[1],Howler.ctx.currentTime),
c._panner.positionZ.setValueAtTime(c._pos[2],Howler.ctx.currentTime)):c._panner.setPosition(c._pos[0],c._pos[1],c._pos[2]),"undefined"!==typeof c._panner.orientationX?(c._panner.orientationX.setValueAtTime(c._orientation[0],Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(c._orientation[1],Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(c._orientation[2],Howler.ctx.currentTime)):c._panner.setOrientation(c._orientation[0],c._orientation[1],c._orientation[2])):(c._panner=
Howler.ctx.createStereoPanner(),c._panner.pan.setValueAtTime(c._stereo,Howler.ctx.currentTime));c._panner.connect(c._node);c._paused||c._parent.pause(c._id,!0).play(c._id,!0)}})();
rat.modules.add("js.mixer_participant",["js.message_track"],function(c){function d(a,c){if(window.mixerProxy)window.mixerProxy.on(a,c);else mixer.socket.on(a,c)}var a={viewOpts:{moveVideoPercent:{x:0,y:0},moveCanvasPercent:{x:0,y:0}},videoLogEnabled:!1,setupViewHandler:function(b){this.viewOpts=b;var e=b.idealW,f=b.idealH;this.setViewOpts(b);c.graphics.canvas.width=e;c.graphics.canvas.height=f;c.graphics.SCREEN_WIDTH=e;c.graphics.SCREEN_HEIGHT=f;var d=0,k=0;b=function(b){if(b){var g=b.connectedPlayer;
if(!g){if(!b.costreamPlayers||0>=b.costreamPlayers.length){a.videoLogEnabled&&(c.console.log("position handler: undefined position.connectedPlayer, and no costream data"),c.console.log(b));return}g=b.costreamPlayers[0]}if(g){b=c.graphics.canvas;var h=g.left,n=g.top,t=g.width,p=g.height;a.videoLogEnabled&&(c.console.log("mixer poshandler: position:"),c.console.log("  "+h+","+n+"  "+t+" x "+p));if(!(0>=t||0>=p)){var q=1920/(1920-app.config.SIDE_W-app.config.RIGHT_SIDE_W)*t;myH=f/e*q;c.graphics.setGlobalScale(1,
1);c.graphics.outerScale=q/e;h=app.config.SIDE_W/(app.config.SIDE_W+app.config.RIGHT_SIDE_W)*-(q-t)+h;n=-(p*app.config.TOP_STRIP_H/app.config.IDEAL_H)+n;(p=mixer.display.settings())&&p.value&&"mobile"===p.value.platform&&(0>n&&(n=0),0>h&&(h=0));b.style.position="fixed";b.style.left=""+h+"px";b.style.top=""+n+"px";b.style.width=""+q+"px";b.style.height=""+myH+"px";a.videoLogEnabled&&c.console.log("canvas style set to "+h+","+n+"  "+q+" x "+myH);app.resizeHandler();!("xbox"===app.platform||"web"===
app.platform&&c.system.has.IEVersion)||d===g.width&&k===g.height||(d=g.width,k=g.height,c.console.log("re-setting player position (in 250ms) to confirm."),setTimeout(a.setPlayerPosition,250))}}else a.videoLogEnabled&&c.console.log("player remains undefined, dang it.")}else a.videoLogEnabled&&c.console.log("position handler: undefined position")};mixer.display.position().subscribe(b);a.fakeInitialSizeCall(b)},fakeInitialSizeCall:function(a){var b=c.utils.getWindowSize();c.console.log("queried wsize info "+
b.w+" x "+b.h);var f=b.w,d=b.h;b.h/9<b.w/16?f=16/9*d:d=.5625*f;var k=(b.w-f)/2;b=(b.h-d)/2;c.console.log("calculated wsize info "+f+" x "+d+" at "+k+","+b);a({connectedPlayer:{left:k,top:b,width:f,height:d}})},initMixer:function(){app.hasMixer=!1;"undefined"!==typeof mixer?(c.console.log("has mixer, initializing..."),this.mixerHandle=mixer,app.hasMixer=!0):(this.mixerHandle=mixer=null,app.hasMixer=!1);c.console.log("done with initMixer")},initMixerEvents:function(){if(mixer){c.console.log("initMixerEvents");
c.console.log("  registering socket on event...");d("event",function(a){a.code&&c.console.log("*** got event "+a.code);messageTrack.trackMessage("event","event",a);peSync.receiveMessage(a)});d("onParticipantUpdate",function(a){c.console.log("*** participant update");a=a.participants[0];a.gameState&&peSync.participantStateChange(a.gameState);c.live.telemetryManager.updateParticipantExperienceData(a)});d("onParticipantJoin",function(a){c.console.log("*** participant join");a=a.participants[0];if(peSync.onParticipantJoin)peSync.onParticipantJoin(a);
a.gameState&&peSync.participantStateChange(a.gameState)});var a=function(a){if(a=a.controls)for(var b=0;b<a.length;b++){var e=a[b];e.controlID&&"my_first_button"!==e.controlID?e.metaValue&&peSync.controlStateChange(e.controlID,e.metaValue):(c.console.logError("ERROR! BAD CONTROLS ***********************"),c.console.activate(!0))}else c.console.log("*** undefined control list")};c.console.log("  registering control update");d("onControlUpdate",a);var e=function(b){c.console.log("*** scene create/update");
b=b.scenes.filter(function(a){return"default"===a.sceneID});1===b.length&&a(b[0])};d("onSceneUpdate",e);d("onSceneCreate",e)}},sendMessage:function(a,c,f){mixer&&mixer.socket.call("giveInput",{controlID:f||"mixguess-anchor",event:"mousedown",messageClass:a,message:c})},setViewOpts:function(a){a.moveVideoPercent=a.moveVideoPercent||{};a.moveVideoPercent.x=a.moveVideoPercent.x||0;a.moveVideoPercent.y=a.moveVideoPercent.y||0;a.moveCanvasPercent||(a.moveCanvasPercent=c.utils.copyObject(a.moveVideoPercent));
a.moveCanvasPercent.x=a.moveCanvasPercent.x||0;a.moveCanvasPercent.y=a.moveCanvasPercent.y||0;this.oldOpts=this.viewOpts;this.newOpts=a;this.viewOpts=c.utils.copyObject(a,!0);this.viewOpts.animateOffsetTime&&(this.viewOpts.moveVideoPercent=c.utils.copyObject(this.oldOpts.moveVideoPercent,!0),this.viewOpts.interp=0,this.viewOpts.animateOffsetTimer=a.animateOffsetTime)},setPlayerPosition:function(){if(mixer&&"mobile"!==app.platform){var b=a.viewOpts.moveVideoPercent.x,e=a.viewOpts.moveVideoPercent.y,
f=a.viewOpts.moveVideoPercent.right;void 0===f&&(f=b);a.videoLogEnabled&&c.console.log("calling moveVideo, yPercent "+e);mixer.display.moveVideo({top:""+e+"%",bottom:0,left:""+b+"%",right:""+f+"%"});app.xboxMixerPreventExit()}},mixerAfterLoad:function(){c.console.log("mixerAfterLoad");peSync.startSync();mixer&&(c.console.log("mixer.isLoaded()"),window.mixerProxy?window.mixerProxy.isLoaded():mixer.isLoaded(),"mobile"!==app.platform&&(c.console.log("--\x3e position stream after load "),a.setPlayerPosition(),
"xbox"!==app.platform&&c.system.has.IEVersion?(c.console.log("queueing another pair of delayed edge updates"),setTimeout(a.setPlayerPosition,5E3),setTimeout(a.setPlayerPosition,5200)):setTimeout(a.setPlayerPosition,250)));c.console.log("mixerAfterLoad done")},shake:function(a,c){this.screenShakeTimer=this.screenShakeTimerMax=c;this.screenShakeMag=a},update:function(b){if(this.viewOpts.animateOffsetTime){this.viewOpts.animateOffsetTimer-=b;if(0>=this.viewOpts.animateOffsetTimer)this.viewOpts.animateOffsetTime=
0,this.viewOpts.moveVideoPercent=this.newOpts.moveVideoPercent,setTimeout(a.setPlayerPosition,250);else{this.viewOpts.interp=1-this.viewOpts.animateOffsetTimer/this.viewOpts.animateOffsetTime;this.viewOpts.interp=c.utils.clamp(this.viewOpts.interp,0,1);this.viewOpts.interp=c.ui.Animator.filterEaseInOut(this.viewOpts.interp);var e=this.oldOpts.moveVideoPercent,f=this.newOpts.moveVideoPercent;this.viewOpts.moveVideoPercent.x=c.utils.interpolate(e.x,f.x,this.viewOpts.interp);this.viewOpts.moveVideoPercent.y=
c.utils.interpolate(e.y,f.y,this.viewOpts.interp)}mixer&&mixer.display&&a.setPlayerPosition()}0<this.screenShakeTimer&&(this.screenShakeTimer-=b,this.screenShakeTimer=Math.max(this.screenShakeTimer,0),e=this.screenShakeMag*this.screenShakeTimer/this.screenShakeTimerMax,1<e&&mixer&&mixer.display&&(b=(Math.random()-.5)*e,e*=Math.random()-.5,f=a.viewOpts.moveVideoPercent.y|0,mixer.display.moveVideo({top:0===f?-e:""+f+"%",bottom:e,left:-b,right:b})),0>=this.screenShakeTimer&&mixer&&mixer.display&&a.setPlayerPosition())},
openWindow:function(a){mixer&&mixer.navigation&&mixer.navigation.openLink?mixer.navigation.openLink(a):window.open(a,"_blank")},openWindowWithLocalContent:function(b){var c=document.location.href.lastIndexOf("/");c=document.location.href.substring(0,c);a.openWindow(c+"/"+b)}};window.mixerParticipant=a});
rat.modules.add("js.message_track",[],function(c){var d={enabled:!1,messageCounts:{},totals:{eventsPerSecond:0,bytesPerSecond:0,totalCount:0,totalSize:0},init:function(){},enable:function(){d.enabled||(d.startTimestamp=Date.now(),d.enabled=!0,setInterval(function(){"visible"===app.visibility&&d.runUpdate()},1E3))},trackMessage:function(a,b,c){a=Date.now();var e=d.messageCounts[b];e||(e=d.messageCounts[b]={track:[],eventsPerSecond:0,startTimestamp:a,totalEver:0,totalSizeEver:0,trackedSize:0});b=0;
c&&(b=2*JSON.stringify(c).length);e.totalEver++;e.totalSizeEver+=b;e.trackedSize+=b;d.totals.totalSize+=b;e.track.push({timestamp:a,size:b});d.totals.totalCount++},runUpdate:function(){var a=Date.now(),b=(a-d.startTimestamp)/1E3;b=Math.min(b,5);for(var c in d.messageCounts){for(var f=d.messageCounts[c],g=f.track.length-1;0<=g;g--)5<(a-f.track[g].timestamp)/1E3&&(d.totals.totalSize-=f.track[g].size,d.totals.totalCount--,f.trackedSize-=f.track[g].size,f.track.splice(g,1));f.eventsPerSecond=f.eps=f.track.length/
b;f.bytesPerSecond=f.Bps=f.trackedSize/b}a=d.totals;a.eventsPerSecond=a.eps=a.totalCount/b;a.bytesPerSecond=a.Bps=a.totalSize/b},registerCommands:function(){c.console.registerCommand("trackcommon",function(a,b){d.enable();c.console.parseCommand("track messageTrack.totals.eps");c.console.parseCommand("track messageTrack.totals.Bps");c.console.parseCommand("track messageTrack.messageCounts['mixguess-anchor'].eps");c.console.parseCommand("track messageTrack.messageCounts['mixguess-anchor'].Bps");c.console.parseCommand("track messageTrack.messageCounts['mixguess-log-anchor'].eps");
c.console.parseCommand("track messageTrack.messageCounts['mixguess-log-anchor'].Bps")},[])}};window.messageTrack=d});
rat.modules.add("js.user_info_manager",[],function(c){var d={cache:{},getUserInfo:function(a,b){void 0===a||0>=a||"number"!==typeof a?b(!1,null):void 0!==d.cache[a]?b(!0,d.cache[a]):c.utils.restGetJSONAsync("https://mixer.com/api/v1/users/"+a,function(e,f,g){e?((g=f.avatarUrl)&&""!==g&&(imageRef=new c.graphics.ImageRef(g),f.avatarImageRef=imageRef),d.cache[a]=f,b(e,f)):(d.cache[a]=null,b(e,null))})},overrideUserInfo:function(a,b){d.cache[a]=b}};app.userInfoManager=d});
rat.modules.add("js.audio",["rat.audio.r_audio"],function(c){var d={init:function(){c.audio.setGlobalVolume(.3);c.audio.loadSounds([{id:"click",resource:"audio/snap.mp3",count:10,volume:1},{id:"navigate",resource:"audio/navigate.mp3",count:3,volume:.2},{id:"ticket_collect",resource:"audio/card_place.mp3",volume:.2,count:10},[{id:"refund_collect",resource:"audio/refund_hit.mp3",volume:.1,count:5},{id:"refund_collect",resource:"audio/refund_hit_2.mp3",volume:.1,count:5},{id:"refund_collect",resource:"audio/refund_hit_3.mp3",
volume:.1,count:5}],{id:"error",resource:"audio/error.mp3",volume:.3,count:10},{id:"hitcap",resource:"audio/hitcap.mp3",volume:1,count:3},{id:"ticket_leave",resource:"audio/ticket_leave.mp3",volume:2,count:10},[{id:"offer_arrive",resource:"audio/card_fly_01.mp3",volume:.6,count:2},{id:"offer_arrive",resource:"audio/card_fly_02.mp3",volume:.6,count:2},{id:"offer_arrive",resource:"audio/card_fly_03.mp3",volume:.6,count:2}],[{id:"spark_collect",resource:"audio/coin_01.mp3",volume:.3,count:10},{id:"spark_collect",
resource:"audio/coin_02.mp3",volume:.3,count:10},{id:"spark_collect",resource:"audio/coin_03.mp3",volume:.3,count:10}],{id:"offer_move",resource:"audio/card_fly_01.mp3",volume:.3,count:5},{id:"offer_slide_navigate",resource:"audio/card_fly_01.mp3",volume:.25,count:5},{id:"new_offer",resource:"audio/gem_01.mp3",volume:.8,count:6},{id:"offer_locked",resource:"audio/lock.mp3",volume:1,count:3},{id:"offer_unlocked",resource:"audio/unlock.mp3",volume:1,count:3},{id:"offer_bet_time_expired",resource:"audio/gem_01.mp3",
volume:1,count:1},{id:"will_need_resolution",resource:"audio/will_need_resolution.mp3",volume:.6,count:10},{id:"offer_needs_resolution",resource:"audio/need_resolution.mp3",volume:.6,count:2},{id:"made_bet",resource:"audio/stamp_sticky.mp3",volume:.2},{id:"reveal_line",resource:"audio/navigate.mp3",volume:.7,count:3},{id:"bet_good",resource:"audio/correct.mp3",volume:.2},{id:"bet_bad",resource:"audio/wrong.mp3",volume:.35},{id:"bet_refund",resource:"audio/refund.mp3",volume:.2},{id:"end_results",
resource:"audio/end_results.mp3",volume:.2},{id:"credits_explode",resource:"audio/credits_explode.m4a",volume:.6},{id:"give_sparks",resource:"audio/celebrate.mp3",volume:.6},{id:"gift_credits",resource:"audio/celebrate.mp3",volume:.6}]);c.ui.Button.defaultClickSound="click";c.ui.Button.defaultFocusSound="navigate"},playSound:function(a){"visible"===d.visibility&&c.audio.playSound(a)},stopSound:function(a){c.audio.stopSound(a)},startMusic:function(){d.playSound("music")},visibility:"visible",update:function(a){},
updateFromSettings:function(){c.audio.enableGroup(c.audio.defaultGroup,app.settings.soundOn)},visibilityChange:function(a){d.visibility=a}};window.audio=d});
rat.modules.add("js.game","js.data.config rat.ui.r_ui rat.debug.r_console rat.os.r_system rat.ui.r_screen rat.ui.r_screenmanager js.audio js.graphics.effects js.ui.game_screen js.pe_sync js.ui.ui".split(" "),function(c){var d={state:"init",score:0,oneTimeInit:function(){},initAfterLoad:function(){app.types.ModMenu.enableCustomizeUI();app.types.ModMenu.addCommand({name:"placeholder",callback:function(){return!0}});this.buildUI()},init:function(){c.screenManager.pushScreen(this.screen);this.state="play";
this.time=0},buildUI:function(){this.hud=this.screen=new app.types.GameScreen(this)},exit:function(){this.state="exit";c.screenManager.popAllScreens()},update:function(a){this.time+=a},draw:function(a){d.hud.isVisible()&&backgroundEffects.particles.draw(a);effects.drawEvents(a)},drawPost:function(a){effects.particles.draw();effects.drawOverUI(a)}};window.game=d});
rat.modules.add("js.data.data",[{name:"js.game",processBefore:!0}],function(c){game.levels=[{name:"level 1",whatever:[1,2,3]},{name:"level 2",whatever:[3,4,5]}]});
rat.modules.add("js.event_manager",["js.data.config","js.graphics.effects","js.ui.game_screen","js.ui.ui","js.app"],function(c){var d={time:0,events:[],oneTimeInit:function(){},update:function(a){this.time+=a;0<this.events.length&&"pending"===this.events[0].state&&(this.events[0].state="active");for(var b=this.events.length-1;0<=b;b--){var c=this.events[b];if("active"===c.state&&(c.timer-=a,0>=c.timer))if(c.hasStarted){if(c.endAction&&c.endAction(c.info),this.events.splice(b,1),c=this.events[b])c.state=
"active"}else{c.hasStarted=!0;var f=0;c.action&&(f=(f=c.action(c.info))||0);c.timer=f}}},queueEvent:function(a,b,c,f){this.events.push({state:"pending",action:a,endAction:b,info:c,timer:f||0})},queueDelay:function(a,b){this.queueEvent(null,b,null,a)},queueExtraTickets:function(a,b,c,f,g){d.queueEvent(function(){f&&f();return effects.doMultiTicketEffect(a,b,c)},null,null,g)}};app.eventManager=d});
rat.modules.add("js.graphics.gfx",[],function(c){var d={assets:{default_avatar:{res:"images/ui/default_avatar.png",autoCenter:!1},start_background:{res:"images/ui/start_background.jpg",autoCenter:!1},mod_background:{res:"images/ui/mod_ui/mod_background.jpg",autoCenter:!1},start_logo:{res:"images/ui/logo_mixguess.png",autoCenter:!1},small_logo:{res:"images/ui/logo_mixguess_small.png",autoCenter:!1},spark:{res:"images/effects/spark.png",autoCenter:!0},ray_burst:{res:"images/effects/ray_burst.png",autoCenter:!0},
smoke_puff:{res:"images/effects/smoke_puff.png",autoCenter:!0},smoke_ring:{res:"images/effects/smoke_ring.png",autoCenter:!0},winner_flash:{res:"images/effects/winner_flash.png",autoCenter:!0},text_flash_back:{res:"images/effects/text_flash_back.png",autoCenter:!0},mixer_spark_icon:{res:"images/ui/spark_icon.png",autoCenter:!0},mixer_spark_emblem:{res:"images/ui/spark_emblem_black.png"},mixer_spark_spend_callout:{res:"images/ui/spark_spend_callout_anim/spark_spend_callout00.png images/ui/spark_spend_callout_anim/spark_spend_callout01.png images/ui/spark_spend_callout_anim/spark_spend_callout02.png images/ui/spark_spend_callout_anim/spark_spend_callout03.png images/ui/spark_spend_callout_anim/spark_spend_callout04.png images/ui/spark_spend_callout_anim/spark_spend_callout05.png images/ui/spark_spend_callout_anim/spark_spend_callout06.png images/ui/spark_spend_callout_anim/spark_spend_callout07.png images/ui/spark_spend_callout_anim/spark_spend_callout08.png images/ui/spark_spend_callout_anim/spark_spend_callout09.png images/ui/spark_spend_callout_anim/spark_spend_callout10.png images/ui/spark_spend_callout_anim/spark_spend_callout11.png images/ui/spark_spend_callout_anim/spark_spend_callout12.png images/ui/spark_spend_callout_anim/spark_spend_callout13.png images/ui/spark_spend_callout_anim/spark_spend_callout14.png images/ui/spark_spend_callout_anim/spark_spend_callout15.png images/ui/spark_spend_callout_anim/spark_spend_callout16.png images/ui/spark_spend_callout_anim/spark_spend_callout17.png images/ui/spark_spend_callout_anim/spark_spend_callout18.png images/ui/spark_spend_callout_anim/spark_spend_callout19.png images/ui/spark_spend_callout_anim/spark_spend_callout20.png images/ui/spark_spend_callout_anim/spark_spend_callout21.png images/ui/spark_spend_callout_anim/spark_spend_callout22.png images/ui/spark_spend_callout_anim/spark_spend_callout23.png images/ui/spark_spend_callout_anim/spark_spend_callout24.png images/ui/spark_spend_callout_anim/spark_spend_callout25.png images/ui/spark_spend_callout_anim/spark_spend_callout26.png images/ui/spark_spend_callout_anim/spark_spend_callout27.png images/ui/spark_spend_callout_anim/spark_spend_callout28.png images/ui/spark_spend_callout_anim/spark_spend_callout29.png images/ui/spark_spend_callout_anim/spark_spend_callout30.png images/ui/spark_spend_callout_anim/spark_spend_callout31.png images/ui/spark_spend_callout_anim/spark_spend_callout32.png images/ui/spark_spend_callout_anim/spark_spend_callout33.png images/ui/spark_spend_callout_anim/spark_spend_callout34.png images/ui/spark_spend_callout_anim/spark_spend_callout35.png images/ui/spark_spend_callout_anim/spark_spend_callout36.png images/ui/spark_spend_callout_anim/spark_spend_callout37.png images/ui/spark_spend_callout_anim/spark_spend_callout38.png images/ui/spark_spend_callout_anim/spark_spend_callout39.png images/ui/spark_spend_callout_anim/spark_spend_callout40.png images/ui/spark_spend_callout_anim/spark_spend_callout41.png images/ui/spark_spend_callout_anim/spark_spend_callout42.png images/ui/spark_spend_callout_anim/spark_spend_callout43.png images/ui/spark_spend_callout_anim/spark_spend_callout44.png images/ui/spark_spend_callout_anim/spark_spend_callout45.png images/ui/spark_spend_callout_anim/spark_spend_callout46.png images/ui/spark_spend_callout_anim/spark_spend_callout47.png images/ui/spark_spend_callout_anim/spark_spend_callout48.png images/ui/spark_spend_callout_anim/spark_spend_callout49.png images/ui/spark_spend_callout_anim/spark_spend_callout50.png images/ui/spark_spend_callout_anim/spark_spend_callout51.png images/ui/spark_spend_callout_anim/spark_spend_callout52.png images/ui/spark_spend_callout_anim/spark_spend_callout53.png".split(" "),
animSpeed:30,autoCenter:!0},button_cooldown_icon:{res:"images/ui/cool_down_anim/cool_down00.png images/ui/cool_down_anim/cool_down01.png images/ui/cool_down_anim/cool_down02.png images/ui/cool_down_anim/cool_down03.png images/ui/cool_down_anim/cool_down04.png images/ui/cool_down_anim/cool_down05.png images/ui/cool_down_anim/cool_down06.png images/ui/cool_down_anim/cool_down07.png images/ui/cool_down_anim/cool_down08.png images/ui/cool_down_anim/cool_down09.png images/ui/cool_down_anim/cool_down10.png images/ui/cool_down_anim/cool_down11.png images/ui/cool_down_anim/cool_down12.png images/ui/cool_down_anim/cool_down13.png images/ui/cool_down_anim/cool_down14.png images/ui/cool_down_anim/cool_down15.png images/ui/cool_down_anim/cool_down16.png images/ui/cool_down_anim/cool_down17.png images/ui/cool_down_anim/cool_down18.png images/ui/cool_down_anim/cool_down19.png images/ui/cool_down_anim/cool_down20.png".split(" "),
animSpeed:1,autoCenter:!0},button_tab_down:{res:"images/ui/arrow_down.png",autoCenter:!1},button_tab_up:{res:"images/ui/arrow_up.png",autoCenter:!1},ticket:{res:"images/ui/star.png",autoCenter:!0},ticket_big:{res:"images/ui/star_big.png",autoCenter:!0},backdrop:{res:"images/ui/top_bar.jpg",autoCenter:!1},mobile_backdrop:{res:"images/ui/mobile_backdrop.jpg",autoCenter:!1},mod_menu_icon:{res:"images/ui/mod_menu_icon.png",autoCenter:!0},mod_help_icon:{res:"images/ui/mod_button_icons/help.png",autoCenter:!0},
help_menu_icon:{res:"images/ui/icon_info.png",autoCenter:!0},info_menu_icon:{res:"images/ui/mod_button_icons/info.png",autoCenter:!0},settings_menu_icon:{res:"images/ui/icon_settings_purple.png",autoCenter:!0},settings_menu_icon_mod:{res:"images/ui/mod_button_icons/icon_settings_green.png",autoCenter:!0},set_value_icon:{res:"images/ui/icon_set.png",autoCenter:!0},trash_icon_mod:{res:"images/ui/mod_button_icons/trash.png",autoCenter:!0},icon_favorites:{res:"images/ui/icon_favorites.png",autoCenter:!0},
icon_favorites_off:{res:"images/ui/icon_favorites_off.png",autoCenter:!1},icon_favorites_on:{res:"images/ui/icon_favorites_on.png",autoCenter:!1},icon_favorites_off_high:{res:"images/ui/icon_favorites_off_high.png",autoCenter:!1},icon_favorites_on_high:{res:"images/ui/icon_favorites_on_high.png",autoCenter:!1},icon_upload:{res:"images/ui/icon_upload.png",autoCenter:!0},help_arrow:{res:"images/ui/arrow_anim/arrow_animation00.png images/ui/arrow_anim/arrow_animation01.png images/ui/arrow_anim/arrow_animation02.png images/ui/arrow_anim/arrow_animation03.png images/ui/arrow_anim/arrow_animation04.png images/ui/arrow_anim/arrow_animation05.png images/ui/arrow_anim/arrow_animation06.png images/ui/arrow_anim/arrow_animation07.png images/ui/arrow_anim/arrow_animation08.png images/ui/arrow_anim/arrow_animation09.png images/ui/arrow_anim/arrow_animation10.png images/ui/arrow_anim/arrow_animation11.png images/ui/arrow_anim/arrow_animation12.png images/ui/arrow_anim/arrow_animation13.png images/ui/arrow_anim/arrow_animation14.png images/ui/arrow_anim/arrow_animation15.png images/ui/arrow_anim/arrow_animation16.png images/ui/arrow_anim/arrow_animation17.png images/ui/arrow_anim/arrow_animation18.png images/ui/arrow_anim/arrow_animation19.png images/ui/arrow_anim/arrow_animation20.png images/ui/arrow_anim/arrow_animation21.png images/ui/arrow_anim/arrow_animation22.png images/ui/arrow_anim/arrow_animation23.png images/ui/arrow_anim/arrow_animation24.png images/ui/arrow_anim/arrow_animation25.png images/ui/arrow_anim/arrow_animation26.png images/ui/arrow_anim/arrow_animation27.png images/ui/arrow_anim/arrow_animation28.png images/ui/arrow_anim/arrow_animation29.png images/ui/arrow_anim/arrow_animation30.png images/ui/arrow_anim/arrow_animation31.png images/ui/arrow_anim/arrow_animation32.png images/ui/arrow_anim/arrow_animation33.png images/ui/arrow_anim/arrow_animation34.png images/ui/arrow_anim/arrow_animation35.png images/ui/arrow_anim/arrow_animation36.png images/ui/arrow_anim/arrow_animation37.png images/ui/arrow_anim/arrow_animation38.png images/ui/arrow_anim/arrow_animation39.png images/ui/arrow_anim/arrow_animation40.png images/ui/arrow_anim/arrow_animation41.png images/ui/arrow_anim/arrow_animation42.png images/ui/arrow_anim/arrow_animation43.png images/ui/arrow_anim/arrow_animation44.png images/ui/arrow_anim/arrow_animation45.png images/ui/arrow_anim/arrow_animation46.png images/ui/arrow_anim/arrow_animation47.png images/ui/arrow_anim/arrow_animation48.png images/ui/arrow_anim/arrow_animation49.png".split(" "),
animSpeed:30,autoCenter:!0},arrow_purple_up:{res:"images/ui/updown_button/up_purple.png",autoCenter:!0},arrow_purple_up_disabled:{res:"images/ui/updown_button/up_purple_disabled.png",autoCenter:!0},arrow_purple_up_highlight:{res:"images/ui/updown_button/up_purple_highlight.png",autoCenter:!0},arrow_purple_down:{res:"images/ui/updown_button/down_purple.png",autoCenter:!0},arrow_purple_down_disabled:{res:"images/ui/updown_button/down_purple_disabled.png",autoCenter:!0},arrow_purple_down_highlight:{res:"images/ui/updown_button/down_purple_highlight.png",
autoCenter:!0},arrow_green_up:{res:"images/ui/updown_button/up_green.png",autoCenter:!0},arrow_green_up_disabled:{res:"images/ui/updown_button/up_green_disabled.png",autoCenter:!0},arrow_green_up_highlight:{res:"images/ui/updown_button/up_green_highlight.png",autoCenter:!0},arrow_green_down:{res:"images/ui/updown_button/down_green.png",autoCenter:!0},arrow_green_down_disabled:{res:"images/ui/updown_button/down_green_disabled.png",autoCenter:!0},arrow_green_down_highlight:{res:"images/ui/updown_button/down_green_highlight.png",
autoCenter:!0},off_button_box:{res:"images/ui/off_button_select/off_button_box.png",autoCenter:!0},off_button_up:{res:"images/ui/off_button_select/off_button_arrow_up.png",autoCenter:!0},off_button_up_disabled:{res:"images/ui/off_button_select/off_button_arrow_up_disabled.png",autoCenter:!0},off_button_up_highlight:{res:"images/ui/off_button_select/off_button_arrow_up_highlight.png",autoCenter:!0},off_button_down:{res:"images/ui/off_button_select/off_button_arrow_down.png",autoCenter:!0},off_button_down_disabled:{res:"images/ui/off_button_select/off_button_arrow_down_disabled.png",
autoCenter:!0},off_button_down_highlight:{res:"images/ui/off_button_select/off_button_arrow_down_highlight.png",autoCenter:!0},button_cover:{res:"images/ui/button_cover.png",autoCenter:!1},pull_tab:{res:"images/ui/button_arrow.png",autoCenter:!1},pull_tab_left:{res:"images/ui/button_arrow_left.png",autoCenter:!0},multiplier_tab:{res:"images/ui/multiplier_tab.png",autoCenter:!1},icon_edit:{res:"images/ui/icon_edit.png",autoCenter:!1},icon_call:{res:"images/ui/icon_call.png",autoCenter:!1},icon_lock:{res:"images/ui/icon_lock.png",
autoCenter:!1},offer_locked:{res:"images/ui/icon_button_locked.png",autoCenter:!1},icon_bet_no:{res:"images/ui/icon_bet_no.png",autoCenter:!1},icon_bet_yes:{res:"images/ui/icon_bet_yes.png",autoCenter:!1},icon_bet_home:{res:"images/ui/home_small.png",autoCenter:!1},icon_bet_rival:{res:"images/ui/rival_small.png",autoCenter:!1},offer_result_no:{res:"images/ui/button_cover_icon_no.png",autoCenter:!1},offer_result_yes:{res:"images/ui/button_cover_icon_yes.png",autoCenter:!1},offer_result_home:{res:"images/ui/home.png",
autoCenter:!1},offer_result_rival:{res:"images/ui/rival.png",autoCenter:!1},resolve_box:{res:"images/ui/resolve/bubble_box_resolve_box.png",autoCenter:!1},resolve_pending:{res:"images/ui/resolve/loading_c/resolving_anim_c00.png images/ui/resolve/loading_c/resolving_anim_c01.png images/ui/resolve/loading_c/resolving_anim_c02.png images/ui/resolve/loading_c/resolving_anim_c03.png images/ui/resolve/loading_c/resolving_anim_c04.png images/ui/resolve/loading_c/resolving_anim_c05.png images/ui/resolve/loading_c/resolving_anim_c06.png images/ui/resolve/loading_c/resolving_anim_c07.png images/ui/resolve/loading_c/resolving_anim_c08.png images/ui/resolve/loading_c/resolving_anim_c09.png images/ui/resolve/loading_c/resolving_anim_c10.png images/ui/resolve/loading_c/resolving_anim_c11.png images/ui/resolve/loading_c/resolving_anim_c12.png images/ui/resolve/loading_c/resolving_anim_c13.png images/ui/resolve/loading_c/resolving_anim_c14.png images/ui/resolve/loading_c/resolving_anim_c15.png images/ui/resolve/loading_c/resolving_anim_c16.png images/ui/resolve/loading_c/resolving_anim_c17.png images/ui/resolve/loading_c/resolving_anim_c18.png images/ui/resolve/loading_c/resolving_anim_c19.png images/ui/resolve/loading_c/resolving_anim_c20.png images/ui/resolve/loading_c/resolving_anim_c21.png images/ui/resolve/loading_c/resolving_anim_c22.png images/ui/resolve/loading_c/resolving_anim_c23.png images/ui/resolve/loading_c/resolving_anim_c24.png images/ui/resolve/loading_c/resolving_anim_c25.png images/ui/resolve/loading_c/resolving_anim_c26.png images/ui/resolve/loading_c/resolving_anim_c27.png images/ui/resolve/loading_c/resolving_anim_c28.png images/ui/resolve/loading_c/resolving_anim_c29.png images/ui/resolve/loading_c/resolving_anim_c30.png images/ui/resolve/loading_c/resolving_anim_c31.png images/ui/resolve/loading_c/resolving_anim_c32.png images/ui/resolve/loading_c/resolving_anim_c33.png images/ui/resolve/loading_c/resolving_anim_c34.png images/ui/resolve/loading_c/resolving_anim_c35.png images/ui/resolve/loading_c/resolving_anim_c36.png images/ui/resolve/loading_c/resolving_anim_c37.png images/ui/resolve/loading_c/resolving_anim_c38.png images/ui/resolve/loading_c/resolving_anim_c39.png images/ui/resolve/loading_c/resolving_anim_c40.png images/ui/resolve/loading_c/resolving_anim_c41.png images/ui/resolve/loading_c/resolving_anim_c42.png images/ui/resolve/loading_c/resolving_anim_c43.png images/ui/resolve/loading_c/resolving_anim_c44.png images/ui/resolve/loading_c/resolving_anim_c45.png images/ui/resolve/loading_c/resolving_anim_c46.png images/ui/resolve/loading_c/resolving_anim_c47.png images/ui/resolve/loading_c/resolving_anim_c48.png images/ui/resolve/loading_c/resolving_anim_c49.png images/ui/resolve/loading_c/resolving_anim_c50.png images/ui/resolve/loading_c/resolving_anim_c51.png images/ui/resolve/loading_c/resolving_anim_c52.png images/ui/resolve/loading_c/resolving_anim_c53.png images/ui/resolve/loading_c/resolving_anim_c54.png images/ui/resolve/loading_c/resolving_anim_c55.png images/ui/resolve/loading_c/resolving_anim_c56.png images/ui/resolve/loading_c/resolving_anim_c57.png images/ui/resolve/loading_c/resolving_anim_c58.png images/ui/resolve/loading_c/resolving_anim_c59.png".split(" "),
animSpeed:30,autoCenter:!1,doUpdate:!1},bet_result_good:{res:"images/ui/resolve/correct/correct_15.png",autoCenter:!1},bet_result_bad:{res:"images/ui/resolve/wrong/wrong_15.png",autoCenter:!1},bet_result_refund:{res:"images/ui/resolve/refund.png",autoCenter:!1},button_cover_icon_no:{res:"images/ui/button_cover_icon_no.png",autoCenter:!1},button_cover_icon_yes:{res:"images/ui/button_cover_icon_yes.png",autoCenter:!1},button_cover_icon_home:{res:"images/ui/home.png",autoCenter:!1},button_cover_icon_rival:{res:"images/ui/rival.png",
autoCenter:!1},icon_clock:{res:"images/ui/icon_clock.png",autoCenter:!1},icon_clock_lock:{res:"images/ui/icon_clock_lock.png",autoCenter:!1},category_death:{res:"images/ui/category_death.png",autoCenter:!1},category_kill:{res:"images/ui/category_kill.png",autoCenter:!1},category_kill_total:{res:"images/ui/category_kill_total.png",autoCenter:!1},category_ranking:{res:"images/ui/category_ranking.png",autoCenter:!1},icon_leaderboard:{res:"images/ui/leaderboard_icon.png",autoCenter:!1},mobile_corner:{res:"images/ui/mobile_corner.png",
autoCenter:!1},bubble_background:{res:"images/ui/bubble_box/bubble_background.png",autoCenter:!1},bubble_transparent:{res:"images/ui/bubble_box/bubble_transparent.png",autoCenter:!1},bubble_transparent_small:{res:"images/ui/bubble_box/bubble_transparent_small.png",autoCenter:!1},toggle_light_on:{res:["images/ui/toggle_button/light_on.png","images/ui/toggle_button/light_off.png"],autoCenter:!1},toggle_light_off:{res:["images/ui/toggle_button/light_off.png"],autoCenter:!1},toggle_background:{res:"images/ui/toggle_button/onoroff_background.jpg",
autoCenter:!1},empty_button_slot:{res:"images/ui/empty_button_slot.png",autoCenter:!1},small_toggle_normal:{res:"images/ui/mod_ui/timer/off_standard.png",autoCenter:!1},small_toggle_high:{res:"images/ui/mod_ui/timer/off_high.png",autoCenter:!1},small_toggle_disabled:{res:"images/ui/mod_ui/timer/off_disabled.png",autoCenter:!1},small_toggle_on_normal:{res:"images/ui/mod_ui/timer/on_standard.png",autoCenter:!1},small_toggle_on_high:{res:"images/ui/mod_ui/timer/on_high.png",autoCenter:!1},bubble_box:{res:"images/ui/bubble_box/bubble_box.png",
autoCenter:!1},bubble_box_highlight:{res:"images/ui/bubble_box/bubble_box_highlight.png",autoCenter:!1},bubble_box_pressed:{res:"images/ui/bubble_box/bubble_box_pressed.png",autoCenter:!1},bubble_box_disabled:{res:"images/ui/bubble_box/bubble_box_disabled.png",autoCenter:!1},grad_box:{res:"images/ui/grad_box/grad_box.png",autoCenter:!1},grad_box_high:{res:"images/ui/grad_box/grad_box_high.png",autoCenter:!1},grad_box_pressed:{res:"images/ui/grad_box/grad_box_pressed.png",autoCenter:!1},grad_box_disabled:{res:"images/ui/grad_box/grad_box_disabled.png",
autoCenter:!1},grad_box_small:{res:"images/ui/grad_box/grad_box_small.png",autoCenter:!1},grad_box_small_high:{res:"images/ui/grad_box/grad_box_small_high.png",autoCenter:!1},grad_box_small_pressed:{res:"images/ui/grad_box/grad_box_small_pressed.png",autoCenter:!1},grad_box_small_disabled:{res:"images/ui/grad_box/grad_box_small_disabled.png",autoCenter:!1},left_button:{res:"images/ui/left.png",autoCenter:!1},left_button_hi:{res:"images/ui/left_highlight.png",autoCenter:!1},left_button_pressed:{res:"images/ui/left_pressed.png",
autoCenter:!1},left_button_disabled:{res:"images/ui/left_disabled.png",autoCenter:!1},right_button:{res:"images/ui/right.png",autoCenter:!1},right_button_hi:{res:"images/ui/right_highlight.png",autoCenter:!1},right_button_pressed:{res:"images/ui/right_pressed.png",autoCenter:!1},right_button_disabled:{res:"images/ui/left_disabled.png",autoCenter:!1},bubble_box_alert:{res:"images/ui/button_alert/bubble_box_alert00.png images/ui/button_alert/bubble_box_alert01.png images/ui/button_alert/bubble_box_alert02.png images/ui/button_alert/bubble_box_alert03.png images/ui/button_alert/bubble_box_alert04.png images/ui/button_alert/bubble_box_alert05.png images/ui/button_alert/bubble_box_alert06.png images/ui/button_alert/bubble_box_alert07.png images/ui/button_alert/bubble_box_alert08.png images/ui/button_alert/bubble_box_alert09.png images/ui/button_alert/bubble_box_alert10.png images/ui/button_alert/bubble_box_alert11.png images/ui/button_alert/bubble_box_alert12.png images/ui/button_alert/bubble_box_alert13.png images/ui/button_alert/bubble_box_alert14.png".split(" "),
animSpeed:15,autoCenter:!1},bubble_box_alert_still:{res:"images/ui/bubble_box/bubble_box_alert_nomotion.png",autoCenter:!1},win_anim:{res:"images/ui/winner_frames/winner_00.png images/ui/winner_frames/winner_01.png images/ui/winner_frames/winner_02.png images/ui/winner_frames/winner_03.png images/ui/winner_frames/winner_04.png images/ui/winner_frames/winner_05.png images/ui/winner_frames/winner_06.png images/ui/winner_frames/winner_07.png images/ui/winner_frames/winner_08.png images/ui/winner_frames/winner_09.png images/ui/winner_frames/winner_10.png images/ui/winner_frames/winner_11.png images/ui/winner_frames/winner_12.png images/ui/winner_frames/winner_13.png images/ui/winner_frames/winner_14.png images/ui/winner_frames/winner_15.png images/ui/winner_frames/winner_16.png images/ui/winner_frames/winner_17.png".split(" "),
animSpeed:15,autoCenter:!1,doUpdate:!1},win_idle:{res:"images/ui/winner_idle/winner_idle00.png images/ui/winner_idle/winner_idle01.png images/ui/winner_idle/winner_idle02.png images/ui/winner_idle/winner_idle03.png images/ui/winner_idle/winner_idle04.png images/ui/winner_idle/winner_idle05.png images/ui/winner_idle/winner_idle06.png images/ui/winner_idle/winner_idle07.png images/ui/winner_idle/winner_idle08.png images/ui/winner_idle/winner_idle09.png images/ui/winner_idle/winner_idle10.png images/ui/winner_idle/winner_idle11.png images/ui/winner_idle/winner_idle12.png images/ui/winner_idle/winner_idle13.png images/ui/winner_idle/winner_idle14.png".split(" "),
animSpeed:15,autoCenter:!1,doUpdate:!1},lt_button:{res:"images/ui/xbox_ui/lt_button.png"},rt_button:{res:"images/ui/xbox_ui/rt_button.png"},lb_button:{res:"images/ui/xbox_ui/bumper_lb.png"},rb_button:{res:"images/ui/xbox_ui/bumper_rb.png"},x_button:{res:"images/ui/xbox_ui/x_button.png"},a_button:{res:"images/ui/xbox_ui/a_button.png"},b_button:{res:"images/ui/xbox_ui/b_button.png"},dleft_button:{res:"images/ui/xbox_ui/d_pad_l.png"},dright_button:{res:"images/ui/xbox_ui/d_pad_r.png"},select_button:{res:"images/ui/xbox_ui/view_button.png"},
start_button:{res:"images/ui/xbox_ui/menu_button.png"}},oneTimeInit:function(){for(var a in d.assets){var b=d.assets[a];c.graphics.preLoadImages(b.res);var e=new c.graphics.ImageRef(b.res);b.image=e;!1!==b.autoCenter&&e.setCentered(!0,!0);b.animSpeed&&e.setAnimSpeed(b.animSpeed)}},initAfterLoad:function(){var a=this.getImage("a_button").copy();a.setCentered(!1,!1);var b=this.getImage("b_button").copy();b.setCentered(!1,!1);var e=this.getImage("mixer_spark_emblem").copy();e.setCentered(!1,!1);c.ui.TextBox.setSpecialImageMap({a_button:a,
b_button:b,mixer_spark_emblem:e})},update:function(a){},getImage:function(a,b){if(this.assets[a]&&this.assets[a].image)return this.assets[a].image;c.console.logWarning("warning: gfx asked for image "+a+", which doesn't exist.");return null},getImageCopy:function(a,b){return(a=d.getImage(a,b))?new c.graphics.ImageRef(a):null},drawAsset:function(a,b,c,f,d,k){a||(a=app.ctx);d||(d=0);a.save();a.translate(c,f);a.rotate(d);b=this.getImage(b);c=b.getSize();k||(k=c.w);b.draw(a,0,0,k,k/c.w*c.h);a.restore()},
getUserAvatar:function(a,b){0>a&&b(d.getImageCopy("default_avatar"));app.userInfoManager.getUserInfo(a,function(a,c){a=a&&c&&c.avatarImageRef?c.avatarImageRef:d.getImageCopy("default_avatar");b(a)})},testShark:function(){c.console.log("test shark");c.graphics.preLoadImages("https://wahoo1.sfo2.digitaloceanspaces.com/mixer/mixpunch/assets/prizes/shark_prize.png");imageRef=new c.graphics.ImageRef("https://wahoo1.sfo2.digitaloceanspaces.com/mixer/mixpunch/assets/prizes/shark_prize.png");d.assets.ticket.image=
imageRef}};window.gfx=d});
rat.modules.add("js.graphics.effects",[{name:"js.ui.ui",processBefore:!0},"rat.graphics.r_graphics","rat.graphics.r_particle","js.ui.ui"],function(c){var d={oneTimeInit:function(){d.particles=c.particle.createSystem();d.spark=gfx.getImage("spark");d.mixer_spark=gfx.getImage("mixer_spark_icon");d.ray_burst=gfx.getImage("ray_burst");d.smoke_puff=gfx.getImage("smoke_puff");d.smoke_ring=gfx.getImage("smoke_ring");d.ticket=gfx.getImage("ticket");d.text_flash_back=gfx.getImage("text_flash_back");d.iconBetYes=
gfx.getImageCopy("icon_bet_yes");d.iconBetYes.setCentered(!0,!0);d.iconBetNo=gfx.getImageCopy("icon_bet_no");d.iconBetNo.setCentered(!0,!0);d.flashupReasonEmitter=d.makeFlashupReasonEmitter();d.flashupEmitter=d.makeFlashupEmitter();d.dtRef=0;d.betNotices=[]},reset:function(){d.particles.killAllEmitters(!0);d.betNotices=[]},update:function(a){d.particles.update(a);d.dtRef=a;d.updateBetNotices(a)},drawEvents:function(a){},drawOverUI:function(a){d.drawBetNotices(a)},makeFlashupEmitter:function(){emitter=
d.particles.newEmitter();emitter.pos.x=0;emitter.pos.y=0;emitter.asset="";emitter.emitType=c.particle.System.emitTypeBurst;emitter.renderType=c.particle.System.RENDER_TEXT;emitter.font=ui.config.mainFont.font;emitter.fontSize=1;emitter.startState.ageLimit=1.35;emitter.startVariance.ageLimit=0;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startVariance.grow=0;emitter.startState.color.r=30;emitter.startState.color.g=186;emitter.startState.color.b=240;emitter.startState.color.a=1;emitter.startState.vel.y=
-300;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=0;emitter.startState.accel.y=400;emitter.addState(.9).state.color=new c.graphics.Color(30,186,240,255);emitter.initEndState();emitter.endState.color.a=0;return emitter},textFlashup:function(a,b,c){d.flashupEmitter.pos.x=a;d.flashupEmitter.pos.y=b;d.flashupEmitter.asset=c;d.flashupEmitter.spawn(1)},makeFlashupReasonEmitter:function(){emitter=d.particles.newEmitter();emitter.pos.x=0;emitter.pos.y=0;emitter.asset=
"";emitter.emitType=c.particle.System.emitTypeBurst;emitter.renderType=c.particle.System.RENDER_TEXT;emitter.font=ui.config.mainFont.font;emitter.fontSize=1;emitter.startState.ageLimit=4;emitter.startVariance.ageLimit=0;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startVariance.grow=0;emitter.startState.color.r=30;emitter.startState.color.g=186;emitter.startState.color.b=240;emitter.startState.color.a=0;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=
0;emitter.createEvent=function(a,c){d.reasonAppearEffect(c.pos.x,c.pos.y,60);audio.playSound("ticket_collect")};var a=emitter.addState(.1);a.state.color=new c.graphics.Color(30,186,240,255);a=emitter.addState(.9);a.state.color=new c.graphics.Color(30,186,240,255);emitter.initEndState();emitter.endState.color.a=0;return emitter},reasonFlashup:function(a,b,c){d.flashupReasonEmitter.pos.x=a;d.flashupReasonEmitter.pos.y=b;d.flashupReasonEmitter.asset=c;d.flashupReasonEmitter.spawn(1)},doWinnerEffects:function(a,
b){var c={r:76,g:46,b:136},f={r:76,g:107,b:161};d.winnerDots(a,b,c);d.winnerDots(a,b,f);backgroundEffects.winnerDots(a,b,c);backgroundEffects.winnerDots(a,b,f);backgroundEffects.winnerFlash(a,b);audio.playSound("end_results")},gatherTicketEffect:function(a,b,e,f,g,k,h){var l=Math.floor(g/f);(function(a,b,g){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.pos.x=a.x;emitter.pos.y=a.y;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ticket;emitter.emitType=
c.particle.System.emitTypeBurst;emitter.rate=20;emitter.emitCounter=1/emitter.rate+1E-4;emitter.burstCount=f;emitter.burstAmount=1;emitter.createEvent=function(a,b){audio.playSound("ticket_collect");k&&(k.setTextValue(parseInt(k.getTextValue())-l),1>=emitter.burstCount&&h.setVisible(!1))};emitter.deathEvent=function(a,b){d.catchTicketEffect(b.pos.x,b.pos.y,9);d.ticketFlash(b.pos.x,b.pos.y);audio.playSound("ticket_collect");e.setTextValue(parseInt(e.getTextValue())+l);1===a.particles.length&&e.managedUpdateState--};
emitter.startState.ageLimit=1;emitter.startVariance.ageLimit=.25;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startState.grow=0;emitter.startVariance.grow=0;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=255;var m=new c.graphics.Color(0,0,0);emitter.startVariance.color=m;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=700;emitter.startState.friction=2.5;emitter.startState.roll=
2.7;emitter.startVariance.roll=0;var q=emitter.addState(.1);q.state.pos.x=b.x;q.state.pos.y=b.y;q.variance.color=m.copy();q=emitter.addState(.95);q.state.pos.x=g.x+emitter.asset.getSize().w;q.state.pos.y=g.y-emitter.asset.getSize().h/2;q.variance.color=m.copy();emitter.initEndState();emitter.endState.roll=40;emitter.startState.pos.x=a.x;emitter.startState.pos.y=a.y;emitter.endState.pos.x=g.x;emitter.endState.pos.y=g.y;emitter.endVariance.offset.x=5;emitter.endVariance.color=m.copy();emitter.posInterp=
function(a,b,e,f){e.x=c.utils.interpolate(a.x,b.x,f);e.y=c.utils.interpolate(a.y,b.y,f)};return emitter})(a,{x:a.x+1300,y:(a.y+b.y)/2},b);return 1},betTicketEffect:function(a,b,e,f,g){var k=Math.floor(f/e);endPos=b.getGlobalPos();(function(a,f,m){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.pos.x=a.x;emitter.pos.y=a.y;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ticket;emitter.emitType=c.particle.System.emitTypeBurst;emitter.rate=100;emitter.emitCounter=
1/emitter.rate+1E-4;emitter.burstCount=1;emitter.burstAmount=e;emitter.createEvent=function(){var a=parseInt(g.getTextValue());0<a?g.setTextValue(a-k):g.setTextValue(0)};emitter.deathEvent=function(a,c){d.catchTicketEffect(m.x,m.y,9);audio.playSound("ticket_collect");isNaN(parseInt(b.getTextValue()))&&b.setTextValue(0);b.setTextValue(parseInt(b.getTextValue())+k);1===a.particles.length&&b.managedUpdateState--};emitter.onDestroy=function(){setTimeout(function(){g.managedUpdateState--},500)};emitter.startState.ageLimit=
.25;emitter.startVariance.ageLimit=.125;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startState.grow=-60;emitter.startVariance.grow=0;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=255;var h=new c.graphics.Color(0,0,0);emitter.startVariance.color=h;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=700;emitter.startState.friction=2.5;emitter.startState.roll=2.7;emitter.startVariance.roll=
0;var l=emitter.addState(.1);l.state.pos.x=f.x;l.state.pos.y=f.y;l.variance.color=h.copy();l=emitter.addState(.95);l.state.pos.x=m.x+emitter.asset.getSize().w;l.state.pos.y=m.y-emitter.asset.getSize().h/2;l.variance.color=h.copy();emitter.initEndState();emitter.endState.roll=40;emitter.startState.pos.x=a.x;emitter.startState.pos.y=a.y;emitter.endState.pos.x=m.x;emitter.endState.pos.y=m.y;emitter.endVariance.color=h.copy();emitter.posInterp=function(a,e,f,d){m=b.getGlobalPos(b.size.x/2,b.size.y/2);
f.x=c.utils.interpolate(a.x,m.x,d);f.y=c.utils.interpolate(a.y,m.y,d)};return emitter})(a,{x:endPos.x,y:a.y},endPos);return.25},giveTicketEffect:function(a,b,e,f,g,k,h){var l=Math.floor(g/f);(function(a,b,g){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.pos.x=a.x;emitter.pos.y=a.y;emitter.emitType=c.particle.System.emitTypeStream;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ticket;emitter.emitType=c.particle.System.emitTypeBurst;emitter.rate=
20;emitter.emitCounter=1/emitter.rate+1E-4;emitter.burstCount=Math.max(Math.floor(f/3),1);emitter.burstAmount=Math.min(f,3);emitter.createEvent=function(){k.setTextValue(parseInt(k.getTextValue())-l);1>=emitter.burstCount&&(h.setVisible(!1),k.setTextValue(0))};emitter.deathEvent=function(a,b){audio.playSound("refund_collect");e.setTextValue(parseInt(e.getTextValue())+l);1===a.particles.length&&e.managedUpdateState--};emitter.startState.ageLimit=.5;emitter.startVariance.ageLimit=0;emitter.startState.size=
40;emitter.startVariance.size=0;emitter.startState.grow=-20;emitter.startVariance.grow=0;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=255;var m=new c.graphics.Color(0,0,0);emitter.startVariance.color=m;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=700;emitter.startState.friction=2.5;emitter.startState.roll=2.7;emitter.startVariance.roll=0;var q=emitter.addState(.5);q.state.pos.x=b.x;q.state.pos.y=
b.y;emitter.initEndState();emitter.endState.roll=40;emitter.startState.pos.x=a.x;emitter.startState.pos.y=a.y;emitter.endState.pos.x=g.x;emitter.endState.pos.y=g.y;emitter.endVariance.color=m.copy();emitter.posInterp=function(a,b,e,f){e.x=c.utils.interpolate(a.x,b.x,f);e.y=c.utils.interpolate(a.y,b.y,f)};return emitter})(a,{x:b.x-128,y:.5*(a.y-b.y)},b)},reasonAppearEffect:function(a,b,e){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;
emitter.pos.x=a;emitter.pos.y=b;emitter.startVariance.offset.x=600;emitter.startVariance.offset.y=4;emitter.setupStandardBurst(e);emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.spark;emitter.setAdditive();emitter.startState.ageLimit=.2;emitter.startVariance.ageLimit=.2;emitter.startState.size=20;emitter.startVariance.size=10;emitter.startState.grow=-40;emitter.startVariance.grow=20;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=
24;emitter.startVariance.color.g=24;emitter.startVariance.color.b=30;emitter.startState.vel.x=200;emitter.startState.vel.y=0;emitter.startVariance.vel.x=80;emitter.startVariance.vel.y=0;emitter.startState.friction=2.5;emitter.startState.accel.y=120;emitter.startState.roll=0;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},catchTicketEffect:function(a,b,e){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=
c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.setupStandardBurst(e);emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.spark;emitter.setAdditive();emitter.startState.ageLimit=.2;emitter.startVariance.ageLimit=.2;emitter.startState.size=20;emitter.startVariance.size=10;emitter.startState.grow=-40;emitter.startVariance.grow=20;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=24;
emitter.startVariance.color.g=24;emitter.startVariance.color.b=30;emitter.startState.vel.x=200;emitter.startState.vel.y=0;emitter.startVariance.vel.x=80;emitter.startVariance.vel.y=0;emitter.startState.friction=2.5;emitter.startState.accel.y=120;emitter.startState.roll=0;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},ticketFlash:function(a,b){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;
emitter.pos.x=a;emitter.pos.y=b;emitter.angle.angle=Math.random()*Math.PI*2;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ray_burst;emitter.setAdditive();emitter.setupStandardBurst(3);emitter.startState.ageLimit=.35;emitter.startVariance.ageLimit=.1;emitter.startState.size=25;emitter.startVariance.size=250;emitter.startState.grow=500;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=180;emitter.startVariance.color.r=
0;emitter.startVariance.color.g=0;emitter.startVariance.color.b=0;emitter.startVariance.color.a=20;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=4;emitter.startVariance.roll=1;emitter.initEndState();emitter.endState.color.a=0},smokeRingEffect:function(a,b){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=
b;emitter.setupStandardBurst(6);emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.smoke_ring;emitter.startState.ageLimit=.75;emitter.startVariance.ageLimit=.15;emitter.startState.size=80;emitter.startVariance.size=20;emitter.startState.grow=160;emitter.startVariance.grow=80;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=255;emitter.startVariance.color.g=255;emitter.startVariance.color.b=255;emitter.startState.vel.x=
80;emitter.startState.vel.y=10;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=2.5;emitter.startState.accel.y=0;emitter.startState.roll=0;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},multiplierFlash:function(a,b){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.angle.angle=Math.random()*
Math.PI*2;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ray_burst;emitter.setAdditive();emitter.setupStandardBurst(3);emitter.startState.ageLimit=.35;emitter.startVariance.ageLimit=.1;emitter.startState.size=25;emitter.startVariance.size=250;emitter.startState.grow=500;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=180;emitter.startVariance.color.r=0;emitter.startVariance.color.g=0;emitter.startVariance.color.b=
0;emitter.startVariance.color.a=20;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=4;emitter.startVariance.roll=1;emitter.initEndState();emitter.endState.color.a=0},multiplierSparks:function(a,b,e){e=void 0===e?150:e;emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.startVariance.offset.x=
20;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.spark;emitter.emitType=c.particle.System.emitTypeBurst;emitter.emitCounter=1;emitter.burstCount=1;emitter.burstAmount=e;emitter.setAdditive();emitter.startState.ageLimit=1.2;emitter.startVariance.ageLimit=.2;emitter.startState.size=20;emitter.startVariance.size=10;emitter.startState.grow=-40;emitter.startVariance.grow=20;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=
24;emitter.startVariance.color.g=24;emitter.startVariance.color.b=30;emitter.startState.vel.x=100;emitter.startState.vel.y=0;emitter.startVariance.vel.x=40;emitter.startVariance.vel.y=0;emitter.startState.friction=5.5;emitter.startState.accel.y=-120;emitter.startState.roll=0;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},winnerDots:function(a,b,e){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;
emitter.pos.x=a;emitter.pos.y=b;emitter.angle.angle=Math.random()*Math.PI*2;emitter.emitType=c.particle.System.emitTypeBurst;emitter.renderType=c.particle.System.RENDER_DOT;emitter.setupStandardBurst(20);emitter.rate=1;emitter.burstCount=1;emitter.startState.ageLimit=4.5;emitter.startVariance.ageLimit=2.5;emitter.startState.size=50;emitter.startVariance.size=20;emitter.startState.grow=-10;emitter.startState.color.r=e.r;emitter.startState.color.g=e.g;emitter.startState.color.b=e.b;emitter.startVariance.color.r=
0;emitter.startVariance.color.g=0;emitter.startVariance.color.b=0;emitter.startState.vel.x=700;emitter.startState.vel.y=0;emitter.startVariance.vel.x=250;emitter.startVariance.vel.y=0;emitter.startState.friction=1;emitter.startState.accel.y=95;emitter.startVariance.roll=5;emitter.addState(.9).state.color.a=1;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.size=0},doTicketBurst:function(a,b){count=Math.min(30,b/10);emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;
emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a.x;emitter.pos.y=a.y;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.ticket;emitter.setupStandardBurst(count);emitter.startState.ageLimit=3;emitter.startVariance.ageLimit=0;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;emitter.startState.color.a=255;emitter.startVariance.color.r=0;emitter.startVariance.color.g=
0;emitter.startVariance.color.b=0;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=300;emitter.startVariance.vel.y=200;emitter.startState.accel.y=1E3;emitter.startVariance.roll=1;emitter.initEndState();emitter.endState.color.a=0;return 1},doTicketEffect:function(a,b){d.gatherTicketEffect(a,b,valueObj,1,1)},earnMultiTicketEffect:function(a,b,c,f,g,k){var e=Math.min(f/10,30);"undefined"===typeof c.managedUpdateState&&(c.managedUpdateState=0,console.warn("Created a managedUpdateState variable for a valueObj that had none. Bad things may happen."));
d.gatherTicketEffect(a,b,c,e,f,g,k)},betMultiTicketEffect:function(a,b,c,f){var e=Math.round(Math.min(c/10,30));"undefined"===typeof f.managedUpdateState&&(f.managedUpdateState=0);f.managedUpdateState++;b.managedUpdateState++;d.betTicketEffect(a,b,e,c,f)},refundMultiTicketEffect:function(a,b,c,f,g,k){var e=Math.round(Math.min(f/10,30));"undefined"===typeof c.managedUpdateState&&(c.managedUpdateState=0);d.giveTicketEffect(a,b,c,e,f,g,k)},addBetNotice:function(a,b){this.betNotices.push({timer:1.5,timerStart:1.5,
x:a.x+Math.random()*a.w,y:a.y+Math.random()*a.h,betDetails:b})},updateBetNotices:function(a){for(var b=this.betNotices.length-1;0<=b;b--){var c=this.betNotices[b];c.timer-=a;0>=c.timer?this.betNotices.splice(b,1):(c.interp=c.timer/c.timerStart,c.y-=20*a)}},drawBetNotices:function(a){a.font="26px "+ui.config.mainFont.font;a.textAlign="left";a.textBaseline="middle";a.fillStyle="#FFFFFF";for(var b=0;b<this.betNotices.length;b++){var c=this.betNotices[b];a.save();a.globalAlpha=c.interp;var f=c.betDetails.avatarImageRef;
f&&app.types.avatarIcon.drawUserAvatar(a,f,c.x,c.y,60,null);a.fillText(c.betDetails.username,c.x+40,c.y-2,300);a.restore()}},giveSparksFlash:function(a,b,e){count=150;emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.startVariance.offset.x=20;emitter.emitType=c.particle.System.emitTypeStream;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.spark;emitter.rate=500;
emitter.ageLimit=e/10;emitter.setAdditive();emitter.startState.ageLimit=1.2;emitter.startVariance.ageLimit=.2;emitter.startState.size=20;emitter.startVariance.size=10;emitter.startState.grow=-40;emitter.startVariance.grow=20;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=24;emitter.startVariance.color.g=24;emitter.startVariance.color.b=30;emitter.startState.vel.x=100;emitter.startState.vel.y=0;emitter.startVariance.vel.x=
40;emitter.startVariance.vel.y=0;emitter.startState.friction=5.5;emitter.startState.accel.y=-120;emitter.startState.roll=0;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},giveSparksRing:function(a,b){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.setupStandardBurst(200);emitter.renderType=c.particle.System.RENDER_SPRITE;
emitter.asset=d.spark;emitter.setAdditive();emitter.startState.ageLimit=.75;emitter.startVariance.ageLimit=.25;emitter.startState.size=60;emitter.startVariance.size=.25;emitter.startState.grow=-60;emitter.startVariance.grow=-20;emitter.startState.color.r=230;emitter.startState.color.g=230;emitter.startState.color.b=150;emitter.startVariance.color.r=255;emitter.startVariance.color.g=255;emitter.startVariance.color.b=255;emitter.startState.vel.x=600;emitter.startState.vel.y=0;emitter.startVariance.vel.x=
60;emitter.startVariance.vel.y=0;emitter.startState.friction=2.5;emitter.startState.accel.y=0;emitter.startState.roll=1;emitter.startVariance.roll=.25;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0},giveSparksEffect:function(a,b,e){d.giveSparksRing(a.x,a.y);(function(a,b,e,h){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;emitter.pos.x=a.x;emitter.pos.y=a.y;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.mixer_spark;emitter.emitType=
c.particle.System.emitTypeBurst;emitter.rate=8;emitter.emitCounter=1/emitter.rate+1E-4;emitter.burstCount=h;emitter.burstAmount=10;emitter.createEvent=function(a,b){};emitter.deathEvent=function(a,b){audio.playSound("spark_collect")};emitter.startState.ageLimit=1;emitter.startVariance.ageLimit=.25;emitter.startState.size=40;emitter.startVariance.size=0;emitter.startState.grow=0;emitter.startVariance.grow=0;emitter.startState.color.r=255;emitter.startState.color.g=255;emitter.startState.color.b=255;
emitter.startState.color.a=255;h=new c.graphics.Color(0,0,0);emitter.startVariance.color=h;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=700;emitter.startState.friction=2.5;emitter.startState.roll=2.7;emitter.startVariance.roll=0;var f=emitter.addState(.1);f.state.pos.x=b.x;f.state.pos.y=b.y;f.variance.color=h.copy();f=emitter.addState(.95);f.state.pos.x=e.x+emitter.asset.getSize().w;f.state.pos.y=e.y-emitter.asset.getSize().h/2;f.variance.color=h.copy();emitter.initEndState();
emitter.endState.roll=40;emitter.startState.pos.x=a.x;emitter.startState.pos.y=a.y;emitter.endState.pos.x=e.x;emitter.endState.pos.y=e.y;emitter.endVariance.offset.x=5;emitter.endVariance.color=h.copy();emitter.posInterp=function(a,b,e,f){e.x=c.utils.interpolate(a.x,b.x,f);e.y=c.utils.interpolate(a.y,b.y,f)};return emitter})(a,{x:a.x+1300,y:(a.y+b.y)/2},b,e);d.giveSparksFlash(a.x,a.y,e);return 1}};window.effects=d});
rat.modules.add("js.graphics.background_effects",[{name:"js.ui.ui",processBefore:!0},"rat.graphics.r_graphics","rat.graphics.r_particle","js.ui.ui"],function(c){var d={oneTimeInit:function(){d.particles=c.particle.createSystem();d.winner_flash=gfx.getImage("winner_flash")},reset:function(){d.particles.killAllEmitters(!0)},update:function(a){d.particles.update(a)},drawEvents:function(a){},drawOverUI:function(a){},winnerDots:function(a,b,e){emitter=d.particles.newEmitter();emitter.flags|=c.particle.Emitter.fAutoDie;
emitter.flags|=c.particle.Emitter.fRadialStartVelocity;emitter.pos.x=a;emitter.pos.y=b;emitter.angle.angle=Math.random()*Math.PI*2;emitter.emitType=c.particle.System.emitTypeBurst;emitter.renderType=c.particle.System.RENDER_DOT;emitter.setupStandardBurst(20);emitter.rate=2;emitter.burstCount=5;emitter.startState.ageLimit=4.5;emitter.startVariance.ageLimit=2.5;emitter.startState.size=50;emitter.startVariance.size=20;emitter.startState.grow=-10;emitter.startState.color.r=e.r;emitter.startState.color.g=
e.g;emitter.startState.color.b=e.b;emitter.startVariance.color.r=25;emitter.startVariance.color.g=25;emitter.startVariance.color.b=25;emitter.startState.vel.x=350;emitter.startState.vel.y=0;emitter.startVariance.vel.x=250;emitter.startVariance.vel.y=0;emitter.startState.friction=1;emitter.startState.accel.y=95;emitter.startVariance.roll=5;emitter.addState(.9).state.color.a=1;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.size=0},winnerFlash:function(a,b){emitter=d.particles.newEmitter();
emitter.flags|=c.particle.Emitter.fAutoDie;emitter.pos.x=a;emitter.pos.y=b;emitter.emitType=c.particle.System.emitTypeBurst;emitter.renderType=c.particle.System.RENDER_SPRITE;emitter.asset=d.winner_flash;emitter.setAdditive();emitter.setupStandardBurst(1);emitter.startState.ageLimit=.2;emitter.startVariance.ageLimit=0;emitter.startState.size=650;emitter.startVariance.size=0;emitter.startState.grow=250;emitter.startState.color.r=180;emitter.startState.color.g=180;emitter.startState.color.b=180;emitter.startVariance.color.r=
25;emitter.startVariance.color.g=25;emitter.startVariance.color.b=25;emitter.startState.vel.x=0;emitter.startState.vel.y=0;emitter.startVariance.vel.x=0;emitter.startVariance.vel.y=0;emitter.startState.friction=1;emitter.startState.accel.y=0;emitter.startVariance.roll=0;emitter.initEndState();emitter.endState.color.a=0;emitter.endState.roll=0}};window.backgroundEffects=d});
rat.modules.add("js.ui.ui",[{name:"rat.graphics.r_color",processBefore:!0},{name:"rat.ui.r_ui",processBefore:!0},"js.ui.confirm_popup"],function(c){var d=new c.graphics.Color(30,186,240),a={config:{buttonWidth:294,buttonHeight:76,buttonGap:12,buttonCornerRadius:3,smallButtonWidth:62,smallButtonHeight:64,smallButtonMargin:5,pulldownButtonWidth:480,pulldownButtonHeight:67,menuButtonWidth:294,menuButtonHeight:73,playerIconSize:72,actionButtonWidth:258,actionButtonHeight:67,smallModButtonWidth:108,smallModButtonHeight:78,
modActionButtonWidth:108,modActionButtonHeight:92,smallToggleButtonWidth:65,smallToggleButtonHeight:41,sparkButtonWidth:302,sparkButtonHeight:126,wideModButtonWidth:124,betButtonWidth:146,betButtonHeight:134,betButtonGap:16,buttonColor:new c.graphics.Color(140,100,50),creditsColor:d,badTextColor:new c.graphics.Color("#EB1749"),blueTextColor:new c.graphics.Color(140,153,190),modTextColor:new c.graphics.Color(235,235,135),blueBoxColor:new c.graphics.Color(133,200,251,.2),darkBoxColor:new c.graphics.Color(0,
0,0,.65),infoBoxColor:new c.graphics.Color(34,53,28,.45),popBorderColor:"#384B8F",popBackColor:"#0A192D",modPopBorderColor:"#eaea86",modPopBackColor:"#213617",yesColor:new c.graphics.Color(130,158,96),noColor:new c.graphics.Color(182,80,80),buttonFont:{font:"industry-demi",style:"bold",size:35},offerFont:{font:"industry-demi",style:"bold",size:34},pulldownButtonFont:{font:"industry-demi",style:"bold",size:32},pulldownListFont:{font:"industry-demi",style:"bold",size:46},titleFont:{font:"industry-demi",
style:"",size:60,color:new c.graphics.Color(140,153,190)},stateFont:{font:"industry-demi",style:"",size:60,color:new c.graphics.Color(140,153,190)},logFont:{font:"industry-demi",style:"",size:24,color:new c.graphics.Color(235,235,135)},leaderboardFont:{font:"industry-demi",style:"",size:32,color:new c.graphics.Color(140,153,190)},labelFont:{font:"industry-demi",style:"",size:36,color:new c.graphics.Color(240,240,240)},toggleFont:{font:"industry-demi",style:"",size:35,color:new c.graphics.Color(235,
112,255),colorOn:new c.graphics.Color(235,112,255),colorOff:new c.graphics.Color(115,58,170)},headingFont:{font:"industry-demi",style:"bold",size:46,color:new c.graphics.Color(240,240,240)},mainFont:{font:"industry-demi",style:"",size:26,color:new c.graphics.Color(140,153,190)},smallOfferInfoFont:{font:"industry-demi",style:"",size:26,color:new c.graphics.Color(235,235,185)},normalCurrencyFont:{font:"industry-demi",style:"",size:36,color:d},tinyCurrencyFont:{font:"industry-demi",style:"",size:24,
color:d},tinyTimeFont:{font:"industry-demi",style:"",size:24,color:new c.graphics.Color("362B63")},tinyLocksInFont:{font:"industry-demi",style:"",size:24,color:new c.graphics.Color("A953BB")},tinyInfoFont:{font:"industry-demi",style:"",size:24,color:new c.graphics.Color("EAEB87")},multiplierFont:{font:"industry-demi",style:"",size:24,color:d},givesFont:{font:"industry-demi",style:"",size:24,color:new c.graphics.Color("BBBBBB")},summaryFont:{font:"industry-demi",style:"",size:28,color:new c.graphics.Color("DDDDDD")},
resolvingInfoFont:{font:"industry-demi",style:"",size:30,color:new c.graphics.Color("441F49")},resolvingResultFont:{font:"industry-demi",style:"",size:34,color:new c.graphics.Color("441F49")},whyFont:{font:"industry-demi",style:"",size:28,color:new c.graphics.Color("DDDDDD")},tipFont:{font:"industry-demi",style:"",size:36,color:new c.graphics.Color(160,160,160)},titleOffset:80,backButtonOffset:300,BUTTON_IMAGE:"images/ui/grad_box/grad_box.png",BUTTON_IMAGE_HIGHLIGHTED:"images/ui/grad_box/grad_box_high.png",
BUTTON_IMAGE_PRESSED:"images/ui/grad_box/grad_box_pressed.png",BUTTON_IMAGE_DISABLED:"images/ui/grad_box/grad_box_disabled.png",BUTTON_SMALL_IMAGE:"images/ui/grad_box/grad_box_small.png",BUTTON_SMALL_IMAGE_HIGHLIGHTED:"images/ui/grad_box/grad_box_small_high.png",BUTTON_SMALL_IMAGE_PRESSED:"images/ui/grad_box/grad_box_small_pressed.png",BUTTON_SMALL_IMAGE_DISABLED:"images/ui/grad_box/grad_box_small_disabled.png",GRADIENT_INSET:8,BUTTON_PURPLE:{normal:{gradient:["#462f89","#6B2976"],textColor:"#BB9FB7"},
highlighted:{gradient:["#5539A0","#8E3B9D"],textColor:"#FFFFFF"},disabled:{gradient:["#321E5F","#551E5A"],textColor:"#A582A0"},pressed:{gradient:["#221840","#3F1646"],textColor:"#5E2956"}},BUTTON_PURPLE_NON:{normal:{gradient:["#462f89","#6B2976"],textColor:"#BB9FB7"},highlighted:{gradient:["#5539A0","#8E3B9D"],textColor:"#FFFFFF"},disabled:{gradient:["#321E5F","#551E5A"],textColor:"#A582A0"},pressed:{gradient:["#5539A0","#8E3B9D"],textColor:"#FFFFFF"}},BUTTON_MOD:{normal:{gradient:["#2B4B21","#689248"],
textColor:"#EAEB87"},highlighted:{gradient:["#3C6432","#78B44E"],textColor:"#FFFFFF"},disabled:{gradient:["#1E1E1E","#505050"],textColor:"#AAAAAA"},pressed:{gradient:["#16280F","#345523"],textColor:"#69693A"}},BUTTON_FLASHY:{normal:{gradient:["#929248","#D0D070"],textColor:"#EAEB87"},highlighted:{gradient:["#646432","#B4B44E"],textColor:"#FFFFFF"},disabled:{gradient:["#323214","#73733C"],textColor:"#AAAA5F"},pressed:{gradient:["#28280F","#555523"],textColor:"#69693A"}},GAME_INFO_PANE_W:1020,GAME_INFO_PANE_H:130,
GAME_STAT_PANE_W:940,GAME_STAT_PANE_H:100,BUBBLE_BOX_ART_MARGIN:16,ARROW_TAB_SIZE_X:32,ARROW_TAB_SIZE_Y:17,BUTTON_ICON_SCALE:1,SMALL_BUTTON_BOUNDS_SCALE:.6,MOBILE_RAFFLE_SCALE:1,DROP_DOWN_ANIM_TIME:.25,LOG_BACKGROUND_OPACITY:.65,SCREEN_SIDE_W:130,HOLDER_X_SHIFT:-6,TOGGLE_CONTROL_W:398,TOGGLE_CONTROL_H:86,TOGGLE_MARGIN:18},curScreen:null,snapScreen:null,lastSize:{x:c.graphics.SCREEN_WIDTH,y:c.graphics.SCREEN_HEIGHT},screenColor:new c.graphics.Color(32,67,255),screenBorderColor:new c.graphics.Color(130,
130,130),mobileBackdropColor:"#263a6c"};a.menuButtonSpacing={x:a.config.buttonWidth+a.config.buttonGap,y:a.config.buttonHeight+a.config.buttonGap};"mobile"===app.platform&&(a.config.smallButtonWidth*=1.4,a.config.smallButtonHeight*=1.4,a.config.pulldownButtonHeight=a.config.smallButtonHeight);a.init=function(){c.ui.Button.setDefaultTextInset(20);c.ui.BubbleBox_setDefaultDrawType("stretch")};a.formatMap=[{formatChar:"^",color:new c.graphics.Color("#1EBAF0")},{formatChar:"~",color:new c.graphics.Color("#7CBE28")},
{formatChar:"|",color:new c.graphics.Color("#EB1749")},{formatChar:"*",color:new c.graphics.Color("#EAEB87")},{formatChar:"\u03c4",color:a.config.creditsColor}];a.formatText=function(b){return c.ui.TextBox.formatText(b,a.formatMap)};a.makeDropButtonAt=function(b,e,f,d,k,h){b=a.makeButtonAt(b,e,f,d,k,h);a.setFontProperties(b,a.config.pulldownButtonFont);e=new c.ui.Sprite(b);e.useImageRef(gfx.getImage("button_tab_up"));e.setPos(k-64,b.size.y/2-e.size.y/2);b.dropArrow=e;return b};a.setDropButtonState=
function(a,c){"open"===c?a.dropArrow.useImageRef(gfx.getImage("button_tab_up")):a.dropArrow.useImageRef(gfx.getImage("button_tab_down"))};a.makeToggleButtonAt=function(a,c,f,d,k,h,l){return new app.types.ToggleControl(a,c,{x:f,y:d},k,h,void 0===l?"STR_TOGGLE_TOOLTIP":l)};a.makeTextValueBox=function(b,e,f,d){d=void 0===d?"regular":d;var g=a.config.TOGGLE_CONTROL_W,h=300;if(isNaN(d))switch(d){case "single":g=48;h=16;break;case "doubleWide":g=2*a.config.TOGGLE_CONTROL_W+96,h=96}else g=d;b.editDiv||(b.editDiv=
c.graphics.layerDiv.make(app.canvasElement));b.inputBoxes||(b.inputBoxes=[]);void 0===b.inputIndex&&(b.inputIndex=0);b.changed=!1;var l=b.inputBoxes.length,m=new c.ui.Element(b);m.setSize(g,a.config.menuButtonHeight);tBox=a.makeText(m,e,0,0,300<g?g:300);m.tBox=tBox;var n=new c.ui.DOMEditText(m,b.editDiv,{className:"botInputBox"});n.setTextValue(void 0===f.defaultText?"":""+f.defaultText);n.setSize(g,50);n.domEditBox.maxLength=h;a.setFontProperties(n,a.config.labelFont);n.domEditBox.wrap="off";n.domEditBox.style.resize=
"none";n.inputIndex=l;n.setTextChangeCallback(function(a,b){m.value=b});a.applyTooltip(m,f.tooltip);m.eBox=n;n.setFocusCallback(function(a){a.target&&(b.inputIndex=l)});e={ratElement:n,domElement:n.getDOMElement(),inputIndex:l};b.inputBoxes.push(e);m.updatePos=function(){n.updateDOMPlacement({x:-8,y:24,w:g,h:50});a.applyTooltip(m,f.tooltip)};n.domEditBox.addEventListener("keydown",function(a){13===a.keyCode?(a.stopPropagation(),a.preventDefault()):16===a.keyCode?b.shiftDown=!0:9===a.keyCode&&(a.preventDefault(),
b.tabDown=!0);if(b.tabDown){a=1;b.shiftDown&&(a=-1);var c=b.inputBoxes.length;b.inputIndex=(b.inputIndex+a+c)%c;b.inputBoxes[b.inputIndex].domElement.focus();b.inputBoxes[b.inputIndex].domElement.select();b.tabDown=!1}},!1);n.domEditBox.addEventListener("keyup",function(a){13===a.keyCode&&(b.tabDown=!1);16===a.keyCode&&(b.shiftDown=!1)});return m};a.makeTextSettingBox=function(b,e,f,d){d=void 0===d?"regular":d;var g=a.config.TOGGLE_CONTROL_W,h=300;switch(d){case "single":g=48;h=16;break;case "doubleWide":g=
2*a.config.TOGGLE_CONTROL_W+96;h=256;break;case "time":g=98,h=5}b.editDiv||(b.editDiv=c.graphics.layerDiv.make(app.canvasElement));b.inputBoxes||(b.inputBoxes=[]);void 0===b.inputIndex&&(b.inputIndex=0);b.changed=!1;var l=b.inputBoxes.length,m=new c.ui.Element(b);m.setSize(g,a.config.menuButtonHeight);tBox=a.makeText(m,e,0,0,300<g?g:300);m.tBox=tBox;m.valuesRef=f;var n=new c.ui.DOMEditText(m,b.editDiv,{className:"botInputBox"});e=void 0===f.setting?"":""+f.setting;"time"===d&&(e=a.toTime(e));n.setTextValue(e);
n.setSize(g,50);n.domEditBox.maxLength=h;a.setFontProperties(n,a.config.labelFont);n.domEditBox.wrap="off";n.domEditBox.style.resize="none";n.inputIndex=l;n.setTextChangeCallback(function(b,c){"time"===d&&a.getTime(this.domEditBox);m.button.setVisible(!0)});a.applyTooltip(m,f.tooltip);n.setFocusCallback(function(a){a.target&&(b.inputIndex=l)});h={ratElement:n,domElement:n.getDOMElement(),inputIndex:l};b.inputBoxes.push(h);m.updatePos=function(){n.updateDOMPlacement({x:-8,y:24,w:g,h:50});a.applyTooltip(m,
f.tooltip)};m.paneAutoSaveContentOnExit=function(){m.button.isVisible()&&m.button.callback()};n.domEditBox.addEventListener("keydown",function(a){13===a.keyCode?(a.stopPropagation(),a.preventDefault(),t.trigger()):16===a.keyCode?b.shiftDown=!0:9===a.keyCode&&(a.preventDefault(),b.tabDown=!0);if(b.tabDown){a=1;b.shiftDown&&(a=-1);var c=b.inputBoxes.length;b.inputIndex=(b.inputIndex+a+c)%c;b.inputBoxes[b.inputIndex].domElement.focus();b.inputBoxes[b.inputIndex].domElement.select();b.tabDown=!1}},!1);
n.domEditBox.addEventListener("keyup",function(a){13===a.keyCode&&(b.tabDown=!1);16===a.keyCode&&(b.shiftDown=!1)});var t=a.makeButtonAt(m,"",m.size.x+a.config.smallButtonWidth/2,56,a.config.smallButtonWidth,a.config.smallButtonHeight);a.setStandardButtonProperties(t,a.config.BUTTON_MOD);t.setCallback(function(){if(f.numberOnly){var b=Number(n.getTextValue());isNaN(b)&&(console.warn("Player tried to give a number only setting a value that is NaN. Defaulting to 0."),b=0);m.valuesRef.setting=b}else m.valuesRef.setting=
"time"===d?a.getTime(n.domEditBox,10):n.getTextValue();f.callback(f);t.setVisible(!1)});m.setValid=function(b){b||(m.tBox.setColor(a.config.badTextColor),n.domEditBox.style.color="dimgray",n.domEditBox.style.backgroundColor="darkgray")};icon=new c.ui.Sprite(t);icon.useImageRef(gfx.getImage("set_value_icon"));icon.setPos(t.size.x/2,t.size.y/2);t.setVisible(!1);a.applyTooltip(t,c.string.getString("STR_SET_VALUE_TOOLTIP"));m.button=t;return m};a.getTime=function(b,c){var e=b.value;c=c||0;e&&""!==e||
1<e.length&&(e=""+c);if(0<e.length)for(var d="1;2;3;4;5;6;7;8;9;0;:; ;".split(";"),k=0;k<e.length;k++){for(var h=!1,l=0;l<d.length;l++)e[k]===d[l]&&(h=!0,l=d.length);h||(e=e.replace(e[k],"0"))}e.includes(":")?(4<e.length?(e=e.replace(/:/g,""),e=e.slice(0,2)+":"+e.slice(2)):4===e.length?(e=e.replace(/:/g,""),e=e.slice(0,1)+":"+e.slice(1)):3===e.length?(e=e.replace(/:/g,""),e=":"+e):2===e.length&&(e=e.replace(/:/g,"")),b.value=e):1===e.length?b.value=e:2===e.length&&(e=":"+e,b.value=e);return a.timeValToSecond(e,
c)};a.timeValToSecond=function(a,c){c=c||0;if(a.includes(":")){var b=a.split(":");""===b[0]&&(b[0]=0);a=parseInt(b[0]);b=parseInt(b[1]?b[1]:0);a=60*a+b}else a=parseInt(a);isNaN(a)&&(a=c);a<c&&(a=c);return a};a.toTime=function(a){var b=Math.floor(a/60);a%=60;a=10>a?"0"+a:a;return 0===parseInt(b)?":"+a:b+":"+a};a.makeButtonAt=function(b,e,f,d,k,h,l){var g=a.config;k=k||g.buttonWidth;h=h||g.buttonHeight;var n=new c.ui.Button(c.ui.Button.bubbleType);n.setPos(f-k/2,d-h/2);n.setSize(k,h);n.setTextValue(e);
a.setFontProperties(n,g.buttonFont);a.setStandardButtonProperties(n,l);b.appendSubElement(n);return n};a.makeGameStatDisplayAt=function(b,e,f,d,k,h){b=new c.ui.Element(b);b.setBounds(f,d,k,h);e=a.makeStatText(b,e,0,0,b.size.x,b.size.y);b.label=e;e=a.makeStatText(b,"0",0,0,b.size.x,b.size.y);e.rightAlignText();b.statValue=e;return b};a.makeStatText=function(b,c,f,d,k,h,l){b=a.makeText(b,c,f,d,k,h,l);b.setFontSize(15);b.leftAlignText();return b};a.makeSparkCostText=function(b,c,f,d,k,h,l){b=a.makeText(b,
c,f,d,k,h,l);b.setFontSize(30);b.centerText();return b};a.makeStatBarDisplayAt=function(b,e,f,d,k,h){b=new c.ui.Element(b);b.setBounds(f,d,k,h);e=a.makeStatBarText(b,e,0,0,b.size.x,b.size.y);b.label=e;e=a.makeStatBarText(b,"0",0,0,b.size.x,b.size.y);e.rightAlignText();b.statValue=e;return b};a.makeStatBarText=function(b,c,f,d,k,h,l){b=a.makeText(b,c,f,d,k,h,l);b.setColor(a.config.logFont.color);b.setFontSize(a.config.logFont.size);b.leftAlignText();return b};a.setButtonNon=function(b){var c=a.config.BUTTON_PURPLE_NON;
b.setStandardImages(a.config.BUTTON_IMAGE,a.config.BUTTON_IMAGE_HIGHLIGHTED,a.config.BUTTON_IMAGE_HIGHLIGHTED,a.config.BUTTON_IMAGE_DISABLED);b.setTextColors(c.normal.textColor,c.highlighted.textColor,c.highlighted.textColor,c.disabled.textColor);b.clickSound=null;b.gradientLayer.gradColorSet=c;b.gradientLayer.updateGradients()};a.setStandardButtonProperties=function(b,e){e||(e=a.config.BUTTON_PURPLE);96>b.getHeight()?b.setStandardImages(a.config.BUTTON_SMALL_IMAGE,a.config.BUTTON_SMALL_IMAGE_HIGHLIGHTED,
a.config.BUTTON_SMALL_IMAGE_PRESSED,a.config.BUTTON_SMALL_IMAGE_DISABLED):b.setStandardImages(a.config.BUTTON_IMAGE,a.config.BUTTON_IMAGE_HIGHLIGHTED,a.config.BUTTON_IMAGE_PRESSED,a.config.BUTTON_IMAGE_DISABLED);b.setTextColors(e.normal.textColor,e.highlighted.textColor,e.pressed.textColor,e.disabled.textColor);var f=b.gradientLayer;f||(f=new c.ui.Element,b.gradientLayer=f,b.insertSubElement(f),f.updateGradients=function(a){a=a||c.graphics.getContext();var b=this.parent,e=this.gradColorSet;e=[{state:c.ui.Element.enabledFlag,
gradColors:e.normal.gradient},{state:c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag,gradColors:e.highlighted.gradient},{state:c.ui.Element.enabledFlag|c.ui.Element.pressedFlag|c.ui.Element.highlightedFlag,gradColors:e.pressed.gradient},{state:c.ui.Element.enabledFlag|c.ui.Element.pressedFlag,gradColors:e.pressed.gradient},{state:0,gradColors:e.disabled.gradient}];for(var f in e){var d=e[f],g=a.createLinearGradient(0,0,this.size.x,0);g.addColorStop(0,d.gradColors[0].toString());g.addColorStop(1,
d.gradColors[1].toString());d.gradStyle=g}b.setStatesByField(e,"gradStyle")},f.drawSelf=function(a){var b=this.parent;b.displayState&&(a.fillStyle=b.displayState.gradStyle,a.fillRect(0,0,this.size.x,this.size.y))});f.gradColorSet=e;b=b.getSize();e=a.config.GRADIENT_INSET;f.setPos(e,e);f.setSize(b.x-2*e,b.y-2*e);f.updateGradients()};a.makeSpriteButtonAt=function(b,e,f,d,k,h,l){l=a.config;k=k||l.buttonWidth;h=h||l.buttonHeight;var g=c.ui.makeBubbleButton(a.config.BUTTON_IMAGE,a.config.BUTTON_IMAGE_HIGHLIGHTED,
a.config.BUTTON_IMAGE_PRESSED,a.config.BUTTON_IMAGE_DISABLED);g.setPos(f-k/2,d-h/2);g.setSize(k,h);g.setTextValue(e);a.setFontProperties(g,l.buttonFont);b.appendSubElement(g);return g};a.makeSmallToggleButton=function(b,e,f,d,k,h){var g=a.config;d=d||g.smallToggleButtonWidth;k=k||g.smallToggleButtonHeight;g=new c.ui.Button(c.ui.Button.spriteType,"images/ui/mod_ui/timer/off_standard.png");g.setCallback(h);h=gfx.getImage("small_toggle_disabled");var m=gfx.getImage("small_toggle_normal"),n=gfx.getImage("small_toggle_high"),
t=gfx.getImage("small_toggle_on_normal"),p=gfx.getImage("small_toggle_on_high"),q=c.ui.Element;g.setStateImages([{state:q.enabledFlag,imageRef:m},{state:q.enabledFlag|q.highlightedFlag,imageRef:n},{state:q.enabledFlag|q.pressedFlag,imageRef:t},{state:q.enabledFlag|q.highlightedFlag|q.pressedFlag,imageRef:t},{state:q.enabledFlag|q.toggledFlag,imageRef:t},{state:q.enabledFlag|q.toggledFlag|q.highlightedFlag,imageRef:p},{state:q.enabledFlag|q.toggledFlag|q.pressedFlag,imageRef:m},{state:0,imageRef:h}]);
g.setPos(e-d/2,f-k/2);g.setSize(d,k);g.setToggles(!0);b.appendSubElement(g);return g};a.makeStateText=function(b,e){var f=a.config.stateFont;e=new c.ui.TextBox(e);e.setPos(32,b.size.y/2-f.size/2-3);e.setSize(b.getSize().w-64,f.size);e.setFont(f.font);e.setFontStyle(f.style);e.setFontSize(30);e.setColor(f.color);f.stroke&&e.setStroke(f.stroke.width,f.stroke.color,f.stroke.doCleanup);e.centerText();b.appendSubElement(e);return e};a.makeTitleBox=function(b,e){var f=a.config.titleFont;e=new c.ui.TextBox(e);
e.setPos(16,32);e.setSize(b.getSize().w-32,f.size);e.setFont(f.font);e.setFontStyle(f.style);e.setFontSize(f.size);e.setColor(f.color);f.stroke&&e.setStroke(f.stroke.width,f.stroke.color,f.stroke.doCleanup);e.centerText();b.appendSubElement(e);return e};a.makeHeading=function(b,e,f,d){var g=a.config;e=new c.ui.TextBox(e);e.setPos(f-150,d-20);e.setSize(300,40);e.setFont(g.headingFont.font);e.setFontStyle(g.headingFont.style);e.setFontSize(g.headingFont.size);e.setColor(g.headingFont.color);e.centerText();
b.appendSubElement(e);return e};a.makeLabel=function(b,c,f,d,k,h){return a.makeText(b,c,f,d,k,h,a.config.labelFont)};a.makeText=function(b,e,f,d,k,h,l){var g=a.config;l=l||g.mainFont;e=new c.ui.TextBox(e);k=k||300;h=h||g.mainFont.size;e.setPos(f||0,d||0);e.setSize(k,h);e.setFont(l.font);e.setFontStyle(l.style);e.setFontSize(l.size);e.setColor(l.color);l.stroke&&e.setStroke(l.stroke.width,l.stroke.color,l.stroke.doCleanup);b.appendSubElement(e);return e};a.makeActionLogTextAt=function(b,e,f,d){var g=
a.config.logFont;e=new c.ui.TextBox(e);e.setFont(g.font);e.setFontStyle(g.style);e.setFontSize(g.size);e.setColor(g.color);e.setSize(b.getSize().x-32,0);e.setPos(f,d);e.leftAlignText();e.setBaseline(c.ui.TextBox.baselineTop);e.setAutoWrap(!0,!0);e.enableDefaultSpecialFormatting();g.stroke&&e.setStroke(g.stroke.width,g.stroke.color,g.stroke.doCleanup);b.appendSubElement(e);return e};a.makeStandardPopupBackground=function(b){var e=new c.ui.Shape(b,"rect");e.setSize(b.getSize());e.setPos(0,0);e.setColor(a.config.popBackColor);
e.setStroke(5,a.config.popBorderColor);return e};a.makeStandardModPopupBackground=function(b){b=new c.ui.Element(b);b.fitToParentSize();b.setClipped(!0);var e=b.getSize(),f=new c.ui.Sprite(b),d=gfx.getImage("mod_background");f.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);f.useImageRef(d);f.fitToParentSize();var k=d.getSize();d=e.x/k.w;k=e.y/k.h;k>d&&(d=k);f.setScale(d,d);f=new c.ui.Shape(b,"rect");f.setSize(e.x-6,e.y-6);f.setPos(3,3);f.setColor(c.graphics.transparent);f.setStroke(5,a.config.modPopBorderColor);
return b};a.applyTooltip=function(b,e){var f=a.config;e=b.setTextToolTip(e);a.setFontProperties(e.textBox,f.tipFont);e.textBox.setAutoWrap(!0);b.sizeTextToolTip(f.tipFont.size);e.container.setColor(new c.graphics.Color(0,0,0,.9));e.container.setFrame(0);e.container.setStroke(4,"#202020");e.container.setShapeType("roundrect");e.container.setCornerRadius(5);b.positionToolTip("top",{x:0,y:-16})};a.setFontProperties=function(a,c){a.setFont(c.font);a.setFontStyle(c.style);a.setFontSize(c.size);c.color&&
a.setTextColors?a.setTextColors(c.color,c.colorHi,c.colorPressed):c.color&&a.setColor&&a.setColor(c.color)};a.makeTicketSprite=function(a,e,f){a=new c.ui.Sprite(a);a.setPos(e,f);a.setSize(smallTicketWidth,smallTicketHeight);a.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);a.setFlag(c.ui.Element.autoScaleAfterLoadFlag);a.autoCenter();a.setRotation(2);e=gfx.getImage("ticket");e.setCentered(!1,!1);a.useImageRef(e);return a};a.resizeHandler=function(){};a.makePopUpText=function(b,e,f,d,k,h){e=e||{x:0,
y:0};f=f||"";d=d||{x:300,y:40};k="undefined"!==typeof k?k:!0;h="undefined"!==typeof h?h:!0;var g=new c.ui.Element(b);g.setSize(d.x+32,d.y+32);g.setPos(e.x-g.size.x/2,e.y-g.size.y/2);var m=new c.ui.BubbleBox(g,"images/ui/bubble_box/bubble_background.png");m.setSize(g.size.x,g.size.y);m.setPos(0,0);m.setVisible(h);var n=a.makeTextBox(g,f);n.setSize(g.size.x-32,g.size.y-32);n.setPos(16,16);n.setFontSize(40);n.setAutoWrap(k);var t={x:g.getPos().x,y:g.getPos().y};g.getSize();g.getSize();b=n.getPos().x;
e=n.getPos().y;n.getSize();f=n.getSize().y;d=new c.ui.Animator(c.ui.Animator.scaler,n);d.setTimer(.25);d.setStartEndVectors({x:1,y:0},{x:1,y:1});d=new c.ui.Animator(c.ui.Animator.mover,n);d.setTimer(.25);d.setStartEndVectors({x:b,y:e+f/2},{x:b,y:e});d.setDoneCallback(function(){var a=new c.ui.Animator(c.ui.Animator.mover,g);a.setTimer(.75);a.setStartEndVectors(t,{x:t.x,y:t.y-0});a.setDoneCallback(function(){var a=new c.ui.Animator(c.ui.Animator.fader,g);a.setTimer(.25);a.setDoneCallback(function(){n=
m=g=null});a.setStartEnd(1,0)})})};a.ArrowTab=function(b){var e=b.size.x-1.5*a.config.BUBBLE_BOX_ART_MARGIN-a.config.ARROW_TAB_SIZE_X/2,f=b.size.y/2;this.image=new c.ui.Sprite(gfx.getImage("button_tab_down"));this.image.setSize(a.config.ARROW_TAB_SIZE_X,a.config.ARROW_TAB_SIZE_Y);this.image.setPos(e,f);b.appendSubElement(this.image);this.state="down";this.arrowUp=function(){this.image.useImageRef(gfx.getImage("button_tab_up"));this.state="up"};this.arrowDown=function(){this.image.useImageRef(gfx.getImage("button_tab_down"));
this.state="down"};this.updatePos=function(){e=b.size.x-a.config.ARROW_TAB_SIZE_X-a.config.BUBBLE_BOX_ART_MARGIN/2;f=b.size.y/2;this.image.setPos(e,f)}};a.ButtonIcon=function(a,e,f,d,k){f=void 0===f?5:f;null!=a&&null!=e&&(this.oldIcon=void 0===d?null:d,this.defaultPosition=f,this.defaultMargin=void 0===k?0:k,this.reposition=function(b,f,d){b=void 0===b?this.defaultPosition:b;f=void 0===f?null:f;d=void 0===d?this.defaultMargin:d;var g=f?f.size.x:a.size.x,k=f?f.size.y:a.size.y;f=g/2;var h=k/2;switch(b){case 1:f=
d;h=k-d;break;case 2:h=k-d;break;case 3:f=g-d;h=k-d;break;case 4:f=d;break;case 6:f=g-d;break;case 7:h=f=d;break;case 8:h=d;break;case 9:f=g-d,h=d}this.image.setFlag(c.ui.Element.autoScaleAfterLoadFlag);b=gfx.getImage(e);this.image.setSize(b.image.imageFrames[0].width,b.image.imageFrames[0].height);this.image.useImageRef(b);this.image.setPos(f,h)},this.image=new c.ui.Sprite,a.appendSubElement(this.image),this.reposition(f),this.hide=function(){this.image.setVisible(!1);null!=this.oldIcon&&this.oldIcon.setVisible(!0)},
this.show=function(){this.image.setVisible(!0);null!=this.oldIcon&&this.oldIcon.setVisible(!1)},this.hide())};a.iconTable={YES:{iconSmall:"icon_bet_yes",iconLarge:"offer_result_yes"},NO:{iconSmall:"icon_bet_no",iconLarge:"offer_result_no"},HOME:{iconSmall:"icon_bet_home",iconLarge:"offer_result_home"},RIVAL:{iconSmall:"icon_bet_rival",iconLarge:"offer_result_rival"},getIconSet:function(b){switch(!0===b.startsWith("STR_")?c.string.getString(b,"english").toLowerCase():b.toLowerCase()){case "yes":return a.iconTable.YES;
case "no":return a.iconTable.NO;case "home":return a.iconTable.HOME;case "rival":return a.iconTable.RIVAL;default:return null}}};a.pullDownColorStates=[{flags:c.ui.Element.enabledFlag,color:"#191030",textColor:"#BB9FB7",frameColor:"#000",frameWidth:0},{flags:c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag,color:"#ffffff",textColor:"#191030",frameColor:"#000",frameWidth:0},{flags:c.ui.Element.enabledFlag|c.ui.Element.pressedFlag,color:"#eaeaea",textColor:"#191030",frameColor:"#000",frameWidth:0},
{flags:c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag|c.ui.Element.pressedFlag,color:"#eaeaea",textColor:"#191030",frameColor:"#000",frameWidth:0}];a.pullDownColorStatesMod=[{flags:c.ui.Element.enabledFlag,color:"#0c1a07",textColor:"#ecedca",frameColor:"#000",frameWidth:0},{flags:c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag,color:"#eaeb87",textColor:"#0c1a07",frameColor:"#000",frameWidth:0},{flags:c.ui.Element.enabledFlag|c.ui.Element.pressedFlag,color:"#afb065",textColor:"#0c1a07",
frameColor:"#000",frameWidth:0},{flags:c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag|c.ui.Element.pressedFlag,color:"#afb065",textColor:"#0c1a07",frameColor:"#000",frameWidth:0}];a.shouldPreventButtonInput=function(){if(!0===app.isModAny()||(!0===app.isIntegratedMode()||"web"===app.platform)&&!1===document.hasFocus())return!0};window.ui=a});
rat.modules.add("js.ui.game_screen",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.app",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.ui.r_ui_fillbar","rat.ui.r_ui_bubblebox","rat.utils.r_string","js.ui.offer_holder","js.ui.offer_pane","js.ui.error_screen","js.ui.mod_menu","js.ui.help_screen","js.ui.settings_menu","js.ui.exit_screen","js.ui.edit_reason_screen","js.ui.leaderboard","js.ui.game_info_pane","js.ui.status_info_pane","js.ui.alert_info_pane","js.ui.stat_bar","js.ui.action_log",
"js.ui.value_selector","js.ui.drop_down","js.ui.avatar_icon","js.ui.player_action_menu","js.ui.autofeed_data_accuracy_display",{name:"js.ui.customizer",processBefore:!0}],function(c){var d={flags:["left","top"],ax:ui.config.HOLDER_X_SHIFT,ny:.58,tw:304,th:760},a={nx:(ui.config.pulldownButtonWidth/2+ui.config.smallButtonWidth-5)/app.config.IDEAL_W,ny:(d.ny*app.config.IDEAL_H-d.th/2-ui.config.smallButtonHeight/2+16)/app.config.IDEAL_H,tw:ui.config.pulldownButtonWidth,th:ui.config.smallButtonHeight},
b={nx:(app.config.IDEAL_W-ui.config.pulldownButtonWidth/2)/app.config.IDEAL_W,ny:2*ui.config.pulldownButtonHeight/app.config.IDEAL_H,tw:ui.config.pulldownButtonWidth,th:ui.config.pulldownButtonHeight,customizerGroup:"mod",applyRemotely:!0},e=2*ui.config.smallButtonWidth-8,f={nx:2*ui.config.GAME_INFO_PANE_H/app.config.IDEAL_W,ny:(d.ny*app.config.IDEAL_H+ui.config.GAME_INFO_PANE_W/4)/app.config.IDEAL_H,tw:ui.config.GAME_INFO_PANE_W/2,th:ui.config.GAME_INFO_PANE_H/2},g={nx:.5,ny:.5,tw:ui.config.GAME_INFO_PANE_W/
2,th:ui.config.GAME_INFO_PANE_H/2},k={nx:.5,ny:.5,tw:450,th:500},h={nx:.5,ny:(app.config.TOP_STRIP_H+96+ui.config.betButtonHeight/2)/app.config.IDEAL_H,tw:2*ui.config.betButtonWidth,th:ui.config.betButtonHeight+ui.config.buttonHeight,customizerGroup:"mod"},l={nx:.5,ny:.5,tw:2*ui.config.betButtonWidth,th:ui.config.smallModButtonHeight,customizerGroup:"mod"},m={nx:(app.config.IDEAL_W-ui.config.pulldownButtonWidth/2)/app.config.IDEAL_W,ny:(ui.config.betButtonHeight+ui.config.pulldownButtonHeight/2)/
app.config.IDEAL_H,tw:ui.config.pulldownButtonWidth,th:ui.config.pulldownButtonHeight},n={nx:(ui.config.actionButtonWidth/2+324)/app.config.IDEAL_W,ny:(app.config.TOP_STRIP_H+ui.config.smallButtonHeight+16)/app.config.IDEAL_H,tw:ui.config.actionButtonWidth,th:2*ui.config.actionButtonHeight,customizerGroup:"mod"},t={nx:.5,ny:(app.config.IDEAL_H-ui.config.GAME_STAT_PANE_H-8)/app.config.IDEAL_H,tw:ui.config.GAME_STAT_PANE_W,th:ui.config.GAME_STAT_PANE_H,customizerGroup:"mod"},p={nx:128/app.config.IDEAL_W,
ny:(app.config.IDEAL_H-128)/app.config.IDEAL_H,tw:256,th:256,customizerGroup:"mod",applyRemotely:!0},q={nx:.45,ny:.4,tw:600,th:200},v=app.types.Customizer.calculatePlace,r=function(){c.console.log("GameScreen create.");r.prototype.parentConstructor.call(this);this.warmUp=!0;this.queuedOfferPanes=[];var a=this;a.setPos(0,0);a.setSize(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);var e=app.types.Customizer;e.applyRemotely=!1;e.clearProxies();e.addProxy({name:c.string.getString("STR_ACTION_LOG_PANEL"),
bounds:m});e.addProxy({name:c.string.getString("STR_LEADERBOARD_TARGET_PANEL"),bounds:b});e.addProxy({name:c.string.getString("STR_ROUND_CONTROLS_PANEL"),bounds:n});e.addProxy({name:c.string.getString("STR_GIVE_CREDITS_EFFECT_PANEL"),bounds:p});e.addProxy({name:c.string.getString("STR_STAT_BAR_PANEL"),bounds:t});e.addProxy({name:c.string.getString("STR_GIVE_CREDITS_PANEL"),bounds:h});e.addProxy({name:c.string.getString("STR_UI_VISIBILITY_PANEL"),bounds:l});e.changeCallback=function(){a.repositionUI()};
this.customizer=e;a.rebuildUI(a);app.xboxMixerPreventExit();this.name="<GameScreen>"+this.id};c.utils.inheritClassFrom(r,c.ui.Screen);r.prototype.screenActivate=function(){};r.prototype.screenDeactivate=function(){};r.prototype.onWindowResize=function(){this.repositionUI();this.resizeBackground();this.actionLog&&this.actionLog.rebuildLogs()};r.prototype.resizeBackground=function(){var a=c.graphics.SCREEN_WIDTH,b=c.graphics.SCREEN_HEIGHT;this.backgroundBox&&this.backgroundBox.setSize(a,b);this.backgroundSprite&&
(this.backgroundSprite.setSize(a,b),this.backgroundSprite.setScale(a/1280*.999,b/720*.999))};r.prototype.makePlayerIcon=function(a,b){b=b||!1;var e=this,f=app.types.avatarIcon.make(a,"rgba(240, 240, 240, 0.8)");f.name="playerIcon";f.setSize(ui.config.playerIconSize,ui.config.playerIconSize);f.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);f.setFlag(c.ui.Element.autoScaleAfterLoadFlag);f.setPos((a.size.x-ui.config.playerIconSize)/2,0);if(b)return f;f.setTracksMouse(!0);f.setTargetable(!0);f.clickSound=
c.ui.Button.defaultClickSound;f.focusSound=c.ui.Button.defaultFocusSound;f.adjustBoundsForPointer=function(a,b){b=4.5*f.size.x;var c=1.2*f.size.y;a.x=(f.size.x-b)/2;a.y=(f.size.y-c)/2;a.w=b;a.h=c;return a};ui.applyTooltip(f,c.string.getString("STR_PLAYER_ACTIONS_TOOLTIP"));f.setCallback(function(){e.sparkSpendCallout.getImageRef().setAnimOneShot();app.settings.seenSparkButton||(app.settings.seenSparkButton=!0,app.writeSettings(),peSync.sendSettingsReport());peSync.hostHasStarted()?window.ui.PlayerActionMenu.open():
new ui.ConfirmPopup("Spark Buttons Not Available","We're waiting for the host to finish starting the client")});var d=f.drawSelf;f.drawSelf=function(a){d.call(this,a);f.isHighlighted()&&(a.lineWidth=3,a.strokeStyle="rgba(250, 250, 250, 0.9)",a.beginPath(),a.arc(f.size.x/2,f.size.x/2,43,0,2*Math.PI),a.stroke())};var g=f.handleImageFlags;f.handleImageFlags=function(a){g.call(this,a);f.setNeedsUpdate(!0)};b=ui.makeText(a,"",0,0,a.size.x/2,a.size.y/2);b.centerText();b.setVisible(!1);this.playerName=b;
a=new c.ui.Element(a);a.setBounds(f.size.x,0,512,f.size.y);a=new c.ui.Sprite(a);a.name="sparkSpendCallout";a.setSize(128,64);a.setFlag(c.ui.Element.autoScaleAfterLoadFlag);b=gfx.getImage("mixer_spark_spend_callout");a.useImageRef(b);a.setPos(72,f.size.y/2);this.sparkSpendCallout=a;app.isOwner()&&app.isIntegratedElectron()&&b.setAnimOneShot(!0);app.settings.seenSparkButton&&this.skipSparkSpendCallout();return f};r.prototype.makePlayerCredits=function(a){var b=new c.ui.Shape(a,c.ui.roundRectShape);
b.setBounds(-16,a.size.y-32,a.size.x- -32,32);b.setColor(new c.graphics.Color(0,0,0,.65));b.cornerRadius=ui.config.buttonCornerRadius;this.creditsBackground=b;var e=new c.ui.Element(a);e.setSize(20,20);var f=new c.ui.Sprite(e);f.setSize(40,40);f.setFlag(c.ui.Element.autoScaleAfterLoadFlag);f.useImageRef(gfx.getImage("ticket"));f.setPos(e.size.x/2,e.size.y/2);f.setScale(.5,.5);this.playerCreditsIcon=f;var d=ui.makeText(a,"00",0,b.getPosY()+1,a.size.x-8,b.size.y);d.setColor(ui.config.creditsColor);
d.centerText();this.lastManagedUpdateState=d.managedUpdateState=0;this.playerCredits=d;d.updateSelf=function(){var c=d.getPosX(),f=d.getPosY(),g=b.size.x-(4+e.size.x),k=d.getRawTextWidth();d.setSize(k>g?g:k,d.size.y);d.setPos((a.size.x-d.size.x)/2+e.size.x/2,f);e.setPos(c-e.size.x,f+d.size.y/2-e.size.y/2)}};r.prototype.makeLeaderboardButton=function(a){var b=a.size.x/2,e=a.size.y/2;this.leaderboardDropDown=new app.types.DropDown(a,c.string.getString("STR_LEADERBOARD_TITLE"),b,e,ui.config.pulldownButtonWidth,
ui.config.pulldownButtonHeight,!0);this.leaderboardDropDown.setTooltip(c.string.getString("STR_TOGGLE_LEADERBOARD_TOOLTIP"));this.leaderboardDropDown.showIcon();this.leaderboardDropDown.setCallback(peSync.sendSettingsReport);this.leaderboardDropDown.contentTray.setUseOffscreen(!0);this.leaderboard=new app.types.Leaderboard(this.leaderboardDropDown.contentTray);this.leaderboardButton=this.leaderboardDropDown.button;this.leaderboardDropDown.setOpenTarget(app.config.IDEAL_W-ui.config.pulldownButtonWidth,
0,1,1);this.leaderboardDropDown.setOpenTargetObject(this.leaderboardTargetPanel);this.leaderboardDropDown.closedSize={x:ui.config.smallButtonWidth,y:ui.config.smallButtonHeight};this.leaderboardDropDown.setThisMoves(!0);this.leaderboardDropDown.autoClose();this.leaderboardDummy.setPos(a.getPosX(),a.getPosY(),1,1);this.leaderboardDropDown.button.buttonIcon=new ui.ButtonIcon(this.leaderboardDropDown.button,"x_button",6);this.leaderboardDropDown.button.buttonIcon.reposition(6,{size:{x:ui.config.pulldownButtonWidth,
y:ui.config.pulldownButtonHeight}},16)};r.prototype.makeLeaderboardButtonDummy=function(b){var e=this,f=new c.ui.Shape(b,c.ui.roundRectShape);f.cornerRadius=ui.config.buttonCornerRadius;f.setColor(new c.graphics.Color(0,0,0,.2));u(f,a);setTimeout(function(){f.setSize(ui.config.smallButtonWidth-12,ui.config.smallButtonHeight-12);f.setPos(f.getPosX()+6,f.getPosY()+6);var a=new c.ui.Sprite(f);a.useImageRef(gfx.getImage("icon_leaderboard"));a.setPos((f.size.x-a.size.x)/2,(f.size.y-a.size.y)/2);a.setOpacity(.2)},
10);f.setCallback(function(){e.leaderboardButton.trigger()});ui.applyTooltip(f,c.string.getString("STR_TOGGLE_LEADERBOARD_TOOLTIP"));f.name="lbButtonDummy";this.leaderboardDummy=f};r.prototype.makeHelpButton=function(a){var b=this;if(!this.helpButton){var e=ui.makeButtonAt(a,"",ui.config.smallButtonWidth/2,a.size.y/2,ui.config.smallButtonWidth,ui.config.smallButtonHeight);a=new c.ui.Sprite(e);a.useImageRef(gfx.getImage("help_menu_icon"));a.setPos(e.size.x/2,e.size.y/2);e.setCallback(function(){b.readyScreen&&
!b.readyScreen.isDeactivated&&b.readyScreen.close();window.ui.HelpScreen.open()});if("mobile"!==app){var f=ui.config.SMALL_BUTTON_BOUNDS_SCALE;e.adjustBoundsForPointer=function(a,b){b=e.size.x*f;var c=e.size.y*f;a.x=(e.size.x-b)/2;a.y=(e.size.y-c)/2;a.w=b;a.h=c;return a}}ui.applyTooltip(e,c.string.getString("STR_HELP_TITLE"));this.helpButton=e}};r.prototype.makeSettingsButton=function(a){if(!this.settingsButton){a=ui.makeButtonAt(a,"",a.size.x-ui.config.smallButtonWidth/2,a.size.y/2,ui.config.smallButtonWidth,
ui.config.smallButtonHeight);var b=new c.ui.Sprite(a);b.useImageRef(gfx.getImage("settings_menu_icon"));b.setPos(a.size.x/2,a.size.y/2);a.setCallback(function(){app.isModAny()&&!peSync.hostHasStarted()?new ui.ConfirmPopup("Settings Not Available","We're waiting for the host to press a 'Start' button on the client"):window.ui.SettingsMenu.open()});app.isModAny()?(ui.setStandardButtonProperties(a,ui.config.BUTTON_MOD),b.useImageRef(gfx.getImage("settings_menu_icon_mod"))):ui.setStandardButtonProperties(a,
ui.config.BUTTON_PURPLE);ui.applyTooltip(a,c.string.getString("STR_SETTINGS_TITLE"));this.settingsButton=a}};r.prototype.makeActionLog=function(a){var b=a.size.x/2,e=a.size.y/2;this.actionLogDropDown=new app.types.DropDown(a,c.string.getString("STR_SETTINGS_ACTIONLOG"),b,e,ui.config.pulldownButtonWidth,ui.config.pulldownButtonHeight);this.actionLogButton=this.actionLogDropDown.button;app.isModAny()&&ui.setStandardButtonProperties(this.actionLogButton,ui.config.BUTTON_MOD);this.actionLog=new app.types.ActionLog(this.actionLogDropDown.contentTray,
this.actionLogButton,a)};r.prototype.makeRoundControlButton=function(a){var b=a.size.x/2,e=ui.config.actionButtonHeight/2;a=ui.makeButtonAt(a,c.string.getString("STR_END_ROUND"),b,e,ui.config.actionButtonWidth,ui.config.actionButtonHeight);ui.setStandardButtonProperties(a,ui.config.BUTTON_MOD);a.setCallback(function(){peSync.knownGlobalState.roundIsActive?peSync.sendMessageWithCode("round_end"):peSync.sendMessageWithCode("round_start")});b=ui.makeText(a,c.string.getString("STR_UNRESOLVED_OFFERS"),
0,a.size.y,a.size.x,30);b.centerText();b.setVisible(!1);a.inactiveReason=b;this.roundControlButton=a};r.prototype.makeValidateRoundWinnerButton=function(a){var b=ui.makeButtonAt(a,"Validate Winners",a.size.x/2,1.5*ui.config.actionButtonHeight,ui.config.actionButtonWidth,ui.config.actionButtonHeight);ui.setStandardButtonProperties(b,ui.config.BUTTON_MOD);b.setCallback(function(){b.setVisible(!1);var a=new ui.ConfirmPopup("Give Winners Channel Currency?","Selecting 'Yes' will give the winners a channel currency award.\n\nSelecting 'No' will continue the game without giving any award to the winners of this round",
function(){peSync.sendMessageWithCode("winner_awards_approved",{value:!0})},function(){peSync.sendMessageWithCode("winner_awards_approved",{value:!1})});a.setAllowClickAway(!1);a.setAllowBackClose(!1);a.setAllowClickBodyClose(!1)});b.setVisible(peSync.knownGlobalState.winnersNeedValidated);this.validateRoundWinnerButton=b};r.prototype.makeAutofeedAccuracyDisplay=function(a){a=new app.types.AutofeedDataAccuracyDisplay(this);a.name="autofeedAccuracy";this.autofeedDataAccuracyDisplay=a};r.prototype.makeLogo=
function(a){var b=new c.ui.Sprite(a);b.setSize(64,64);b.setFlag(c.ui.Element.autoScaleAfterLoadFlag);b.useImageRef(gfx.getImage("small_logo"));b.setPos((app.config.SIDE_W-b.size.x)/2,a.size.y-b.size.y-20);this.gameLogo=b};r.prototype.rebuildUI=function(a){this.removeAllSubElements();this.settingsButton=this.helpButton=null;var b=c.graphics.SCREEN_WIDTH,e=c.graphics.SCREEN_HEIGHT;if("mobile"!==app.platform)"xbox"===app.platform&&(this.useButtonIcons=!0),e=new c.ui.Element(this),e.setPos(0,0),e.setSize(b,
96),this.header=e;else{f=g;var d=new c.ui.Shape(a,c.ui.squareShape);d.setSize(b,e);d.setColor(ui.mobileBackdropColor);this.backgroundBox=d;d=new c.ui.Sprite(this);d.clearAfterLoadFlags();d.useImageRef(gfx.getImage("start_background"));d.setPos(0,0);d.setSize(b,e);this.backgroundSprite=d;this.resizeBackground();this.header=new c.ui.Element(this)}this.header.name="header";this.makeLogo(a);this.makeOptionsPanel(a);app.connected&&this.makeGameInfoPanel(a);app.isModAny()&&app.connected&&(this.makeStatBarPanel(a),
this.makeStatusInfoPanel(a));app.isModEdit()&&app.connected&&(this.makeRoundControlPanel(a),this.makeGiveCreditsPanel(a));app.isModConfig()&&app.connected&&(this.makeAlertInfoPanel(a),this.makeUIVisibilityPanel(a));this.makeCreditSourcePanel(a);this.makeActionLogPanel(a);this.makePlayerPanel(a);this.makeLeaderboardTargetPanel(a);this.makeLeaderboardPanel(a);this.makeResultsPanel(a);this.makeOfferHolder(a);this.makeWinPanel(a);this.sortLeaderboardAndOffers();this.makeAutofeedAccuracyDisplay();this.showIntroScreen();
this.offersOpen=!0;this.inputMap=new c.InputMap([],-1);this.inputMap.navigateSound="navigate";this.needsUIInputmapRebuild=!0};var u=function(a,b){if(a){var c=b.tw,e=b.th;b=v(b);a.setPos(b.x-c/2,b.y-e/2);a.setSize(c,e)}};r.prototype.makeOptionsPanel=function(a){a=new c.ui.Element(a);a.setSize(2*ui.config.smallButtonWidth-8,ui.config.smallButtonHeight);var b=app.config.TOP_STRIP_H;"mobile"===app.platform?a.setPos(2*ui.config.playerIconSize+8+e/2,6):a.setPos(4,b+77);this.makeHelpButton(a);this.makeSettingsButton(a);
a.setUseOffscreen(!0);a.name="optionsPanel";this.optionsPanel=a};r.prototype.makePlayerPanel=function(a){a=new c.ui.Element(a);a.setSize(ui.config.playerIconSize,ui.config.playerIconSize+48);"mobile"===app.platform?a.setPos(62-ui.config.playerIconSize/2,12):a.setPos(ui.config.smallButtonWidth-ui.config.playerIconSize/2,12);this.playerIcon=this.makePlayerIcon(a);this.makePlayerCredits(a);a.name="playerPanel";this.playerPanel=a};r.prototype.makeGameInfoPanel=function(a){a=new c.ui.Element(a);u(a,f);
"mobile"!=app.platform&&a.setRotation(-Math.PI/2);this.gameInfoPane=new app.types.GameInfoPane(a);a.name="gameInfoPanel";a.setUseOffscreen(!0);a.setNeedsUpdate(!1);this.gameInfoPanel=a};r.prototype.makeStatusInfoPanel=function(a){var b=this.settingsButton.getGlobalPos().x,c=this.settingsButton.getGlobalPos().y+ui.config.smallButtonHeight-8;a=new app.types.StatusInfoPane(a,b,c);a.name="statusInfoPane";this.statusInfoPane=a};r.prototype.makeAlertInfoPanel=function(a){var b=this.settingsButton.getGlobalPos().x+
ui.config.smallButtonWidth-8,c=this.settingsButton.getGlobalPos().y;a=new app.types.AlertInfoPane(a);a.setPos(b,c);a.name="alertInfoPane";this.alertInfoPane=a};r.prototype.makeGiveCreditsPanel=function(a){var b=this;a=new c.ui.Element(a);u(a,h);var e=new c.ui.Shape(a,c.ui.roundRectShape);e.fitToParentSize();e.setColor(new c.graphics.Color(10,25,45));e.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);e=ui.makeButtonAt(a,"Give Players "+peSync.creditName,ui.config.betButtonWidth/2,ui.config.betButtonHeight/
2,ui.config.betButtonWidth,ui.config.betButtonHeight,ui.config.BUTTON_MOD);e.text.setAutoWrap(!0);e.setCallback(function(){var a=b.giveCreditsAdjust.getAmount();peSync.sendMessageWithCode("give_players_credits",{credits:a,reason:b.reasonText.getTextValue()})});this.giveCreditsButton=e;e=new app.types.ValueSelector(a);e.setPos((ui.config.betButtonWidth+ui.config.betButtonWidth)/2,(e.size.y-ui.config.betButtonHeight)/2);this.giveCreditsAdjust=e;e=ui.makeButtonAt(a,"edit",ui.config.betButtonWidth/4,
a.size.y-ui.config.buttonHeight/2,ui.config.betButtonWidth/2,ui.config.buttonHeight,ui.config.BUTTON_MOD);e.setCallback(function(){window.ui.EditReason.open()});this.reasonEditButton=e;var f=new c.ui.Shape(a,c.ui.roundRectShape);f.setBounds(e.size.x,e.getPosY()+8,a.size.x-e.size.x-8,e.size.y-16);f.setColor(new c.graphics.Color(10,25,45));f.setOpacity(1);e=ui.makeText(f,"text",0,0,f.size.x,f.size.y);e.setColor(ui.config.creditsColor);e.setTextValue(app.settings.reasonText?app.settings.reasonText:"Bonus stars!");
e.centerText();e.setAutoWrap(!0);this.reasonText=e;this.giveCreditsPanel=a;this.giveCreditsPanel.setVisible(!1)};r.prototype.makeUIVisibilityPanel=function(a){a=new c.ui.Element(a);u(a,l);var b=new c.ui.Shape(a,c.ui.roundRectShape);b.fitToParentSize();b.setColor(ui.config.noColor);b.setOpacity(.9);b=ui.makeText(b,"text",10,10,b.size.x-20,b.size.y-20);b.setColor(ui.config.modTextColor);b.setTextValue(c.string.getString("STR_PARTICIPANT_UI_HIDDEN"));b.centerText();ui.applyTooltip(b,c.string.getString("STR_PARTICIPANT_UI_HIDDEN_TOOLTIP"));
this.uiVisibilityPanel=a;this.uiVisibilityPanel.setVisible(!1)};r.prototype.makeActionLogPanel=function(a){a=new c.ui.Element(a);u(a,m);this.makeActionLog(a);a.name="actionLogPanel";this.actionLogPanel=a;this.actionLogPanel.setVisible(!1)};r.prototype.makeLeaderboardPanel=function(a){this.makeLeaderboardButtonDummy(a);a=new c.ui.Element(a);a.setSize(ui.config.pulldownButtonWidth,ui.config.smallButtonHeight);var b=app.isModAny()?this.helpButton.getGlobalPos().x:this.settingsButton.getGlobalPos().x,
f=this.settingsButton.getGlobalPos().y;a.setPos(b,f+ui.config.smallButtonHeight-6);"mobile"===app.platform&&(a.setPos(2*ui.config.playerIconSize+8+e/2+2*ui.config.smallButtonWidth-16,6),this.leaderboardTargetPanel.getPosX()-a.getPosX()<ui.config.smallButtonWidth&&this.leaderboardTargetPanel.setPos(a.getPosX(),this.leaderboardTargetPanel.getPosY()));this.makeLeaderboardButton(a);a.name="leaderboardPanel";this.leaderboardPanel=a};r.prototype.makeLeaderboardTargetPanel=function(a){a=new c.ui.Element(a);
u(a,b);"mobile"===app.platform&&a.setPos(c.graphics.SCREEN_WIDTH-ui.config.pulldownButtonWidth,-(ui.config.smallButtonHeight/2)+(ui.config.pulldownButtonHeight/2+6));a.name="leaderboardTargetPanel";this.leaderboardTargetPanel=a};r.prototype.makeRoundControlPanel=function(a){a=new c.ui.Element(a);u(a,n);this.makeRoundControlButton(a);this.makeValidateRoundWinnerButton(a);a.setTracksMouse(!0);this.roundControlPanel=a;this.roundControlPanel.setVisible(!0)};r.prototype.makeStatBarPanel=function(a){a=
new c.ui.Element(a);u(a,t);this.statBar=new app.types.StatBar(a);this.statBarPanel=a;this.statBarPanel.setVisible(!1)};r.prototype.makeCreditSourcePanel=function(a){a=new c.ui.Element(a);u(a,p);if(app.isModConfig()){var b=new c.ui.Sprite(a);b.setSize(40,40);b.setFlag(c.ui.Element.autoScaleAfterLoadFlag);b.useImageRef(gfx.getImage("ticket"));b.setPos(a.size.x/2,a.size.y/2);b.setOpacity(.6);this.creditSourceIcon=b}this.creditSourcePanel=a;this.creditSourcePanel.name="creditSourcePanel";this.creditSourcePanel.setVisible(!1);
this.creditSourcePanel.setNeedsUpdate(!1)};r.prototype.animateSparkSpendCallout=function(){this.sparkSpendCallout&&(this.updateSparkSpendCalloutVisibility(),app.settings.seenSparkButton||this.sparkSpendCallout.getImageRef().restartAnim())};r.prototype.updateSparkSpendCalloutVisibility=function(){if(this.sparkSpendCallout)if(peSync.playerInfo.isAnonymous)this.sparkSpendCallout.setVisible(!1);else{var a=this.readyScreen?this.readyScreen.isDeactivated:!1;this.sparkSpendCallout.setVisible(app.settings.sparkBoardActive&&
a)}};r.prototype.skipSparkSpendCallout=function(){if(this.sparkSpendCallout){var a=this.sparkSpendCallout.getImageRef();a.setAnimOneShot(!0);a.setAnimFinished()}};r.prototype.showIntroScreen=function(){app.isIntegratedElectron()&&(app.settings.showIntro=!1,app.writeSettings());app.settings.showIntro?(this.readyScreen||(this.readyScreen=new app.types.ReadyScreen(this)),this.readyScreen&&this.readyScreen.isDeactivated&&c.screenManager.pushScreen(this.readyScreen),this.updateSparkSpendCalloutVisibility()):
this.animateSparkSpendCallout()};r.prototype.checkForWaitingScreen=function(){peSync.weHaveConnected()?this.waitingScreen&&(c.screenManager.removeScreen(this.waitingScreen),this.waitingScreen=null):(this.waitingScreen||(this.waitingScreen=new app.types.WaitingScreen(this)),this.waitingScreen&&this.waitingScreen.isDeactivated&&c.screenManager.pushScreen(this.waitingScreen))};r.prototype.makeOfferHolder=function(a){a=new app.types.OfferHolder(a);u(a,d);a.name="offerHolder";this.offerHolder=a};r.prototype.makeWinPanel=
function(a){var b=new c.ui.Element(a);u(b,q);this.winPanel=b;b.name="winPanel";a=b.getWidth();var e=new c.ui.Shape(b,"rect");e.setColor("#4C2E88");e.setSize(a,60);e.setPos(0,30);tbox=ui.makeText(e,"",20,-5,a-40,60);tbox.centerText();tbox.setFontSize(36);tbox.setColor("#FFFFFF");b.introText=tbox;e=new c.ui.Sprite(b);e.useImageRef(gfx.getImage("win_idle"));e.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);e.setFlag(c.ui.Element.autoScaleAfterLoadFlag);a/=2;e.setSize(600,180);e.setPos(a,300);e.autoCenter();
b.winnerBox=e;e=app.types.avatarIcon.make(b,"rgba(76, 46, 136, 0.8)",8);e.setSize(128,128);e.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);e.setFlag(c.ui.Element.autoScaleAfterLoadFlag);e.setPos((b.size.x-128)/2,120);e.autoCenter(!0,!0);b.avatarIcon=e;b.updateAvatarImage=function(a){a?(b.avatarIcon.setVisible(!0),b.avatarIcon.useImageRef(a),b.avatarIcon.killAllAnimators(),a=new c.ui.Animator(c.ui.Animator.scaler,b.avatarIcon),a.setTimer(.3),a.setStartEnd(.5,1)):b.avatarIcon.setVisible(!1)};e=new c.ui.Element(b);
e.setSize(600,180);e.setPos(a-300,210);b.nameSpace=e;e.setClipped(!0);b.makeNameBox=function(a){a=ui.makeText(b.nameSpace,a,40,40,520,80);a.centerText();a.setColor("#FFFFFF");a.setFontSize(70);return a};b.nameText=b.makeNameBox("[name]");b.setVisible(!1);b.setNeedsUpdate(!1)};r.prototype.sortLeaderboardAndOffers=function(){c.graphics.SCREEN_WIDTH>c.graphics.SCREEN_HEIGHT&&this.moveSubElementToFront(this.leaderboardPanel)};r.prototype.suppressAnimation=function(a){return"hidden"===app.visibility?(console.log("//"+
a+" : suppressed while hidden"),!0):peSync.isStartupSuppressed()?(console.log("//"+a+" : suppressed by startup window"),!0):!1};r.prototype.showWinners=function(a){function b(a){a.avatarImageRef=null;gfx.getUserAvatar(a.userID,function(b){a.avatarImageRef=b})}if(0>=a.winners.length)console.log("showWinners: no winners");else if(-1===peSync.knownPlayerState.rank&&!app.isModEdit())console.log("showWinners: no bet placed, so don't show");else if(!this.suppressAnimation("showWinners")){this.handlingWinner=
!0;for(var e=0;e<a.winners.length;e++)if(a.winners[e].name===peSync.playerInfo.username){var f=a.winners[e];a.winners.splice(e,1);a.winners.push(f);break}for(e=0;e<a.winners.length;e++)b(a.winners[e]);var d=this,g=this.winPanel;app.eventManager.queueDelay(.25);app.eventManager.queueEvent(function(){d.winPanel.winnerBox.setVisible(!1);d.winPanel.nameText.setVisible(!1);var a=c.string.getString("STR_WINNER_IS");d.winPanel.introText.setTextValue(a);d.winPanel.setVisible(!0);return 0});app.eventManager.queueEvent(function(){var a=
gfx.getImage("win_anim");a.setAnimDir(1);a.setFrame(0);a.setAnimOneShot();g.winnerBox.useImageRef(a);g.winnerBox.setVisible(!0);effects.doWinnerEffects(g.winnerBox.getGlobalPos().x+g.winnerBox.size.x/2,g.winnerBox.getGlobalPos().y+g.winnerBox.size.y/2);d.leaderboardDropDown.open();return a.getAnimLength()});app.eventManager.queueEvent(function(){var b=gfx.getImage("win_idle");b.setFrame(0);g.winnerBox.useImageRef(b);g.nameText.setTextValue(a.winners[0].name);g.nameText.setVisible(!0);g.updateAvatarImage(a.winners[0].avatarImageRef);
return 1.5});for(e=1;e<a.winners.length;e++)app.eventManager.queueEvent(function(b){var e=new c.ui.Animator(c.ui.Animator.mover,g.nameText);e.setTimer(.3);var f=g.nameText.getPos(),d={x:f.x-700,y:f.y};e.setStartEndVectors(f,d);e.setAutoRemoveTarget(!0);var k=g.makeNameBox(a.winners[b].name);e=new c.ui.Animator(c.ui.Animator.mover,k);e.setTimer(.3);e.setDelay(.1);d=k.getPos();f={x:d.x+700,y:d.y};e.setStartEndVectors(f,d);k.setPos(f);e.setDelayDoneCallback(function(){g.updateAvatarImage(a.winners[b].avatarImageRef)});
g.nameText=k;return 1},null,e);app.eventManager.queueDelay(2.5);app.eventManager.queueEvent(function(){g.nameText.setVisible(!1);var a=gfx.getImage("win_anim");a.setAnimEnd();a.setAnimDir(-1);g.winnerBox.useImageRef(a);g.avatarIcon.setVisible(!1);return a.getAnimLength()});app.eventManager.queueEvent(function(){d.hideWinners()})}};r.prototype.hideWinners=function(){this.handlingWinner=!1;this.winPanel.setVisible(!1)};r.prototype.makeResultsPanel=function(a){var b=app.types.OfferPane,e=ui.config.darkBoxColor;
a=new c.ui.Element(a);u(a,k);var f=b.offerPaneWidth+140,d=b.offerPaneHeight;a.setSize(f,d);var g=new c.ui.Shape(a,"rect");g.setSize(a.getSize());g.setPos(0,0);g.setColor(e);a.background=g;g=new c.ui.BubbleBox(g);var h=a.getHeight()+30,l=b.offerPaneWidth-24;g.setSize(180,h);g.setPos(l,-18);g.useImageRef(gfx.getImage("resolve_box"));a.hiBox=g;a.setWidth(f+200);a.setVisible(!1);b=b.offerPaneWidth;g=new c.ui.Sprite(a);g.useImageRef(gfx.getImage("offer_result_no"));g.sizeToImage();g.setPos(b+38,53);a.resolutionIcon=
g;g=b+10;h=ui.makeText(a,"[Resolving]",g,8,110,40,ui.config.resolvingInfoFont);h.setAlignment("center");a.introText=h;g=ui.makeText(a,"[correct]",g,8,110,40,ui.config.resolvingResultFont);g.setAlignment("center");a.resultsText=g;g=new c.ui.Sprite(a);g.useImageRef(gfx.getImage("bet_result_good"));g.sizeToImage();g.setPos(b+30,45);a.resultsIcon=g;b=new c.ui.Element(a);b.setPos(f,0);b.setSize(200,d);b.setBackground(e);a.whyPane=b;e=ui.makeText(b,"Here is some text explaining why, which may end up being long?",
10,0,180,d,ui.config.whyFont);e.setAutoWrap(!0);a.whyText=e;a.name="resultsPanel";a.setNeedsUpdate(!1);this.resultsPanel=a};r.prototype.queueOfferResolved=function(a,b,e,f,d,g){function k(){app.eventManager.queueEvent(function(){l.introText.setVisible(!1);l.resolutionIcon.setVisible(!1);if("refund"===f){var a=c.string.getString("STR_RESULT_REFUND");audio.playSound("bet_refund");var e="bet_result_refund";var d="#5A1010";var g=new c.ui.Animator(c.ui.Animator.fader,q.multiplierTab);g.setStartEnd(1,0);
g.setTimer(.25);g.setDoneCallback(function(){q.multiplierTab.setVisible(!1)})}else b.betString===f?(a=c.string.getString("STR_RESULT_CORRECT"),audio.playSound("bet_good"),e="bet_result_good",d="#2F4F07"):(a=c.string.getString("STR_RESULT_INCORRECT"),audio.playSound("bet_bad"),e="bet_result_bad",d="#441F49");l.resultsText.setVisible(!0);l.resultsText.setTextValue(a);l.resultsText.setColor(d);l.resultsIcon.setVisible(!0);l.resultsIcon.useImageRef(gfx.getImage(e));return 1})}g=void 0===g?1:g;if(a&&!this.suppressAnimation("offerResolved")){console.log("got resolution "+
f+" with why: "+d);var h=this,l=h.resultsPanel;a=c.utils.copyObject(a,!0);var m=app.types.OfferPane,q=this.offerHolder.makeSlotOffer(e);q.setResultsMode();e=q.getContainer().getPos();e=this.offerHolder.getGlobalPos(e);e.x=m.offerPaneWidth/2+m.resolveShiftX;var x={x:e.x-q.center.x,y:e.y-q.center.y};this.appendSubElement(q.getContainer());q.getContainer().setPos(e);this.queuedOfferPanes.push(q);a.offerPane=q;q.setOfferDetails(a,b,!1,!1);a.isLocked=!1;q.showPreResolving(!0);var y=b?b.credits*a.multiplier:
0;app.eventManager.queueDelay(0);app.eventManager.queueEvent(function(){l.setPos(x);l.setVisible(!0);l.resolutionIcon.setVisible(!1);l.resultsText.setVisible(!1);l.resultsIcon.setVisible(!1);l.introText.setVisible(!1);l.whyPane.setVisible(!1);q.showPreResolving(!1);return 0});"refund"!==f&&b&&app.eventManager.queueEvent(function(){l.introText.setVisible(!0);l.introText.setTextValue(c.string.getString("STR_RESOLVING"));audio.playSound("reveal_line");return 1});"refund"!==f&&app.eventManager.queueEvent(function(){l.introText.setVisible(!0);
l.introText.setTextValue(c.string.getString("STR_RESULT"));var a=ui.iconTable.getIconSet(f).iconLarge;l.resolutionIcon.useImageRef(gfx.getImage(a));l.resolutionIcon.setVisible(!0);audio.playSound("reveal_line");return 1});if(b){k();b.betString===f&&app.eventManager.queueEvent(function(){var a=q.multiplierText.getGlobalPos(),b=q.currencyText.getGlobalPos();b={x:b.x+q.currencyText.size.x/2,y:b.y+q.currencyText.size.y/2};var e=b.x-a.x;a=b.y-a.y;q.multiplierText.killAllAnimators();var f=new c.ui.Animator(c.ui.Animator.mover,
q.multiplierText);f.setDoneCallback(function(){q.currencyText.setTextValue(""+y);q.multiplierTab.setVisible(!1);q.multiplierText.setVisible(!1);effects.multiplierFlash(b.x,b.y);effects.multiplierSparks(b.x,b.y);audio.playSound("ticket_collect")});f.setStartEndVectors(q.multiplierText.getPos(),{x:e,y:a});f.setTimer(.3);audio.playSound("ticket_collect");e=new c.ui.Animator(c.ui.Animator.scaler,q.multiplierText);e.setInterpFilter(c.ui.Animator.filterEaseThereAndBack);e.setStartEnd(1,5);e.setTimer(.3);
return 1.2});var v=q.currencyIcon.getGlobalPos(20,15),n=game.hud.creditsBackground.getGlobalPos(game.hud.creditsBackground.size.x/2,game.hud.creditsBackground.size.y/2),p=game.hud.playerCredits,r=q.currencyText,w=q.currencyIcon;p.managedUpdateState++;app.eventManager.queueEvent(function(){if("refund"===f)return effects.refundMultiTicketEffect(v,n,p,b.credits*g,r,w);if(b.betString===f)return effects.earnMultiTicketEffect(v,n,p,y,r,w);q.currencyIcon.setVisible(!1);q.currencyText.setTextValue("");p.managedUpdateState--;
return effects.doTicketBurst(v,b.credits)+.5})}else"refund"===f&&k();d&&app.eventManager.queueEvent(function(){var a=!0===d.startsWith("STR_")?c.string.getString(d):d;l.whyPane.setVisible(!0);l.whyText.setTextValue(a);return 1});(d||b&&b.betString===f)&&app.eventManager.queueDelay(2);app.eventManager.queueEvent(function(){h.resultsPanel.setVisible(!1);q.slideOutTo("left",.2);return.2+.1});app.eventManager.queueEvent(function(){q.removeMe();h.resultsPanel.setVisible(!1);h.queuedOfferPanes.shift();
return 0})}};r.prototype.repositionUI=function(a){u(this.offerHolder,d);u(this.actionLogPanel,m);u(this.leaderboardTargetPanel,b);u(this.roundControlPanel,n);u(this.statBarPanel,t);u(this.gameInfoPanel,f);u(this.creditSourcePanel,p);u(this.giveCreditsPanel,h);u(this.uiVisibilityPanel,l);u(this.roundControlPanel,n);u(this.winPanel,q);"mobile"===app.platform&&(this.leaderboardPanel.setPos(2*ui.config.playerIconSize+8+e/2+2*ui.config.smallButtonWidth-16,6),this.leaderboardTargetPanel.setPos(c.graphics.SCREEN_WIDTH-
ui.config.pulldownButtonWidth,-(ui.config.smallButtonHeight/2)+ui.config.pulldownButtonHeight/2+6),this.leaderboardTargetPanel.getPosX()-this.leaderboardPanel.getPosX()<ui.config.smallButtonWidth&&this.leaderboardTargetPanel.setPos(this.leaderboardPanel.getPosX(),this.leaderboardTargetPanel.getPosY()),this.optionsPanel.setPos(2*ui.config.playerIconSize+8+e/2,6));this.leaderboardDropDown.reposition();this.autofeedDataAccuracyDisplay.reposition()};r.prototype.gotModStatusChange=function(){this.rebuildUI(this);
for(var a=c.screenManager.screenStack.length-1;0<=a;a--){var b=c.screenManager.screenStack[a];if("function"===typeof b.onRebuild)b.onRebuild()}this.gotUpdatedOffers(peSync.knownGlobalState,peSync.knownOffers);this.gotUpdatedGlobalState();0<peSync.knownStatsState.length&&this.gotUpdatedStatsState(peSync.knownStatsState);this.gotUpdatedPlayerData(peSync.knownGlobalState,peSync.knownPlayerState);this.actionLog&&this.actionLog.updateLogs(peSync.knownActionLogState);this.gotUpdatedPlayerName(peSync.playerInfo);
this.gotUpdatedPlayerAvatar(peSync.playerInfo);this.leaderboard.updateBoardState(peSync.knownBoardState,peSync.knownPlayerState,peSync.playerInfo)};r.prototype.gotUpdatedPlayerName=function(a){this.playerName.setTextValue(a.username);c.console.log("got updated player name",a);this.readyScreen&&this.readyScreen.gotUpdatedPlayerName(a.username)};r.prototype.gotUpdatedPlayerAvatar=function(a){this.playerIcon.useImageRef(a.avatarImageRef);this.readyScreen&&this.readyScreen.icon.useImageRef(a.avatarImageRef)};
r.prototype.gotUpdatedOffers=function(a,b){b&&(this.offerHolder.setOfferList(a,b),this.needsUIInputmapRebuild=!0)};r.prototype.gotUpdatedPlayerData=function(a,b){this.offerHolder.setPlayerBets(a,b.bets);this.needsUIInputmapRebuild=!0;void 0!==b.creditCount&&(this.playerCreditsActual=b.creditCount);this.updateCreditsDisplay()};r.prototype.updateCreditsDisplay=function(){this.playerCredits.managedUpdateState||(this.playerCredits.setTextValue("undefined"!==typeof this.playerCreditsActual?""+this.playerCreditsActual:
"loading"),this.playerCredits.updateSelf())};r.prototype.gotDisplayState=function(a){a="hide"===a?!1:!0;app.isModAny()?(this.errorPopup&&this.errorPopup.setVisible(a),this.uiVisibilityPanel&&this.uiVisibilityPanel.setVisible(!a)):this.setVisible(a)};r.prototype.gotUpdatedStatsState=function(a){a&&this.statBar&&this.statBar.updateStatsAnchorStats(a)};r.prototype.gotUpdatedGlobalState=function(a){a=a||peSync.knownGlobalState;var b=peSync.knownOffers,e=peSync.knownAutoFeedState;if(a){this.wasLastDataRequestGood=
null!==a.wasLastDataRequestGood?a.wasLastDataRequestGood:!1;var f=!1;b&&(game.hud.gotUpdatedOffers(a,b),f=peSync.haveOpenOffer(b));this.roundControlButton&&(a.roundIsActive?(this.roundControlButton.setTextValue(c.string.getString("STR_END_ROUND")),f?(this.roundControlButton.setEnabled(!1),this.roundControlButton.inactiveReason.setVisible(!0),ui.applyTooltip(this.roundControlPanel,c.string.getString("STR_END_ROUND_DISABLED_TOOLTIP"))):(this.roundControlButton.setEnabled(!0),this.roundControlButton.inactiveReason.setVisible(!1),
ui.applyTooltip(this.roundControlPanel,c.string.getString("STR_END_ROUND_TOOLTIP")))):(this.roundControlButton.setTextValue(c.string.getString("STR_BEGIN_ROUND")),this.roundControlButton.inactiveReason.setVisible(!1),a.winnersNeedValidated?this.roundControlButton.setEnabled(!1):(this.roundControlButton.setEnabled(!0),ui.applyTooltip(this.roundControlPanel,"Begin a new round"))));this.validateRoundWinnerButton&&(a.winnersNeedValidated?this.validateRoundWinnerButton.setVisible(!0):this.validateRoundWinnerButton.setVisible(!1));
b=app.types.StatBar.getAutoFeedDataFromState(e);app.settings.watchFor.enabled?(null===b?game.hud.gameInfoPane.showState("waitForW4"):void 0===b.haveData&&b.haveData?game.hud.gameInfoPane.showState("waitForW4"):b.active?a.roundIsActive?f?game.hud.gameInfoPane.showState("showInfo"):game.hud.gameInfoPane.showState("waitForAutoOffer"):this.wasLastDataRequestGood?game.hud.gameInfoPane.showState("badW4data"):game.hud.gameInfoPane.showState("waitForAutoRound"):game.hud.gameInfoPane.showState("waitForActive"),
null!==b&&b.isWarmingUp&&game.hud.gameInfoPane.showState("warmingUp"),void 0!==a.watchingStreamer&&(void 0===a.watchingStreamer.online||a.watchingStreamer.online||game.hud.gameInfoPane.showState("streamerOffline"))):a.roundIsActive?f?game.hud.gameInfoPane.showState("showInfo"):(game.hud.gameInfoPane.showState("waitForModOffer"),console.log("Waiting for a mod to create an offer")):(game.hud.gameInfoPane.showState("waitForModRound"),console.log("waiting for a mod to start the round"));f&&game.hud.gameInfoPane.showState("showInfo");
this.statusInfoPane&&this.statusInfoPane.updateDisplay(a,peSync.knownAutoFeedState);this.autofeedDataAccuracyDisplay&&this.autofeedDataAccuracyDisplay.updateDisplay(a,peSync.knownAutoFeedState);this.statBar&&this.statBar.updateAnchorStats(a,peSync.knownAutoFeedState)}};r.prototype.gotBetNotices=function(a){if(!this.suppressAnimation("betNotices")){for(var b=0;b<a.bets.length;b++)this.addOneBetNotice(a.bets[b]);a=$jscomp.makeIterator(Object.entries(a.betCounts));for(b=a.next();!b.done;b=a.next()){var c=
$jscomp.makeIterator(b.value);b=c.next().value;c=c.next().value;if(null==game||null==game.hud||null==game.hud.offerHolder||null==game.hud.offerHolder.offerList||null==game.hud.offerHolder.buttons)break;game.hud.offerHolder.offerList[b].betCounts=c;b=game.hud.offerHolder.buttons[b];null!=b&&null!=b.actionPanel&&!0===b.actionPanel.isVisible()&&b.showActions()}}};r.prototype.addOneBetNotice=function(a){var b=this;gfx.getUserAvatar(a.userID,function(b){a.avatarImageRef=b});setTimeout(function(){if(!b.suppressAnimation("addBetNotice")){var c=
b.offerHolder.slotFromOfferID(a.offerID);if(!(0>c)){c=b.offerHolder.getOfferPane(c).getGlobalPos(0,0);var e=app.types.OfferPane;effects.addBetNotice({x:c.x+e.offerPaneWidth+10,y:c.y+50,w:40,h:e.offerPaneHeight-100},a)}}},2E3*Math.random())};r.prototype.giveCreditsFromMod=function(a,b){if(!this.suppressAnimation("giveCredits")){var c=game.hud.creditSourcePanel.getGlobalPos(game.hud.creditSourcePanel.size.x/2,game.hud.creditSourcePanel.size.y/2),e=game.hud.creditsBackground.getGlobalPos(game.hud.creditsBackground.size.x/
2,game.hud.creditsBackground.size.y/2),f=game.hud.playerCredits;f.managedUpdateState++;effects.earnMultiTicketEffect(c,e,f,a);effects.textFlashup(c.x,c.y,"+ "+a);effects.reasonFlashup(c.x+10*b.length,c.y,""+b)}};r.prototype.updateSelf=function(a){a=this.useButtonIcons="controller"===c.input.lastUIInputType||"xbox"===app.platform||!0===this.gotButtonPress;var b=this.getCurrentTarget();a===this.prevUseButtonIcons&&b===this.prevTarget&&!0!==this.gotButtonPress||this.updateUIIcons();null!=b&&b!==this.prevTarget&&
(!0===b.isOfferPane||null!=this.prevTarget&&!0===this.prevTarget.isOfferPane)&&(this.needsUIInputmapRebuild=!0);!0===this.needsUIInputmapRebuild&&(this.rebuildInputMap(),this.needsUIInputmapRebuild=!1);this.prevUseButtonIcons=a;this.prevTarget=b;this.gotButtonPress=!1;this.updateCreditsDisplay()};r.prototype.updateUIIcons=function(){var a=this.getCurrentTarget();if(!0===this.useButtonIcons){this.leaderboardDropDown.button.buttonIcon.show();for(var b=0;b<game.hud.offerHolder.buttons.length;b++){var c=
game.hud.offerHolder.buttons[b];null!=c.buttonIcon&&c.buttonIcon.hide();null!=c.openIcon&&c.openIcon.hide()}null!=a&&(a=null!=a.isOfferPane?a:null!=a.parentOffer?a.parentOffer:null,null!=a&&null!=a.actionPanel&&(a.actionPanel.buttonIcon.show(),a.actionPanel.closeIcon.show(),b=a.actionPanel.yesButton,null!=b&&!0===b.isVisible()&&b.buttonIcon.show(),b=a.actionPanel.noButton,null!=b&&!0===b.isVisible()&&b.buttonIcon.show(),b=a.actionPanel.creditSelector,null!=b&&!0===b.isVisible()&&(b.upperButtonIcon.show(),
b.lowerButtonIcon.show())),null==a||null!=a.actionPanel&&!1!==a.actionPanel.isVisible()||!1!==game.hud.offersOpen||(a.buttonIcon.show(),a.openIcon.show()))}else{this.leaderboardDropDown.button.buttonIcon.hide();for(b=0;b<game.hud.offerHolder.buttons.length;b++)c=game.hud.offerHolder.buttons[b],null!=c.buttonIcon&&c.buttonIcon.hide(),null!=c.openIcon&&c.openIcon.hide();null!=a&&(a=null!=a.isOfferPane?a:null!=a.parentOffer?a.parentOffer:null,null!=a&&null!=a.actionPanel&&(a.actionPanel.buttonIcon.hide(),
a.actionPanel.closeIcon.hide(),b=a.actionPanel.yesButton,null!=b&&b.buttonIcon.hide(),b=a.actionPanel.noButton,null!=b&&b.buttonIcon.hide(),a=a.actionPanel.creditSelector,null!=a&&(a.upperButtonIcon.hide(),a.lowerButtonIcon.hide())))}"close"===this.leaderboardDropDown.state&&this.leaderboardDropDown.button.buttonIcon.hide()};r.prototype.drawSelf=function(a){};r.prototype.drawSelfPost=function(a,b){game.drawPost(b);app.drawVersion()};r.prototype.mouseDown=function(a,b){"xbox"!==app.platform&&game.hud.offerHolder.updateAllActions("mouseDown");
return!1};r.prototype.mouseUp=function(a,b){return!1};r.prototype.mouseMove=function(a,b){return!1};r.prototype.handleKeyDown=function(a){if("hide"===peSync.knownGlobalState.displayState&&!1===app.isModConfig())return!0;a.which===c.keys.f12&&parent.postMessage("toggle","*");return!1};r.prototype.handleKeyUp=function(a){return!1};r.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;c.input.lastUIInputType="controller";this.gotButtonPress=
!0;var b=this.getCurrentTarget();game.hud.targetButton=b;var e=null==b?null:!0===b.isOfferPane?b:null!=b.parentOffer?b.parentOffer:null;switch(a.which){case c.input.BUTTON_X:a=game.hud.leaderboardButton;if(null==a||!1===a.isEnabled()||!1===a.isVisible())return!0;a.trigger();game.hud.updateUIIcons();return!0;case c.input.BUTTON_A:if(null==b||null!=b.downArrow)return!0;if(null==b.offerDetails)break;game.hud.offersOpen=!game.hud.offersOpen;game.hud.offerHolder.updateAllActions();return!0;case c.input.BUTTON_Y:return!0;
case c.input.BUTTON_B:return"xbox"===app.platform&&window.ui.ExitScreen.open(),!0;case c.input.BUTTON_LT:if(null==e||!1===e.isOfferPane||null==e.actionPanel||!1===e.actionPanel.isVisible())return!0;a=e.actionPanel.creditSelector;if(null==a||null==a.downArrow||!1===a.isEnabled()||!1===a.isVisible())return!0;a.setDirectionUp(!1);a.resetAutoRepeat();a.startAutoRepeat();a.trigger();return!0;case c.input.BUTTON_RT:if(null==e||!1===e.isOfferPane||null==e.actionPanel||!1===e.actionPanel.isVisible())return!0;
a=e.actionPanel.creditSelector;if(null==a||null==a.upArrow||!1===a.isEnabled()||!1===a.isVisible())return!0;a.setDirectionUp(!0);a.resetAutoRepeat();a.startAutoRepeat();a.trigger();return!0;case c.input.BUTTON_LB:if(null==e||!1===e.isOfferPane||null==e.actionPanel||!1===e.actionPanel.isVisible())return!0;a=e.actionPanel.yesButton;if(null==a||!1===a.isEnabled()||!1===a.isVisible())return!0;a.trigger();b=a.flags;a.flags|=c.ui.Element.pressedFlag;a.checkFlagsChanged(b);return!0;case c.input.BUTTON_RB:if(null==
e||!1===e.isOfferPane||null==e.actionPanel||!1===e.actionPanel.isVisible())return!0;a=e.actionPanel.noButton;if(null==a||!1===a.isEnabled()||!1===a.isVisible())return!0;a.trigger();b=a.flags;a.flags|=c.ui.Element.pressedFlag;a.checkFlagsChanged(b);return!0;case c.input.BUTTON_START:a=game.hud.settingsButton;if(null==a||!1===a.isEnabled()||!1===a.isVisible())return!0;a.trigger();return!0;case c.input.BUTTON_SELECT:a=game.hud.helpButton;if(null==a||!1===a.isEnabled()||!1===a.isVisible())return!0;a.trigger();
return!0;case c.input.BUTTON_LEFT_STICK:case c.input.BUTTON_RIGHT_STICK:return!0;case c.input.BUTTON_UP:if(null==b)break;null!=b.parentOffer&&null!=b.upArrow&&!0===b.isEnabled()&&!0===b.isVisible()&&(b.setDirectionUp(!0),b.resetAutoRepeat(),b.startAutoRepeat(),b.trigger());break;case c.input.BUTTON_DOWN:if(null==b)break;null!=b.parentOffer&&null!=b.downArrow&&!0===b.isEnabled()&&!0===b.isVisible()&&(b.setDirectionUp(!1),b.resetAutoRepeat(),b.startAutoRepeat(),b.trigger());break;case c.input.BUTTON_LEFT:if(null==
b)break;if(!0===b.isOfferPane&&null!=b.actionPanel&&!0===b.actionPanel.isVisible())return game.hud.offersOpen=!1,game.hud.offerHolder.updateAllActions(),game.hud.updateUIIcons(),!0;break;case c.input.BUTTON_RIGHT:if(null==b)break;if(!0===b.isOfferPane&&(null==b.actionPanel||!1===b.actionPanel.isVisible()))return game.hud.offersOpen=!0,game.hud.offerHolder.updateAllActions(),game.hud.updateUIIcons(),game.hud.needsUIInputmapRebuild=!0;break;case c.input.BUTTON_DPAD_LEFT:case c.input.BUTTON_LSTICK_LEFT:case c.input.BUTTON_DPAD_RIGHT:case c.input.BUTTON_LSTICK_RIGHT:return!0;
case c.input.BUTTON_RSTICK_UP:case c.input.BUTTON_RSTICK_DOWN:case c.input.BUTTON_RSTICK_LEFT:case c.input.BUTTON_RSTICK_RIGHT:return!0}return!1};r.prototype.rebuildInputMap=function(){if(null!=game.hud&&null!=this.offerHolder&&c.screenManager.isTopScreen(this)){var a=game.hud.getCurrentTarget();!a||"controller"!==c.input.lastUIInputType&&"keyboard"!==c.input.lastUIInputType||(null!=a.parentOffer&&!1===a.isEnabled()&&game.hud.setCurrentTarget(a.parentOffer),game.hud.saveCurrentTarget(),game.hud.clearCurrentTarget());
this.inputMap.map=[];a=[];for(var b=0;b<this.offerHolder.offerList.length;b++){var e=this.offerHolder.offerList[b],f=this.offerHolder.buttons[b];null!=e&&null!=f&&(f.mapEntry=null,"open"===e.state&&a.push(f))}for(b=0;b<a.length;b++){e=a[b];f={currObj:e};f.up=0<b?a[b-1]:this.leaderboardButton;f.down=b<a.length-1?a[b+1]:this.playerIcon;f.right=null;if(null!=e.actionPanel&&null!=e.actionPanel.yesButton&&!0===e.actionPanel.yesButton.isVisible()&&null!=e.actionPanel.noButton&&!0===e.actionPanel.noButton.isVisible()){f.right=
e.actionPanel.creditSelector;var d={currObj:e.actionPanel.yesButton};d.up=f.up;d.down=f.down;d.right=e.actionPanel.noButton;d.left=e.actionPanel.creditSelector;this.inputMap.map.push(d);e.actionPanel.yesButton.mapEntry=d;d={currObj:e.actionPanel.noButton};d.up=f.up;d.down=f.down;d.left=e.actionPanel.yesButton;this.inputMap.map.push(d);e.actionPanel.noButton.mapEntry=d;var g={currObj:e.actionPanel.creditSelector,left:e};g.right=e.actionPanel.yesButton;this.inputMap.map.push(g);e.actionPanel.creditSelector.mapEntry=
d}this.inputMap.map.push(f);e.mapEntry=f}b={currObj:this.playerIcon};b.up=0<a.length?a[a.length-1]:this.leaderboardButton;b.down=this.settingsButton;this.inputMap.map.push(b);this.playerIcon.mapEntry=b;b={currObj:this.helpButton};b.right=b.left=this.settingsButton;b.up=this.playerIcon;b.down=0<a.length?a[0]:this.leaderboardButton;this.inputMap.map.push(b);this.helpButton.mapEntry=b;b={currObj:this.settingsButton};b.left=b.right=this.helpButton;b.up=this.playerIcon;b.down=this.leaderboardButton;this.inputMap.map.push(b);
this.settingsButton.mapEntry=b;b={currObj:this.leaderboardButton};b.left=b.right=this.helpButton;b.up=this.settingsButton;b.down=0<a.length?a[0]:this.playerIcon;this.inputMap.map.push(b);this.leaderboardButton.mapEntry=b;this.inputMap.validateMap();"controller"!==c.input.lastUIInputType&&"keyboard"!==c.input.lastUIInputType||game.hud.restoreSavedTarget();this.lastRebuildInputType=c.input.lastUIInputType}};r.prototype.handleButtonUp=function(a){if(a.which===c.input.BUTTON_LT||a.which===c.input.BUTTON_RT){if(!this.targetButton)return!0;
a=this.targetButton.actionPanel?this.targetButton.actionPanel.creditSelector:this.targetButton.parentOffer?this.targetButton.parentOffer.actionPanel.creditSelector:null;if(null==a)return;a.stopAutoRepeat()}return!1};r.prototype.showError=function(a){this.errorPopup||(this.errorPopup=new app.types.ErrorScreen,c.screenManager.pushScreen(this.errorPopup),this.isVisible()||this.errorPopup.setVisible(!1));this.errorPopup.setError(a)};r.prototype.clearError=function(){this.errorPopup&&c.screenManager.removeScreen(this.errorPopup)};
app.types.GameScreen=r});
rat.modules.add("js.ui.ready_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.game","js.ui.ui"],function(c){var d=function(a){this.mainScreenRef=a;d.prototype.parentConstructor.call(this);this.setSize(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);a=new c.ui.Sprite(this);a.useImageRef(gfx.getImage("start_background"));a.fitToParentSize();this.background=a;this.sizeBackground(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);this.makeHelpButton(this);
a=new c.ui.Element(this);a.setSize(760,480);a.setPos((this.size.x-a.size.x)/(this.size.y-a.size.y)/2);this.pane=a;var b=new c.ui.Shape(a,c.ui.roundRectShape);b.fitToParentSize();b.setColor(new c.graphics.Color(10,25,45,.65));b.cornerRadius=12;b=new c.ui.Sprite(a);b.useImageRef(gfx.getImage("start_logo"));b.setPos(256-b.size.x/2,-(b.size.y/2-80));b.setScale(.75,.75);this.logo=b;text=this.getMainTextString();b=this.logo.getPosY()+this.logo.size.y-(this.logo.size.y-.75*this.logo.size.y)+16;"mobile"===
app.platform&&(b=200);b=ui.makeText(a,text,64,b,632,800);b.enableDefaultSpecialFormatting();b.setFontSize(ui.config.mainFont.size);b.setLineHeight(1.2*b.fontLineHeight);b.setColor("#D0D0D0");b.setBaseline("top");b.setAutoWrap(!0);this.textBox=b;this.makeClosePrompt(a);this.makeButtons(a);this.makeArrow(this);this.autoBuildInputMap();"xbox"===app.platform&&this.setCurrentTarget(this.startButton);this.setModal(!0);app.xboxMixerPreventExit()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.sizeBackground=
function(a,b){this.background.fitToParentSize();this.background.setScale(c.graphics.SCREEN_WIDTH/1280*.999,c.graphics.SCREEN_HEIGHT/720*.999)};d.prototype.screenActivate=function(){game.hud&&game.hud.updateSparkSpendCalloutVisibility()};d.prototype.screenDeactivate=function(){game.hud&&game.hud.updateSparkSpendCalloutVisibility()};d.prototype.onWindowResize=function(){var a=c.graphics.SCREEN_WIDTH,b=c.graphics.SCREEN_HEIGHT;this.setSize(a,b);this.sizeBackground(a,b);this.updateUIPos()};d.prototype.makeClosePrompt=
function(a){var b=c.string.getString("STR_HELP_CLOSE");a=ui.makeText(a,b,16,a.size.y-ui.config.buttonHeight,a.size.x-32,ui.config.buttonHeight);a.setAlignment("right");a.enableDefaultSpecialFormatting();a.setVisible(!1);this.closePrompt=a;"xbox"===app.platform&&a.setVisible(!0)};d.prototype.makeButtons=function(a){var b=this,e=a.size.x/2,f=a.size.y-ui.config.buttonHeight+30;"mobile"!==app.platform&&(f-=30);a=ui.makeButtonAt(a,c.string.getString("STR_MENU_EXIT"),e,f);a.setCallback(function(){b.close()});
this.startButton=a;"xbox"===app.platform&&(a.setVisible(!1),a.setEnabled(!1))};d.prototype.getMainTextString=function(){var a=c.string.getString("STR_WELCOME_PC");"xbox"===app.platform?a=c.string.getString("STR_WELCOME_XBOX"):"mobile"===app.platform&&(a=c.string.getString("STR_WELCOME_MOBILE"));return ui.formatText(a)};d.prototype.gotUpdatedPlayerName=function(a){this.textBox.setTextValue(this.getMainTextString())};d.prototype.makeArrow=function(a){a=new c.ui.Sprite(a);a.useImageRef(gfx.getImageCopy("help_arrow"));
this.arrow=a;this.updateUIPos();this.icon=this.mainScreenRef.makePlayerIcon(this,!0);a=this.mainScreenRef.playerIcon.getGlobalPos();this.icon.setPos(a.x,a.y)};d.prototype.makeHelpButton=function(a){var b=this,e=this.mainScreenRef.helpButton.getGlobalPos();a=ui.makeButtonAt(a,"",e.x+ui.config.smallButtonWidth/2,e.y+ui.config.smallButtonHeight/2,ui.config.smallButtonWidth,ui.config.smallButtonHeight);e=new c.ui.Sprite(a);e.useImageRef(gfx.getImage("help_menu_icon"));e.setPos(a.size.x/2,a.size.y/2);
a.setCallback(function(){b.close();window.ui.HelpScreen.open()});this.helpButton=a};d.prototype.updateUIPos=function(){this.pane.setPos((this.size.x-this.pane.size.x)/2,(this.size.y-this.pane.size.y)/2);if(this.arrow){var a=this.mainScreenRef.helpButton.getGlobalPos();this.arrow.setPos(a.x+ui.config.smallButtonWidth/2+ui.config.smallButtonMargin+128,a.y+ui.config.smallButtonWidth/2)}this.HelpButton&&this.helpButton.setPos(helpButtonPos.x+ui.config.smallButtonWidth/2,helpButtonPos.y+ui.config.smallButtonHeight/
2);this.icon&&(a=this.mainScreenRef.playerIcon.getGlobalPos(),this.icon.setPos(a.x,a.y))};d.prototype.close=function(){c.screenManager.removeScreen(this);app.settings.showIntro=!1;app.writeSettings();peSync.sendSettingsReport(null,"mixguess-ready-anchor");game.hud.animateSparkSpendCallout()};d.prototype.updateSelf=function(a){a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=function(){!0===game.hud.useButtonIcons?"web"===
app.platform&&(this.closePrompt.setVisible(!0),this.startButton.setVisible(!1),this.startButton.setEnabled(!1)):"web"===app.platform&&(this.closePrompt.setVisible(!1),this.startButton.setVisible(!0),this.startButton.setEnabled(!0))};d.prototype.drawSelfPost=function(a,b){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:return this.startButton.trigger(),
!0;case c.input.BUTTON_SELECT:return this.helpButton.trigger(),!0}return!1};app.types.ReadyScreen=d});
rat.modules.add("js.ui.waiting_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.game","js.ui.ui"],function(c){var d=function(a){d.prototype.parentConstructor.call(this);this.setSize(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);a=this.makeBackground(new c.graphics.Color(0,0,0,.3));a.setSize(760,60);a.centerInParent();a.setPosY(0);this.background=a;var b=new c.ui.Sprite(this);b.useImageRef(gfx.getImage("start_logo"));b.setPos(0,0);b.setScale(.3,
.3);a=ui.makeText(a,"Waiting for MixPlay...",0,0,760,60);a.setAlignment("center");a.setFontSize(45);a.setColor("#D0D0D0");a.setAutoWrap(!1);a=this.makeBackground(new c.graphics.Color(0,0,0,.3));a.setSize(760,240);a.centerInParent();a.setPosY(200);this.extraInfo=a;a=ui.makeText(a,"We're having trouble connecting.  Try turning MixPlay off and back on...",20,20,720,240);a.setAlignment("center");a.setFontSize(45);a.setColor("#D0D0D0");a.setAutoWrap(!0);this.extraInfo.setVisible(!1);this.setModal(!0);
this.setAllowClickAway(!1);this.setAllowClickBodyClose(!1);this.setAllowBackClose(!1);this.setOverlay(!1);this.startTime=Date.now()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.sizeBackground=function(a,b){this.background.centerInParent()};d.prototype.myScreenActivate=function(){};d.prototype.myScreenDeactivate=function(){};d.prototype.onWindowResize=function(){var a=c.graphics.SCREEN_WIDTH,b=c.graphics.SCREEN_HEIGHT;this.setSize(a,b);this.sizeBackground(a,b)};d.prototype.close=function(){c.screenManager.removeScreen(this)};
d.prototype.updateSelf=function(a){7E3<c.system.dateNow-this.startTime&&this.extraInfo.setVisible(!0)};app.types.WaitingScreen=d});
rat.modules.add("js.ui.mod_permission_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string","rat.ui.r_ui_listbox","rat.ui.r_ui_edittext","rat.ui.r_ui_domedittext","js.ui.one_string_screen",{name:"js.ui.ui",processBefore:!0}],function(c){var d=[{label:"edit\nsettings",labelX:700*.55|0,labelAlign:"right",toggleX:525,fieldName:"canConfig"},{label:"run\ngame",labelX:595,labelAlign:"left",toggleX:630,fieldName:"canEdit"}],a=function(){a.prototype.parentConstructor.call(this);this.setSize(800,
950);this.centerHighInDisplay();var b=this.getPos();this.setPos(b.x+32,b.y+32);ui.makeStandardModPopupBackground(this);this.contentBox=new c.ui.Element(this);this.contentBox.fitToParentSize();this.setModal(!0);this.knownModPerms=c.utils.copyObject(peSync.knownConfigState.mods);this.userList=[];peSync.knownGlobalState.hostInfo&&this.addOneUserEntry({userID:peSync.knownGlobalState.hostInfo.userID,username:peSync.knownGlobalState.hostInfo.hostname+" (owner)",priority:1});this.addOneUserEntry({userID:"mixguessdevs",
username:"MixGuess Devs",priority:2});for(var e in this.knownModPerms)(b=this.knownModPerms[e])&&b.username&&this.addOneUserEntry({userID:b.userID,username:b.username,priority:100});this.getModList();this.makeInfoText();this.makeButtons()};c.utils.inheritClassFrom(a,c.ui.Screen);a.prototype.destroy=function(){};a.prototype.getModList=function(){var a=this;this.showQueryingMods();var e=0;peSync.knownGlobalState.hostInfo&&(e=peSync.knownGlobalState.hostInfo.channelID);window.mixer||e||(e=25818883);
var f="https://mixer.com/api/v1/channels/"+e+"/users/mod";c.utils.restGetJSONAsync(f,function(b,c,e){a.shouldShowNoMods=!1;if(b&&c)if(c.length)for(b=0;b<c.length;b++)a.addOneUserEntry(c[b]);else a.shouldShowNoMods=!0;else console.error("Error querying "+f),a.shouldShowNoMods=!0,console.log(c);a.makeModListUI()})};a.prototype.addOneName=function(a){var b=this;c.utils.restGetJSONAsync("https://mixer.com/api/v1/channels/"+a,function(a,c,e){a&&c&&c.user&&(console.log("> username "+c.user.username),console.log("> id "+
c.user.id),b.addOneUserEntry({username:c.user.username,userID:c.user.id}),b.makeModListUI())})};a.prototype.showNoMods=function(){ui.makeLabel(this.contentBox,"There are no channel mods for this channel.\n\nAdd some on mixer and try again.",100,237.5,600,300).setAutoWrap(!0)};a.prototype.showQueryingMods=function(){var a=this.contentBox;a.removeAllSubElements();ui.makeLabel(a,"querying list of mods...",100,380,400,36)};a.prototype.makeModListUI=function(){var a=this.contentBox;a.removeAllSubElements();
this.shouldShowNoMods&&this.showNoMods();var e=ui.makeLabel(a,"moderators",50,59,200,36);e.setColor(ui.config.modPopBorderColor);for(var f=0;f<d.length;f++){var g=d[f];e=ui.makeLabel(a,g.label,50+g.labelX,29,170,36);e.setColor(ui.config.modPopBorderColor);e.setAlignment(g.labelAlign)}a=this.modBox=new c.ui.ScrollView(a);a.setBounds(50,95,700,520);a.setFrame(5,ui.config.modPopBorderColor);a.wheelSensitivity=50;this.curYPos=10;for(f=0;f<this.userList.length;f++)this.addOneUIRow(this.userList[f])};a.prototype.addOneUserEntry=
function(a){a.id&&!a.userID&&(a.userID=a.id);if(a.userID&&a.username){a.priority||(a.priority=100);for(var b=0;b<this.userList.length;b++)if(this.userList[b].userID===a.userID)return;a.perms=this.knownModPerms[a.userID];this.userList.push(a);this.userList.sort(function(a,b){return a.priority!==b.priority?a.priority-b.priority:a.username.toLowerCase()<b.username.toLowerCase()?-1:1})}};a.prototype.addOneUIRow=function(a){var b=this,c=this.curYPos;ui.makeLabel(this.modBox,a.username,10,c+5,500,36).setAlignment("left");
for(var g=a.perms,k=0;k<d.length;k++){var h=d[k],l=g&&g[h.fieldName],m=ui.makeSmallToggleButton(this.modBox,h.toggleX,c+20,0,0,function(c,e){e=c.propInfo;a.perms||(a.perms={});a.perms[e.fieldName]=c.isToggled();b.saveValues();return!0});m.propInfo=h;l&&m.setToggled();a.but=m}this.curYPos+=50;this.modBox.setContentSize(this.modBox.getWidth(),this.curYPos)};a.prototype.makeInfoText=function(a){a=ui.makeLabel(this,"Note : Mod controls are not available on Mobile or Xbox.",50,627,700,80);a.setColor("#A0A0A0");
a.setAutoWrap(!0)};a.prototype.makeButtons=function(a){a=this;var b=this.getSize(),c=b.x/2;b=b.y-90;var d=ui.makeButtonAt(a,"Close",c,b);d.setCallback(function(b,c){a.saveValues();a.close();return!0});ui.setStandardButtonProperties(d,ui.config.BUTTON_MOD);b-=ui.config.buttonHeight+ui.config.buttonGap;d=ui.makeButtonAt(a,"Add By Name",c,b);d.setCallback(function(b,c){window.ui.OneStringScreen.make("Add user by name","",function(b){console.log("got name "+b);a.addOneName(b)},function(){})});ui.setStandardButtonProperties(d,
ui.config.BUTTON_MOD);ui.applyTooltip(d,"Add a user to this list by specifying their Mixer username")};a.prototype.saveValues=function(){for(var a=this.userList,c={},f=0;f<a.length;f++){var g=a[f],k=g.userID,h={userID:k,username:g.username},l=!1;if(g.perms)for(var m=0;m<d.length;m++){var n=!!g.perms[d[m].fieldName];(h[d[m].fieldName]=n)&&(l=!0)}c[k]=l?h:null}peSync.sendMessageWithCode("set_mods",{mods:c})};a.prototype.close=function(){c.screenManager.popScreen(self)};a.prototype.myScreenActivate=
function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"ModPermissionScreen activated.")};a.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"ModPermissionScreen deactivated.")};a.prototype.onWindowResize=function(){this.centerInDisplay()};a.prototype.updateSelf=function(a){};a.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.saveValues(),this.close(),!0):!1};a.make=function(){var b=new a;c.screenManager.pushScreen(b)};window.ui.ModPermissionScreen=
a});
rat.modules.add("js.ui.ui_audio",[{name:"js.ui.ui",processBefore:!0}],function(c){ui.musicButton=null;ui.soundButton=null;ui.makeOneAudioButton=function(d,a,b,e,f){var g=new c.ui.makeSpriteButton(a+"_on.png");g.toggles=!0;g.setPos(b,e);g.setSize(64,64);g.setCallback(f);b=c.ui.Element;g.setStateImages([{state:b.enabledFlag,resource:a+"_on.png"},{state:b.enabledFlag|b.highlightedFlag,resource:a+"_hi.png"},{state:b.enabledFlag|b.pressedFlag,resource:a+"_press.png"},{state:b.enabledFlag|b.toggledFlag,resource:a+
"_off.png"},{state:b.enabledFlag|b.toggledFlag|b.highlightedFlag,resource:a+"_off_hi.png"},{state:b.enabledFlag|b.toggledFlag|b.pressedFlag,resource:a+"_off_press.png"}]);d.appendSubElement(g);return g};ui.makeAudioButtons=function(d){ui.soundButton=ui.makeOneAudioButton(d,"images/ui/audio_buttons/sound_but",c.graphics.SCREEN_WIDTH-80,20,ui.handleSoundButton);ui.musicButton=ui.makeOneAudioButton(d,"images/ui/audio_buttons/music_but",c.graphics.SCREEN_WIDTH-154,20,ui.handleMusicButton);ui.updateAudioButtons()};
ui.removeAudioButtons=function(c){ui.soundButton&&c.removeSubElement(ui.soundButton);ui.musicButton&&c.removeSubElement(ui.musicButton);ui.soundButton=null;ui.musicButton=null};ui.repositionAudioButtons=function(c){ui.removeAudioButtons(c);ui.makeAudioButtons(c)};ui.handleOneToggle=function(){app.writeSettings();audio.updateFromSettings();ui.updateAudioButtons()};ui.handleSoundButton=function(c,a){app.settings.soundOn=!app.settings.soundOn;ui.handleOneToggle()};ui.handleMusicButton=function(c,a){app.settings.musicOn=
!app.settings.musicOn;ui.handleOneToggle()};ui.updateAudioButtons=function(){var c=ui.soundButton;c&&(app.settings.soundOn?c.setToggled(!1):c.setToggled(!0));(c=ui.musicButton)&&(app.settings.musicOn?c.setToggled(!1):c.setToggled(!0))}});rat.modules.add("js.data.config",[],function(c){window.config={AMMO_SLOTS:5}});
rat.modules.add("js.pe_sync",["js.message_track","js.utils.utils"],function(c){var d=[{fieldName:"canEdit"},{fieldName:"canConfig"},{fieldName:"isOwner"}],a={playerInfo:{sessionID:"12345",userID:1,username:"Hoppity Jones",channelGroups:["Mod","Owner"]},permissions:{isOwner:!1,canEdit:!1,canConfig:!1},state:"init",gotParticipantJoin:!1,time:0,serverTimestampEstimated:0,serverTimestampLastKnown:0,localServerTimeDelta:0,lastSparkTime:0,creditIconReplaced:!1,creditSoundReplaced:!1,creditName:"Stars",
debugLog:[],messageLog:[],init:function(){this.knownPlayerState={};this.knownGlobalState={keywords:{}};this.knownActionLogState={};this.knownBoardState={};this.knownStatsState={};this.knownOffers=[];for(var b=0;b<app.config.MAX_OFFER_SLOTS;b++)this.knownOffers[b]={state:"empty"};this.knownConfigState={offerOptions:[],mods:{},playerActionButtons:[]};this.lastPing=null;b=Date.now();a.initTimestamp=b;c.console.log("peSync init @"+b)},startSync:function(){this.state="play";app.isIntegratedMode()?this.connectToIntegrated():
c.console.log("peSync: standalone PE")},weHaveConnected:function(){return a.gotParticipantJoin},connectToIntegrated:function(){var b=app.getIntegratedSync();if(b){var e=function(){var b=a.playerInfo;a.integratedSync.participantJoinIntegrated({sessionID:b.sessionID,userID:b.userID,username:b.username,pic:"whatever",channelGroups:["Mod"]},{peSync:a});window.setTimeout(function(){var b=a.playerInfo;a.onParticipantJoin({sessionID:b.sessionID,userID:b.userID,username:b.username,pic:"whatever",channelGroups:["Mod"]})},
200)};this.integratedSync=b;console.log("peSync: PE with integrated sync");b=a.playerInfo;b.userID=app.settings.debug.fakeMixerUserID;0==b.userID&&(b.username="Anon"+(1E3+8E3*Math.random()|0));window.setTimeout(function(){e()},100)}else c.console.log("PE: missing integrated connection points.  Will try again..."),setTimeout(function(){a.connectToIntegrated()},500)},sendMessage:function(b,e){c.console.log("sending '"+b.code+"' to GC"+(e?" on "+e:""));if(this.integratedSync){var f=c.utils.copyObject(b,
!0);setTimeout(function(){a.integratedSync.receiveMessage(f,{sessionID:a.playerInfo.sessionID,userID:a.playerInfo.userID,channelGroups:["Owner","Mod"],isIntegrated:!0})},150)}else app.mixer.sendMessage("game_message",b,e);"ping"===b.code&&(this.lastPing={id:b.id,timestamp:Date.now()})},sendUXMessage:function(a){this.sendMessage(a,"mixguess-experience-anchor")},sendSettingsMessage:function(a,c){this.sendMessage(a,void 0===c?"mixguess-settings-anchor":c)},sendMessageWithCode:function(a,c,f){c=c||{};
c.code=a;this.sendMessage(c,void 0===f?"mixguess-anchor":f)},sendCreatingOffer:function(b){b.sessionID=a.playerInfo.sessionID;this.sendMessageWithCode("creating_offer",b)},sendCancelCreatingOffer:function(a){this.sendMessageWithCode("cancel_creating_offer",a)},sendEditingOffer:function(b){b.sessionID=a.playerInfo.sessionID;this.sendMessageWithCode("editing_existing_offer",b)},sendCancelEditingOffer:function(a){this.sendMessageWithCode("cancel_editing_existing_offer",a)},sendNewOffer:function(a){this.sendMessageWithCode("new_offer",
a)},sendModifyOffer:function(a){this.sendMessageWithCode("modify_offer",a)},freeOfferSlot:function(a){this.sendMessageWithCode("free_slot",a)},sendEditingExistingOffer:function(b){b.sessionID=a.playerInfo.sessionID;this.sendMessageWithCode("editing_existing_offer",b)},sendCancelEditingExistingOffer:function(b){b.sessionID=a.playerInfo.sessionID;this.sendMessageWithCode("cancel_editing_existing_offer",b)},sendResolvingOffer:function(b){b.sessionID=a.playerInfo.sessionID;this.sendMessageWithCode("resolving_offer",
b)},sendCancelResolvingOffer:function(a){this.sendMessageWithCode("cancel_resolving_offer",a)},sendResolveOffer:function(a){this.sendMessageWithCode("resolve_offer",a)},sendPlaceBet:function(a){this.sendMessageWithCode("place_bet",a,"mixguess-guess-anchor");app.playerActionInfo.acceptedOfferCount++},sendAutoFeedOptions:function(a,c){c.feedName=a;this.sendMessageWithCode("set_autofeed",c)},sendAutoFeedToggle:function(a){this.sendMessageWithCode("toggle_autofeed",a)},sendCheckChannel:function(){this.sendMessageWithCode("check_channel")},
sendSettingsReport:function(b,e){b=void 0===b?null:b;e=void 0===e?"mixguess-settings-anchor":e;var f={code:"settings_report",platform:app.platform,language:c.string.currentLanguage,browser:app.browser,os:app.os,leaderboardOpen:"open"===game.hud.leaderboardDropDown.state,soundOn:app.settings.soundOn,showIntro:app.settings.showIntro,seenSparkButton:app.settings.seenSparkButton,adjustedBetValues:app.settings.adjustedBetValues,modView:app.settings.modView};if(null!=b){for(var d={},k=0;k<b.length;k++){var h=
b[k];d[h]=f[h]}d.code="settings_report";a.sendSettingsMessage(d,e)}else a.sendSettingsMessage(f,e)},sendCommandMessage:function(a){this.sendMessageWithCode("command",a)},sendCustomMessage:function(a){this.sendMessageWithCode("send_custom_message",{message:a})},sendGetSupportedGamesList:function(){this.sendMessageWithCode("query_supported_games")},sendActivateChatBot:function(a){this.sendMessageWithCode("activate_chat_bot",{enable:a})},sendChatBotSetting:function(a){this.sendMessageWithCode("set_chat_bot_setting",
a)},sendSparkButtonSetting:function(a){this.sendMessageWithCode("set_spark_button_setting",a)},sendActivateSparkBoard:function(a){this.sendMessageWithCode("activate_spark_board",{active:a})},giveControlInput:function(b,e,f,d){d=void 0===d?!1:d;var g=Date.now();g<a.lastSparkTime+100?c.console.log("hit cooldown on spark spend! "+g):(a.lastSparkTime=g,mixer&&!d?(c.console.log("sending spark giveinput "+b),mixer.socket.call("giveInput",{controlID:b,event:"mousedown",button:0,chatMessage:e,index:f}).then(function(a){}).catch(function(a){console.error(a)})):
a.sendMessageWithCode("fake_spark_dump",{controlID:b,chatMessage:e,index:f}))},hitSignInButton:function(){this.sendMessage({code:"signin"},"sparkaction")},downloadFile:function(a,c){var b=document.createElement("a");b.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(c));b.setAttribute("download",a);document.createEvent?(a=document.createEvent("MouseEvents"),a.initEvent("click",!0,!0),b.dispatchEvent(a)):b.click()},receiveMessage:function(b){var e=Date.now();c.console.log("> PE received: "+
b.code+" @"+e);if("round_started"===b.code)game.hud.autofeedDataAccuracyDisplay&&game.hud.autofeedDataAccuracyDisplay.roundStatusChanged(),a.sendSettingsReport();else if("round_ended"===b.code)game.hud.autofeedDataAccuracyDisplay&&game.hud.autofeedDataAccuracyDisplay.roundStatusChanged(),game.hud.showWinners(b),a.sendSettingsReport();else if("edited_by_player"===b.code)if(e=a.slotIndexFromOfferID(b.offerID),0>e)console.error("got edited-by for an offer not in our list! "+b.offerID);else{var f=a.knownOffers[e];
if(f){var d=a.knownPlayerState.bets[b.offerID];d?(game.hud.queueOfferResolved(f,d,e,b.resolution,b.why),d.handled=!0):console.error("got edited-by for message for an offer that we did not bet on! "+b.offerID)}else console.error("got edited-by for an offer that we don't know exists! "+b.offerID)}else if("bet_too_recent"===b.code)e=a.slotIndexFromOfferID(b.offerID),0>e?console.error("got too-recent for an offer not in our list! "+b.offerID):(f=a.knownOffers[e])?(d=a.knownPlayerState.bets[b.offerID])?
(game.hud.queueOfferResolved(f,d,e,b.resolution,b.why),d.handled=!0):console.error("got too-recent message for an offer that we did not bet on! "+b.offerID):console.error("got too-recent for an offer that we don't know exists! "+b.offerID);else if("offer_resolved"===b.code)e=a.slotIndexFromOfferID(b.offerID),0>e?console.warn("got resolution for an offer not in our list: "+b.offerID):(f=a.knownOffers[e])?(d=a.knownPlayerState.bets[b.offerID],d&&d.handled||(game.hud.queueOfferResolved(f,d,e,b.resolution,
b.why,b.additionalMultiplier),game.hud.offerHolder.resolveOfferScreen&&game.hud.offerHolder.resolveOfferScreen.slotIndex==e&&game.hud.offerHolder.resolveOfferScreen.doCancel(!0))):console.warn("got resolution for an offer that we don't know exists! "+b.offerID);else if("bet_notices"===b.code)game.hud.gotBetNotices(b);else if("debug_command"===b.code)this.handleDebugCommand(b.cmd);else if("pong"===b.code)this.lastPing&&b.id===this.lastPing.id&&(this.knownLatency=(Date.now()-this.lastPing.timestamp)/
1E3);else if("credits_given"===b.code)game.hud.giveCreditsFromMod(b.credits,b.reason);else if("playerQueryResults"===b.code)e=b.playerObject.username,window.playerObjects=window.playerObjects||{},window.playerObjects[e]=b.playerObject,c.console.log(""+e+"'s current state has been saved to playerObjects."+e);else if("query_value_results"===b.code)app.queryResult=b.value,c.console.log("query result has been saved to app.queryResult."),null!==app.queryResult&&void 0!==app.queryResult&&"number"!==typeof app.queryResult&&
"string"!==typeof app.queryResult&&"boolean"!==typeof app.queryResult||c.console.log("  > simple result : "+app.queryResult);else if("export_stats_results"===b.code)"web"===app.platform&&!0===a.waitingForStats&&null!=b.stats&&(window.savedStats=b.stats,c.console.log("Current stats have been saved to savedStats."),a.downloadFile("mixguess_stats_"+c.system.dateNow+".json",JSON.stringify(b.stats,null,"\t")),a.waitingForStats=!1);else if("export_log_results"===b.code)"web"===app.platform&&!0===a.waitingForLog&&
null!=b.log&&null!=b.linesFound&&null!=b.totalLogLines&&null!=b.startingLine&&(a.downloadFile("mixguess_log_"+c.system.dateNow+".json",JSON.stringify(b.log,null,"\t")),e=""+b.linesFound+" lines of current log file (total "+b.totalLogLines+" lines) downloaded starting from ",e+=0>b.startingLine?"the end":"line "+b.startingLine,c.console.log(e),a.waitingForLog=!1);else if("export_rat_log_results"===b.code)"web"===app.platform&&!0===a.waitingForRatLog&&null!=b.log&&null!=b.linesFound&&null!=b.totalLogLines&&
null!=b.startingLine&&(a.downloadFile("mixguess_rat_log_"+c.system.dateNow+".json",JSON.stringify(b.log,null,"\t")),e=""+b.linesFound+" lines of current log file (total "+b.totalLogLines+" lines) downloaded starting from ",e+=0>b.startingLine?"the end":"line "+b.startingLine,c.console.log(e),a.waitingForRatLog=!1);else if("export_error_log_results"===b.code)"web"===app.platform&&!0===a.waitingForLog&&null!=b.log&&null!=b.linesFound&&null!=b.totalLogLines&&null!=b.startingLine&&(a.downloadFile("mixguess_error_log_"+
c.system.dateNow+".json",JSON.stringify(b.log,null,"\t")),e=""+b.linesFound+" lines of current log file (total "+b.totalLogLines+" lines) downloaded starting from ",e+=0>b.startingLine?"the end":"line "+b.startingLine,c.console.log(e),a.waitingForLog=!1);else if("slot_freed"===b.code)game.hud.offerHolder.editOfferScreen&&b.slotIndex===game.hud.offerHolder.editOfferScreen.slotIndex&&game.hud.offerHolder.editOfferScreen.doCancel(!0);else if("close_resolution_ui"===b.code)game.hud.offerHolder.resolveOfferScreen&&
b.slotIndex===game.hud.offerHolder.resolveOfferScreen.slotIndex&&game.hud.offerHolder.resolveOfferScreen.doCancel(!0);else if("custom_status_message"===b.code)game.hud.gameInfoPane&&game.hud.gameInfoPane.showState(game.hud.gameInfoPane.state,b.message);else if("supportedGamesQueryResults"===b.code)app.updateSupportedGamesList(b.supportedGamesObject);else if("autofeedSettingFromClient"==b.code)app.settings.watchFor.enabled=b.enabled||!1,app.writeSettings();else if("open_feedback"==b.code)app.openFeedback();
else if("connection_status"===b.code)game.hud&&(app.connected=b.value,game.hud.gotModStatusChange());else if(b.code.startsWith("GZ_")&&b.code.endsWith("_REPLY"))switch(e=b.code.substring(3,b.code.length-6),e){case "STATS":c.console.log(e+" Reply:");b.message=b.message||[];for(e=0;e<b.message.length;++e)c.console.log(b.message[e]);break;default:c.console.log(e+" Reply:"+b.message||"")}},applySettings:function(a){function b(b){return null!==a[b]&&void 0!==a[b]}function c(c){b(c)&&(app.settings[c]=a[c])}
c("showIntro");c("seenSparkButton");c("soundOn");c("modView");c("adjustedBetValues");b("showIntro")&&game.hud.readyScreen&&!1===a.showIntro&&game.hud.readyScreen.close();b("seenSparkButton")&&game.hud.skipSparkSpendCallout();b("soundOn")&&audio.updateFromSettings();b("modView")&&app.settings.modView!==a.modView&&(app.settings.modView=a.modView,game.hud.gotModStatusChange());b("adjustedBetValues")&&0===app.playerActionInfo.adjustedValues&&(app.playerActionInfo.adjustedValues=1)},onParticipantJoin:function(b){var e=
Date.now();c.console.log("> PE sync got onParticipantJoin "+b.username+" "+b.userID+" @"+e);a.gotParticipantJoin=!0;b.sessionID&&(a.playerInfo.sessionID=b.sessionID);"undefined"!==typeof b.userID&&(a.playerInfo.userID=b.userID);b.username&&(a.playerInfo.username=b.username,c.string.setAutoTokenReplacement("{USERNAME}",b.username));b.groupID&&(a.playerInfo.groupID=b.groupID);e={canEdit:!1,canConfig:!1,isOwner:!1};var f=a.knownConfigState.mods[b.userID];f&&(f.canEdit&&(e.canEdit=!0),f.canConfig&&(e.canConfig=
!0));e=this.checkPermissionOverrides(e);f=this.permissions.canEdit!==e.canEdit||this.permissions.canConfig!==e.canConfig||this.permissions.isOwner!==e.isOwner;c.console.log("  ModE "+e.canEdit+",  ModC "+e.canConfig+",  Owner "+e.isOwner);this.permissions=e;f&&game.hud.gotModStatusChange();0==b.userID?(this.playerInfo.isAnonymous=!0,game.hud.gotUpdatedPlayerData({},this.knownPlayerState)):this.playerInfo.isAnonymous=!1;a.queryUserDetails();game.hud.gotUpdatedPlayerName(this.playerInfo);if(e.isOwner||
this.integratedSync){for(var d in app.settings.autoFeeds)b=app.settings.autoFeeds[d],b.enabled&&a.sendAutoFeedOptions(d,b);app.settings.watchFor&&app.settings.watchFor.enabled&&a.sendAutoFeedToggle(app.settings.watchFor)}game.hud.checkForWaitingScreen();app.browser=app.isIntegratedMode()?"chrome":app.browser;a.sendSettingsReport(["platform","language","browser","os"])},checkPermissionOverrides:function(a){for(var b=0;b<d.length;b++){var c=d[b].fieldName;app.isIntegratedElectron()&&(a[c]=!0);void 0!==
app.settings.debug[c]&&(a[c]=app.settings.debug[c]);if("mobile"===app.platform||"xbox"===app.platform)a[c]=!1}return a},queryUserDetails:function(){var b=a.playerInfo.userID;b!==app.settings.debug.fakeMixerUserID||app.settings.debug.fakeMixerUserIDSet||app.userInfoManager.overrideUserInfo(b,{username:a.playerInfo.username,id:a.playerInfo.userID,avatarUrl:null});c.console.log("PE Requesting user details for "+b);app.userInfoManager.getUserInfo(b,function(b,c){b=b&&c&&c.avatarImageRef?c.avatarImageRef:
gfx.getImageCopy("default_avatar");a.playerInfo.avatarImageRef=b;game.hud.gotUpdatedPlayerAvatar(a.playerInfo)})},isStartupSuppressed:function(){return 3E3>Date.now()-a.initTimestamp?!0:!1},externalSetPlayerInfo:function(b,c){console.log("** external set player info : "+c);this.playerInfo.username=b;this.playerInfo.userID=c;a.queryUserDetails();game.hud.gotUpdatedPlayerName(this.playerInfo)},participantStateChange:function(b){messageTrack.trackMessage("pUpdate","participantUpdate",b);var e=Date.now();
c.console.log("> PE got participant state change @"+e);null!=b.timestamp&&this.setServerTimestamp(b.timestamp);!b.settings||null!=a.knownPlayerState&&null!=a.knownPlayerState.settings||a.applySettings(b.settings);game.hud.gotUpdatedPlayerData(this.knownGlobalState,b);game.hud.leaderboard.updateBoardState(this.knownBoardState,b,this.playerInfo);a.knownPlayerState=b;game.hud.offerHolder.updateAllActions("knownPlayerStateUpdate");game.hud.checkForWaitingScreen()},getPlayerState:function(){return a.knownPlayerState},
setServerTimestamp:function(a){null==a||a<=this.serverTimestampLastKnown||(this.serverTimestampEstimated=this.serverTimestampLastKnown=a,this.localServerTimeDelta=Date.now()-a)},controlStateChange:function(b,c){c=utils.deepObjectToArrayChecked(c);messageTrack.trackMessage("update",b,c);null!=c.timestamp&&this.setServerTimestamp(c.timestamp);"mixguess-anchor"===b?this.globalStateChange(c):"mixguess-config-anchor"===b?a.configStateChange(c):"mixguess-log-anchor"===b?a.logStateChange(c):"mixguess-board-anchor"===
b?a.boardStateChange(c):"mixguess-autofeed-anchor"===b?a.autoFeedStateChange(c):"mixguess-stats-anchor"===b?a.statsStateChange(c):"mixguess-experience-anchor"===b?a.uxStateChange(c):"mixguess-offer-"===b.substring(0,15)&&(b=b.substring(15),b=parseInt(b),this.offerStateChange(c,b))},globalStateChange:function(b){Date.now();b.keywords&&(this.knownGlobalState.keywords=b.keywords,game.hud.offerHolder.updateAllText());game.hud.gotUpdatedGlobalState(b);a.displayStateChange(b.displayState);b.displayState!==
this.knownGlobalState.displayState&&(c.console.log("> vis change "+b.displayState),app.updateMixerVideoPosition(b.displayState));this.knownGlobalState=b},offerStateChange:function(b,e){c.console.log("> PE got offer state change.");a.knownOffers[e]=b;game.hud.gotUpdatedOffers(a.knownGlobalState,a.knownOffers);game.hud.gotUpdatedGlobalState()},displayStateChange:function(a){for(var b="hide"===a?!1:!0,f=0;f<c.screenManager.screenStack.length;f++){var d=c.screenManager.screenStack[f];null!=d.gotDisplayState?
d.gotDisplayState(a):app.isModAny()||d.setVisible(b)}},hostHasStarted:function(){return a.knownGlobalState&&a.knownGlobalState.state&&"init"!==a.knownGlobalState.state?!0:!1},haveOpenOffer:function(a){for(var b=0;b<a.length;b++)if("open"==a[b].state)return!0;return!1},slotIndexFromOfferID:function(a){if(!this.knownOffers)return-1;for(var b=0;b<this.knownOffers.length;b++){var c=this.knownOffers[b];if(c&&c.offerID===a)return b}return-1},offerFromID:function(a){a=this.slotIndexFromOfferID(a);return 0>
a?null:this.knownOffers[a]},logStateChange:function(a){delete a.timestamp;c.console.log("> PE got action-log state change");game.hud.actionLog.updateLogs(a);this.knownActionLogState=a},configStateChange:function(b){c.console.log("> PE got config state change");this.knownConfigState=b;b.mods||(this.knownConfigState.mods={});null!=b.creditIcon&&!1===this.creditIconReplaced&&(this.replaceCreditIcon(b.creditIcon),this.creditIconReplaced=!0);null!=b.creditSound&&!1===this.creditSoundReplaced&&(this.replaceCreditSound(b.creditSound),
this.creditSoundReplaced=!0);null!=b.creditName&&(this.creditName=b.creditName,c.string.setAutoTokenReplacement("{CREDITS}",a.creditName),game.hud&&game.hud.giveCreditsButton&&game.hud.giveCreditsButton.setTextValue("Give Players "+a.creditName));null!=b.defaultColors&&this.replaceColors(b.defaultColors);null!=b.strings&&(c.string.setStrings(b.strings),game.hud&&game.hud.offerHolder&&game.hud.offerHolder.updateAllText());app.types.EditOfferScreen.curScreen&&app.types.EditOfferScreen.curScreen.configStateChange();
if(b.mods){var e=b.mods[this.playerInfo.userID];e=e?c.utils.copyObject(e,!0):{isOwner:!1,canEdit:!1,canConfig:!1};e=this.checkPermissionOverrides(e);this.setAndShowPermissions(e)}void 0!==b.autoFeedEnabled&&(app.settings.watchFor.enabled=b.autoFeedEnabled);void 0!==b.chatBotEnabled&&(app.settings.chatBot.active=b.chatBotEnabled);b.chatBotSettings&&(app.settings.chatBot.settings=b.chatBotSettings);void 0!==b.sparkBoardActive&&(app.settings.sparkBoardActive=b.sparkBoardActive,game.hud&&game.hud.updateSparkSpendCalloutVisibility());
void 0!==b.playerActionButtons&&(app.settings.playerActionButtons=b.playerActionButtons,app.settings.rebuildSparkBoard=!0,app.settings.rebuildCustomizeSparkBoard=!0,window.ui.PlayerActionMenu.buildSparkIconTable(),game.hud.leaderboard.updateBoardState(this.knownBoardState,this.knownPlayerState,this.playerInfo));void 0!==b.playerActionButtonGlobalCooldownValue&&(app.settings.playerActionButtonGlobalCooldownValue=b.playerActionButtonGlobalCooldownValue)},getOfferOptions:function(){return!a.knownConfigState||
!a.knownConfigState.offerOptions||1>a.knownConfigState.offerOptions.length?null:a.knownConfigState.offerOptions},addLocalPresetFile:function(b){!b||!b.offers||0>=b.offers.length||a.sendMessageWithCode("upload_preset",{filename:"local",data:b})},replaceCreditIcon:function(a){var b=new c.graphics.ImageRef(a),f=gfx.assets.ticket.image;gfx.assets.ticket.image=b;gfx.assets.ticket.res=a;!0===f.isCenteredX()&&b.setCentered(!0,!0);null!=effects.ticket&&(effects.ticket=gfx.getImage("ticket"));null!=game.hud.playerCreditsIcon&&
game.hud.playerCreditsIcon.useImageRef(gfx.getImage("ticket"));null!=game.hud.creditSourceIcon&&game.hud.creditSourceIcon.useImageRef(gfx.getImage("ticket"))},replaceCreditSound:function(a){c.audio.loadSound({id:"ticket_collect",resource:a,volume:.2,count:10})},replaceColors:function(a){var b=new c.graphics.Color(a.text);if(a.text){ui.config.titleFont.color=b;ui.config.leaderboardFont.color=b;ui.config.mainFont.color=b;var f=(new c.graphics.Color(b.r,b.g,b.b,b.a)).shift(60);ui.config.logFont.color=
f;ui.config.labelFont.color=f;ui.config.toggleFont.color=f;ui.config.headingFont.color=f;ui.config.smallOfferInfoFont.color=f}f=new c.graphics.Color(a.currency);if(a.currency){ui.config.creditsColor=f;ui.config.normalCurrencyFont.color=f;ui.config.tinyCurrencyFont.color=f;ui.config.multiplierFont.color=f;for(var d=$jscomp.makeIterator(Object.values(ui.formatMap)),k=d.next();!k.done;k=d.next())k=k.value,"\u03c4"===k.formatChar&&(k.color=f);game.hud.playerCredits.setColor(f)}var h=new c.graphics.Color(a.buttonGradient1),
l=new c.graphics.Color(a.buttonGradient2);f={gradient:null==a.buttonGradient1?ui.config.BUTTON_PURPLE.normal.gradient:[a.buttonGradient1,a.buttonGradient2],textColor:null==a.text?ui.config.BUTTON_PURPLE.normal.textColor:a.text};d={gradient:null==a.buttonGradient1?ui.config.BUTTON_PURPLE.highlighted.gradient:[(new c.graphics.Color(h.r,h.g,h.b,h.a)).shift(29).toHexString(),(new c.graphics.Color(l.r,l.g,l.b,l.a)).shift(29).toHexString()],textColor:null==a.text?ui.config.BUTTON_PURPLE.highlighted.textColor:
b.shift(21).toHexString()};k={gradient:null==a.buttonGradient1?ui.config.BUTTON_PURPLE.disabled.gradient:[(new c.graphics.Color(h.r,h.g,h.b,h.a)).shift(-39).toHexString(),(new c.graphics.Color(l.r,l.g,l.b,l.a)).shift(-39).toHexString()],textColor:null==a.text?ui.config.BUTTON_PURPLE.disabled.textColor:b.shift(-39).toHexString()};b={gradient:null==a.buttonGradient1?ui.config.BUTTON_PURPLE.pressed.gradient:[(new c.graphics.Color(h.r,h.g,h.b,h.a)).shift(-29).toHexString(),(new c.graphics.Color(l.r,l.g,
l.b,l.a)).shift(-29).toHexString()],textColor:null==a.text?ui.config.BUTTON_PURPLE.pressed.textColor:b.shift(-29).toHexString()};ui.config.BUTTON_PURPLE_NON.normal=f;ui.config.BUTTON_PURPLE_NON.highlighted=d;ui.config.BUTTON_PURPLE_NON.disabled=k;ui.config.BUTTON_PURPLE_NON.pressed=f;ui.config.BUTTON_PURPLE.normal=f;ui.config.BUTTON_PURPLE.highlighted=f;ui.config.BUTTON_PURPLE.disabled=k;ui.config.BUTTON_PURPLE.pressed=b;null!=a.buttonGradient1&&null!=a.buttonGradient2&&(b=(new c.graphics.Color(f.gradient[1].r,
f.gradient[1].g,f.gradient[1].b,f.gradient[1].a)).shift(-120),ui.config.tinyLocksInFont.color=b,b=(new c.graphics.Color(b.r,b.g,b.b,b.a)).shift(-60),ui.config.tinyTimeFont.color=b);!1===app.isModAny()&&ui.setStandardButtonProperties(game.hud.settingsButton,ui.config.BUTTON_PURPLE);ui.setStandardButtonProperties(game.hud.helpButton,ui.config.BUTTON_PURPLE);ui.setStandardButtonProperties(game.hud.leaderboardButton,ui.config.BUTTON_PURPLE);a.menuOutline&&(ui.config.popBorderColor=a.menuOutline);a.menuBackground&&
(ui.config.popBackColor=a.menuBackground)},cardIDFromIndex:function(b){b%=a.knownConfigState.cards.length;return(b=a.knownConfigState.cards[b])?b.id:"1"},getConfigCard:function(b){for(var e=null,f=0;f<a.knownConfigState.cards.length;f++)if(a.knownConfigState.cards[f].id===b){e=a.knownConfigState.cards[f];break}e||(e=a.knownConfigState.cards[0]);if(!e)return c.console.logError("getConfigCard has no config card list!"),null;e.imageRef||(e.imageRef=new c.graphics.ImageRef(e.imageURL));return e},getConfigStamp:function(b){(b=
a.knownConfigState.stamps[b])||(b=a.knownConfigState.stamps.mixer);b.imageRef||(b.imageRef=new c.graphics.ImageRef(b.imageURL));return b},boardStateChange:function(b){if(b&&b.creditsLeaderboard)for(var e=0;e<b.creditsLeaderboard.length;e++)if(b.creditsLeaderboard[e].userID===a.playerInfo.userID){var f=b.creditsLeaderboard[e].credits;break}c.console.log("> PE board change, my score : "+f);game.hud.leaderboard.updateBoardState(b,this.knownPlayerState,this.playerInfo);this.knownBoardState=b},autoFeedStateChange:function(a){this.knownAutoFeedState=
a;game.hud&&(game.hud.gotUpdatedGlobalState(),game.hud.statusInfoPane&&game.hud.statusInfoPane.updateDisplay(this.knownGlobalState,a),game.hud.autofeedDataAccuracyDisplay&&game.hud.autofeedDataAccuracyDisplay.updateDisplay(a),game.hud.statBar&&game.hud.statBar.updateAnchorStats(this.knownGlobalState,a))},statsStateChange:function(a){c.console.log("> PE stats change");game.hud.gotUpdatedStatsState(a);this.knownStatsState=a},uxStateChange:function(a){"mobile"===app.platform?c.console.log("> PE skip ux state change on mobile"):
(c.console.log("> PE got ux state change"),app.types.Customizer&&app.types.Customizer.handleProxyChange(a))},fakeRoundResults:function(){game.hud.showWinners({winners:[{name:"Dr. Flogwhompy",userID:31308190},{name:"A1abamaH0tpck3t",userID:32316796},{name:"xX DEATH PICKLE Xx",userID:40524933},{name:"xtr3m n00gi3",userID:32316796},{name:"Hoppity Jones",userID:31308190},{name:"Bobby Wondertoot",userID:266792},{name:"!superbooger!",userID:0},{name:"Lord Fluffykins",userID:338492}]})},reportError:function(b){a.error||
(a.error=b,game.hud.showError(a.error))},clearError:function(b){a.error&&a.error.errorCode===b&&game.hud.clearError()},setAndShowPermissions:function(a){a=a||{};for(var b=!1,c=0;c<d.length;c++){var g=d[c].fieldName,k=a[g];void 0!==k&&(this.permissions[g]!==k&&(b=!0),this.permissions[g]=k)}b&&game.hud.gotModStatusChange()},isOriginallyMod:function(){return this.permissions.canEdit||this.permissions.canConfig||this.permissions.isOwner},debugSendName:function(a){},debugSendPing:function(){this.sendMessage({code:"ping",
id:1E4*Math.random()|0})},update:function(a){"play"===this.state&&(this.serverTimestampEstimated=c.system.dateNow-this.localServerTimeDelta,this.time+=a)},setLanguage:function(a){a=(""+a).toLowerCase();if(!1===c.string.isKnownLanguage(a)){if(!1===c.string.isKnownLocale(a)){c.console.log("Invalid lanugage/locale");return}}else a=c.string.getLanguageCodeFromLanguage(a);c.string.setLocale(a);ui.applyTooltip(game.hud.leaderboardDummy,c.string.getString("STR_TOGGLE_LEADERBOARD_TOOLTIP"));game.hud.leaderboardDropDown.setTooltip(c.string.getString("STR_TOGGLE_LEADERBOARD_TOOLTIP"));
game.hud.leaderboardDropDown.button.setTextValue(c.string.getString("STR_LEADERBOARD_TITLE"));game.hud.leaderboard.roundLeaderboardTitle&&game.hud.leaderboard.roundLeaderboardTitle.setTextValue(c.string.getString("STR_LEADERBOARD_SCORE"));game.hud.leaderboard.dailyLeaderboardTitle&&game.hud.leaderboard.dailyLeaderboardTitle.setTextValue(c.string.getString("STR_LEADERBOARD_ROUNDWINS"));game.hud.actionLogDropDown&&game.hud.actionLogDropDown.button.setTextValue(c.string.getString("STR_SETTINGS_ACTIONLOG"));
ui.applyTooltip(game.hud.helpButton,c.string.getString("STR_HELP_TITLE"));window.ui.HelpScreen&&window.ui.HelpScreen.languageUpdated();ui.applyTooltip(game.hud.settingsButton,c.string.getString("STR_SETTINGS_TITLE"));window.ui.SettingsMenu&&window.ui.SettingsMenu.languageUpdated();game.hud.customizer.proxies[0].name=c.string.getString("STR_SETTINGS_ACTIONLOG");game.hud.gameInfoPane&&game.hud.gameInfoPane.showState(game.hud.gameInfoPane.state);game.hud.offerHolder&&game.hud.offerHolder.updateAllText()},
logCustom:function(b,c){1===c?a.debugLog.push(b):2===c&&a.debugLog.push("(repeats...)")},updateDebugLog:function(b){b=this.time-b;0<this.debugLog.length&&3<this.time&&(b/2|0)!==(this.time/2|0)&&(this.sendMessage({code:"debugLog",log:this.debugLog}),a.debugLog=[])},handleDebugCommand:function(a){window.eval(a)},autoTestAfterJoin:function(){function b(a){for(var b=0;b<a.length;b++)h+=a[b].t,window.setTimeout(a[b].f,h)}var c=3,f={name:"My Test Offer in [time]?",multiplier:3,slotIndex:c,bet:"STR_ACTION_YES"},
d=[{t:1200,f:function(){a.sendCreatingOffer(f)}},{t:200,f:function(){a.sendNewOffer(f)}},{t:500,f:function(){void 0!==f.bet&&(f.offerID=a.knownOffers[c].offerID,f.bet="STR_ACTION_YES",f.amount=10,a.sendPlaceBet(f))}}],k=[{t:420,f:function(){f.offerID=a.knownOffers[c].offerID;a.sendMessageWithCode("resolving_offer",{slotIndex:c,offerID:f.offerID})}},{t:20,f:function(){f.offerID=a.knownOffers[c].offerID;a.sendResolveOffer({slotIndex:c,offerID:f.offerID,resolution:"STR_ACTION_YES"})}}],h=0;b(d);b(k);
b([{t:50,f:function(){f.slotIndex=c=2;f.lockTimer=20}}]);b(d);b(k)}};c.console.logCustom=a.logCustom;window.peSync=a});
rat.modules.add("js.ui.confirm_popup",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(a,b,e,f){d.prototype.parentConstructor.call(this);this.message=b;this.setSize(1024,360);this.centerInDisplay();this.setFrame(3);this.background=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.bodyText=ui.makeText(this,ui.formatText(b),0,this.size.y/2);this.bodyText.setSize(this.size.x-
128,this.size.y);this.bodyText.setPos(64,0);this.bodyText.setAutoWrap(!0);this.bodyText.centerText();this.bodyText.enableDefaultSpecialFormatting();e?(this.yesButton=ui.makeButtonAt(this,"Yes",256,360),this.yesButton.setPos(this.yesButton.getPos().x,this.yesButton.getPos().y-this.yesButton.size.y),this.yesButton.setCallback(function(){c.screenManager.popScreen();e()}),this.noButton=ui.makeButtonAt(this,"No",768,360),this.noButton.setPos(this.noButton.getPos().x,this.noButton.getPos().y-this.yesButton.size.y),
f?this.noButton.setCallback(function(){c.screenManager.popScreen();f()}):this.noButton.setCallback(function(){c.screenManager.popScreen()})):(this.closeButton=ui.makeButtonAt(this,"Close",768,360),this.closeButton.setPos(512-this.closeButton.size.x/2,this.closeButton.getPos().y-this.closeButton.size.y),this.closeButton.setCallback(function(){c.screenManager.popScreen()}));this.setModal(!0);this.setAllowClickAway(!0);this.setAllowBackClose(!0);c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,
c.ui.Screen);d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"Confirm popup activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"Confirm popup deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay()};d.prototype.updateSelf=function(a){this.bodyText.setTextValue(ui.formatText(this.message))};window.ui.ConfirmPopup=d});
rat.modules.add("js.ui.offer_holder",[{name:"rat.ui.r_ui",processBefore:!0},{name:"js.ui.ui",processBefore:!0},{name:"js.ui.offer_pane",processBefore:!0},"js.ui.edit_offer_screen"],function(c){var d=app.types.OfferPane,a=-ui.config.HOLDER_X_SHIFT,b=function(a){b.prototype.parentConstructor.call(this,a);this.buttons=[];this.offerList=[];this.playerBets=[];this.resolveOfferScreen=this.editOfferScreen=null;this.knownGlobalState={};this.makeCovers()};c.utils.inheritClassFrom(b,c.ui.Element);b.prototype.getSlotTopLeft=
function(a,b){b=b||!1;if(app.isModEdit()||"mobile"===app.platform)b=!1;var c=0;b&&(c=-(d.offerPaneWidth-app.config.SIDE_W)+5);return{x:c,y:5+a*d.offerPaneYSpace}};b.prototype.getOfferPane=function(a){return this.buttons[a]};b.prototype.getSlotCenter=function(a,b){a=this.getSlotTopLeft(a,b);a.x+=d.offerPaneWidth/2;a.y+=d.offerPaneHeight/2;return a};b.prototype.makeCovers=function(b,f){this.covers=[];for(b=0;b<app.config.MAX_OFFER_SLOTS;b++){f=this.getSlotTopLeft(b);var e=new c.ui.Sprite(this);e.useImageRef(gfx.getImage("button_cover"));
e.setPos(a,f.y-15);e.setSize(50,d.offerPaneHeight);e.setVisible(!1);this.covers[b]=e}};b.prototype.setOfferList=function(a,b){this.updateOffers(a,b,this.playerBets)};b.prototype.setPlayerBets=function(a,b){this.updateOffers(a,this.offerList,b)};b.prototype.slotFromOfferID=function(a){for(var b=0;b<this.buttons.length;b++)if(this.buttons[b].offerDetails&&this.buttons[b].offerDetails.offerID===a)return b;return-1};b.prototype.updateOffers=function(a,b,d){if(null!=a.roundIsActive){for(var e=this.knownGlobalState.roundIsActive!==
a.roundIsActive,f=0;f<app.config.MAX_OFFER_SLOTS;f++){var g=this.offerList[f],m=b[f];if(m){var n=d?d[m.offerID]:null,t=null==this.buttons[f];g?g.state!==m.state?t=!0:("open"===m.state&&this.buttons[f].setOfferDetails(m,n,!1,!0),"empty"===m.state&&e&&(t=!0)):t=!0;if(t){if(g=this.buttons[f])g.deleteActions&&g.deleteActions(),g.removeMe?g.removeMe():this.removeSubElement(g),this.buttons[f]=null;if("empty"===m.state)var p=this.setSlotEmpty(f,a.roundIsActive);else"creating"===m.state?p=this.setSlotCreating(f,
m):"open"===m.state&&(p=this.setSlotOffer(f),p.setOfferDetails(m,n,!0),game.hud.suppressAnimation("newoffer")||p.animateIn());this.buttons[f]=p;p.adjustBoundsForPointer=function(a,b){if("mousemove"===b.eventType)a.x+=4,a.y+=4,a.w-=8,a.h-=8;else return c.ui.Element.prototype.adjustBoundsForPointer.call(this,a,b)}}this.offerList[f]=m}}for(b=0;b<this.buttons.length;b++)this.moveSubElementToFront(this.buttons[b]);for(b=0;b<this.buttons.length;b++)this.moveSubElementToFront(this.covers[b]),this.covers[b].setVisible(!!this.buttons[b].isOfferPane);
this.playerBets=d;this.knownGlobalState=a}};b.prototype.setSlotEmpty=function(a,b){return app.isModEdit()&&b?this.setSlotNew(a):this.setSlotActuallyEmpty(a)};b.prototype.setSlotActuallyEmpty=function(a){a=this.getSlotTopLeft(a,!0);var b=new c.ui.Sprite(this);b.useImageRef(gfx.getImage("empty_button_slot"));b.setPos(a.x,a.y);b.setSize(d.offerPaneWidth,d.offerPaneHeight);b.centerSprite();b.setVisible(!1);return b};b.prototype.setSlotCreating=function(a,b){return app.isModEdit()?this.setSlotMessage(a,
""+b.editor.username+" is creating...",b.editor):this.setSlotActuallyEmpty(a)};b.prototype.setSlotEditing=function(a,b){if(app.isModEdit())return this.setSlotMessage(a,""+b.editor.username+" is editing...",b.editor)};b.prototype.setSlotMessage=function(a,b,g){var e=this.getSlotTopLeft(a);b=ui.makeText(this,b,20+e.x,e.y,d.offerPaneWidth-40,d.offerPaneHeight);b.autoCenter(!0,!0);ui.setFontProperties(b,ui.config.buttonFont);b.setAutoWrap(!0);app.isOwner()&&g&&g.sessionID!==peSync.playerInfo.sessionID&&
(g=ui.makeButtonAt(b,c.string.getString("STR_BOOT"),b.size.x+32,b.size.y-ui.config.smallButtonHeight/2,2*ui.config.smallButtonWidth,ui.config.smallButtonHeight,ui.config.BUTTON_MOD),g.setCallback(function(){peSync.freeOfferSlot({slotIndex:a})}),b.setTracksMouse(!0),b.bootButton=g);return b};b.prototype.setSlotNew=function(a){var b=this,e=this,k=this.getSlotCenter(a);k=ui.makeButtonAt(this,"",k.x,k.y,d.offerPaneWidth,d.offerPaneHeight,ui.config.BUTTON_MOD);k.setSize(d.offerPaneWidth,d.offerPaneHeight);
k.setTextValue(c.string.getString("STR_MAKE_NEW_OFFER"));ui.setFontProperties(k,ui.config.buttonFont);k.setCornerRadius(ui.config.buttonCornerRadius);k.offerInfo={index:a};k.setCallback(function(){e.hideAllActions();b.editOfferScreen=app.types.EditOfferScreen.makeNew(a)});return k};b.prototype.setSlotOffer=function(a){a=this.makeSlotOffer(a);this.appendSubElement(a.getContainer());return a};b.prototype.makeSlotOffer=function(a){var b=this.getSlotCenter(a,!0);a=d.makeOfferPane(a);a.getContainer().setPos(b.x,
b.y);return a};b.prototype.updateAllActions=function(a){for(var b=-1,e=-1,k=-1,h="mouse"===c.input.lastUIInputType&&0<=c.mousePos.x||"mobile"===app.platform,l=0;l<this.buttons.length;l++){var m=this.buttons[l];if(m){if(m.isHighlighted()&&game.hud.offersOpen&&"mouseDown"!==a&&"mouseMove"!==a){b=l;break}if(m.actionPanel&&m.actionPanel.creditSelector.isPressed()){b=l;break}if(m.actionPanel&&(m.actionPanel.creditSelector.isHighlighted()||m.actionPanel.yesButton.isHighlighted()||m.actionPanel.noButton.isHighlighted())){b=
l;break}if(h){var n=this.getSlotTopLeft(l,!1),t=this.getGlobalPos(n),p=c.mousePos;n=p.y>t.y&&p.y<t.y+d.offerPaneHeight;var q=p.x>t.x&&p.x<t.x+d.offerPaneWidth;n&&q&&(e=l);if(m.actionsVisible){q=p.y>t.y-100&&p.y<t.y+d.offerPaneHeight+100;var v=m.actionPanel&&p.x<t.x+m.actionPanelWidth+200;m=m.actionPanel&&p.x<t.x+m.actionPanelWidth;"mouseDown"===a&&n&&m?k=l:"mouseDown"!==a&&q&&v&&(k=l)}}}}h=-1;-1<b?h=b:-1<e?h=e:-1<k&&(h=k);for(l=0;l<this.buttons.length;l++)if(m=this.buttons[l])b=m.getContainer?m.getContainer():
m,e=b.getPos(),l===h&&this.buttons[l].canToggleMobile?(k=this.getSlotTopLeft(l,!1),n="open",(!m.actionsVisible&&m.showActions||m.actionsVisible&&m.showActions&&"knownPlayerStateUpdate"===a)&&m.showActions()):(k=this.getSlotTopLeft(l,!0),n="close",m.hideActions&&m.actionsVisible&&m.hideActions(),!m.isHighlighted()||"mouseMove"!==a&&"mouseDown"!==a||l===h||m.setHighlighted(!1),"mobile"===app.platform&&(this.buttons[l].canToggleMobile=!1)),k.x!==e.x&&b.inoutMover!==n&&(b.inoutMover=n,b.killAllAnimators("mover"),
k.x+=d.offerPaneWidth/2,k.y+=d.offerPaneHeight/2,b.slideTo(k,.15),"open"===n&&m.isVisible()&&audio.playSound("offer_slide_navigate"))};b.prototype.hideAllActions=function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].hideActions&&this.buttons[a].hideActions()};b.prototype.updateAllText=function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].updateNameText&&this.buttons[a].updateNameText(),this.buttons[a].updateSummaryDisplay&&this.buttons[a].updateSummaryDisplay(),this.buttons[a].updateLocksInText&&
this.buttons[a].updateLocksInText()};b.prototype.handleMouseMove=function(a,b,c){"mobile"!==app.platform&&this.updateAllActions("mouseMove");d.prototype.parentPrototype.handleMouseMove.call(this,a,b,c)};b.prototype.mouseLeave=function(a){this.updateAllActions("mouseMove");d.prototype.parentPrototype.mouseLeave(this,a)};b.prototype.mouseEnter=function(a){this.updateAllActions("mouseMove");d.prototype.parentPrototype.mouseEnter(this,a)};b.prototype.drawSelf=function(a){};b.prototype.updateSelf=function(a){};
b.prototype.mouseDown=function(a,b){return!1};app.types.OfferHolder=b});
rat.modules.add("js.ui.offer_pane",[{name:"rat.ui.r_ui_button",processBefore:!0},"js.ui.ui","js.ui.resolve_offer_screen"],function(c){var d=new c.graphics.Color(0,0,0,.2),a=new c.graphics.Color(255,255,255,.8),b=!1,e=function(f,g){function k(a){var b=new c.ui.Shape(h,"rect");b.setColor(a);b.setSize(48,134);b.setPos(253,11);return b}b=app.isModEdit();e.prototype.parentConstructor.call(this,f,c.ui.Button.bubbleType);var h=this;h.isOfferPane=!0;h.placedBet=!1;h.lastResolvingName=null;h.lastEditingName=
null;h.setSize(312,156);ui.setStandardButtonProperties(this);h.inoutState="open";h.timeUp=!1;f=this.checkAndMakeTextBox();f.setAutoWrap(!0);f.enableDefaultSpecialFormatting();f.setSquishToFit({tryCount:10,squishPerTry:.1});ui.setFontProperties(this,ui.config.offerFont);this.canToggleMobile="mobile"===app.platform?!1:!0;f=new c.ui.Sprite(h);f.useImageRef(gfx.getImage("pull_tab"));f.setPos(213,50);this.pullTab=f;this.makeSummaryVisuals(h,209);var l=this.betStrip=k(d);l.setVisible(!1);f=this.preStrip=
k(a);this.preStrip.setVisible(!0);var m=new c.ui.Sprite(l);m.useImageRef(gfx.getImage("icon_bet_yes"));m.setSize(48,48);m.setPos(7,20);this.betIcon=m;m=new c.ui.Sprite(l);var n=gfx.getImageCopy("ticket");n.setCentered(!1,!1);m.setSize(40,40);m.setFlag(c.ui.Element.autoScaleAfterLoadFlag);m.useImageRef(n);m.setPos(4,60);this.currencyIcon=m;l=ui.makeText(l,"??",0,103,46,20,ui.config.tinyCurrencyFont);l.centerText();l.managedUpdateState=0;this.currencyText=l;l=new c.ui.Sprite(f);l.useImageRef(gfx.getImage("icon_clock_lock"));
l.setSize(48,48);l.setPos(8,12);this.lockTimerIcon=l;l.setVisible(!1);l=ui.makeText(f,"??",0,105,46,20,ui.config.tinyTimeFont);l.setAlignment("center");this.lockTimerText=l;l=ui.makeText(f,c.string.getString("STR_ACTION_LOCKSIN"),0,50,46,50,ui.config.tinyLocksInFont);l.setAlignment("center");l.fontLineSpacing=-2;this.locksInText=l;this.offerLockedSprite=new c.ui.Sprite(f);this.offerLockedSprite.useImageRef(gfx.getImage("offer_locked"));this.offerLockedSprite.sizeToImage();this.offerLockedSprite.setPos(3,
8);this.offerLockedSprite.autoCenter(!0,!0);this.offerLockedSprite.setVisible(!1);f=new c.ui.Sprite(this);f.useImageRef(gfx.getImage("multiplier_tab"));f.sizeToImage();f.setPos(306,108);l=f.getHeight();f.setCenter(0,l/2);f.setPosY(f.getPosY()+l/2);this.multiplierTab=f;f=ui.makeText(f,"x3",22,f.size.y/2-11.5,36,23,ui.config.multiplierFont);f.setAlignment("left");this.multiplierText=f;f=ui.makeStatText(h.getContainer(),"",h.size.x,16,512,32);f.setFontSize(30);this.editingModName=f;f=new c.ui.Element(h.getContainer());
f.setSize(30,70);f.setPos(317,20);f.setVisible(!1);this.preResolvingPane=f;preResSprite=new c.ui.Sprite(f);preResSprite.useImageRef(gfx.getImageCopy("resolve_pending"));preResSprite.sizeToImage();preResSprite.setPos(5,10);f=ui.makeStatText(f,"",f.size.x,f.size.y/2,512,32);f.setFontSize(30);this.resolvingModName=f;this.moveSubElementToFront(this.getTextBox());this.moveSubElementToFront(this.buttonImage);this.slotIndex=g;this.offerDetails={};this.betStrings=[c.string.getString("STR_ACTION_YES"),c.string.getString("STR_ACTION_NO")];
this.betCodes=["STR_ACTION_YES","STR_ACTION_NO"];this.timeElapsed=0;this.timeElapsedOld=-1;this.displayTimeLeft=0;this.displayTimeLeftOld=-1;this.actionPanel=null;this.setCallback(function(a,b){"mobile"===app.platform&&(this.canToggleMobile=!this.canToggleMobile)});this.buttonIcon=new ui.ButtonIcon(this,"dright_button",6);this.buttonIcon.reposition(6,{size:{x:this.size.x+36,y:this.size.y}});this.openIcon=new ui.ButtonIcon(this,"pull_tab",6);this.openIcon.reposition(6,{size:{x:this.size.x+52,y:this.size.y-
54}});this.setUseOffscreen(!0);this.offscreenSize={x:this.size.x+110,y:this.size.y}};c.utils.inheritClassFrom(e,c.ui.Button);e.offerPaneWidth=312;e.offerPaneHeight=156;e.offerPaneYSpace=148;e.previewShiftX=60;e.resolveShiftX=50;e.makeOfferPane=function(a){var b=new c.ui.Element(null);a=new e(b,a);var f=a.getSize();b.setSize(f);a.setPos(f.w/2,f.h/2);a.setCenter(e.offerPaneWidth/2,e.offerPaneHeight/2);b.setCenter(e.offerPaneWidth/2,e.offerPaneHeight/2);return a};e.prototype.removeMe=function(){this.parent&&
this.parent.parent||console.log("something's messed up in removeMe");this.parent.parent.removeSubElement(this.parent)};e.prototype.getContainer=function(){return this.parent};e.prototype.makeSummaryVisuals=function(a,b){var e=b-20,f=new c.ui.Sprite(a);f.useImageRef(gfx.getImage("category_kill"));f.setPos(e,46);this.summaryIcon=f;this.summaryIcon.setVisible(!1);a=ui.makeText(a,"",b,141,126,30,ui.config.summaryFont);a.centerText();a.setRotation(-Math.PI/2);this.summaryText=a;this.summaryText.setVisible(!1)};
e.prototype.resizeTextBox=function(){if(this.text){this.textInset=25;this.textOffsetX=7;var a=this.size.x-2*this.textInset-48;this.text.setPos(this.textInset+this.textOffsetX,16);this.text.setSize(a,124)}};e.prototype.convertTimeFormat=function(a){var b=Math.floor(a/60);a%=60;a=10>a?"0"+a:a;return 0===parseInt(b)?":"+a:b+":"+a};e.prototype.calcTime=function(a){this.timeElapsedOld=this.timeElapsed;this.displayTimeLeftOld=this.displayTimeLeft;this.offerDetails&&(this.timeElapsed=(peSync.serverTimestampEstimated-
this.offerDetails.timeCreated)/1E3,this.displayTimeLeft=Math.max(this.offerDetails.betTimer-this.timeElapsed+.99999|0,0),this.displayTimeLeftOld!==this.displayTimeLeft&&3>=this.displayTimeLeft&&b&&this.offerDetails.editor&&this.offerDetails.editor.userID===peSync.playerInfo.userID&&audio.playSound("will_need_resolution"));return this.timeElapsed};e.prototype.updateLocksInText=function(){this.locksInText.setTextValue(c.string.getString("STR_ACTION_LOCKSIN"))};e.prototype.updateLockTimerText=function(a){a=
"";this.offerDetails&&(a=this.convertTimeFormat(this.offerDetails.lockTimer-this.timeElapsed+.999999|0));this.lockTimerText.setTextValue(a)};e.prototype.isFullyOpen=function(){return 155<=this.getContainer().place.pos.x};e.prototype.updateSelf=function(a){e.prototype.parentPrototype.updateSelf.call(this,a);b=app.isModEdit();a=0>this.getContainer().place.pos.x;var f=this.isFullyOpen();this.text.setVisible(!a);this.resultsMode||this.multiplierTab.setVisible(f||!!this.multiplierTab.pulsing);this.pullTab.setVisible(a&&
this.canAct);a=a&&!this.canAct||!!this.previewMode;this.useSummaryIcon?(this.summaryIcon.setVisible(a),this.summaryText.setVisible(!1)):(this.summaryIcon.setVisible(!1),this.summaryText.setVisible(a));b&&this.offerDetails.isEditingEditors&&(a=0===this.offerDetails.isEditingEditors.length?"":this.offerDetails.isEditingEditors[0].username,this.lastEditingName!==a&&(""!==a?this.editingModName.setTextValue(a+" "+c.strings.getString("STR_IS_EDITING")):this.editingModName.setTextValue("")),this.lastEditingName=
a);if(this.offerDetails&&!this.resultsMode){a=this.timeElapsedOld;f=this.calcTime();if(this.offerDetails.lockTimer){var d=f>this.offerDetails.lockTimer;a>this.offerDetails.lockTimer||!d?this.updateLockTimerText():(this.lockTimerText.setVisible(!1),this.locksInText.setVisible(!1))}this.offerDetails.betTimer&&(f=f>this.offerDetails.betTimer,a>this.offerDetails.betTimer||!f||(b&&this.offerDetails.editor.userID===peSync.playerInfo.userID&&this.pulseOffer(0,"offer_needs_resolution"),this.showPreResolving(!0)));
b&&this.offerDetails.isResolvingEditors&&(a=0===this.offerDetails.isResolvingEditors.length?"":this.offerDetails.isResolvingEditors[0].username,this.lastResolvingName!==a&&(""!==a?this.resolvingModName.setTextValue(a+" "+c.strings.getString("STR_IS_RESOLVING")):this.resolvingModName.setTextValue("")),this.lastResolvingName=a)}this.offerDetails&&this.displayTimeLeft!==this.displayTimeLeftOld&&this.updateNameText()};e.prototype.setOfferDetails=function(b,e,k,h){k||!h||game.hud.suppressAnimation("pulse lock")||
e||this.offerDetails.isLocked===b.isLocked||(b.isLocked?(k=new c.ui.Animator(c.ui.Animator.scaler,this.offerLockedSprite),k.setTimer(.3),k.setStartEnd(5,1),k.setDoneCallback(function(){audio.playSound("offer_locked")})):audio.playSound("offer_unlocked"));this.offerDetails=b;this.playerBet=e;this.canAct=!1;k=b.betOptions;h=null!=k&&null!=k[0]?!0===k[0].startsWith("STR_")?c.string.getString(k[0]):k[0]:c.string.getString("STR_ACTION_YES");var f=null!=k&&null!=k[1]?!0===k[1].startsWith("STR_")?c.string.getString(k[1]):
k[1]:c.string.getString("STR_ACTION_NO");this.betStrings=[h,f];null!=k&&(this.betCodes=[k[0],k[1]]);this.resultsMode||this.offerLockedSprite.setVisible(b.isLocked);this.calcTime();e?(this.betStrip.setVisible(!0),this.preStrip.setVisible(!1),this.betIcon.useImageRef(gfx.getImage(ui.iconTable.getIconSet(e.betString).iconSmall)),1>this.currencyText.managedUpdateState&&this.currencyText.setTextValue(""+e.credits)):(this.lockTimerIcon.setVisible(!1),this.lockTimerText.setVisible(!1),this.locksInText.setVisible(!1),
this.offerDetails.lockTimer&&!b.isLocked&&0<this.offerDetails.lockTimer-this.timeElapsed&&(this.lockTimerIcon.setVisible(!0),this.lockTimerText.setVisible(!0),this.locksInText.setVisible(!0),this.updateLockTimerText()),b.isLocked?this.preStrip.setColor(d):(this.preStrip.setColor(a),this.canAct=!0));this.updateSummaryDisplay();this.multiplierText.setTextValue("x"+b.multiplier);this.updateNameText();ui.setStandardButtonProperties(this,ui.config.BUTTON_PURPLE);ui.setButtonNon(this);this.actionPanel&&
this.updateActions(b,e);b.isResolving||b.betTimer&&this.timeElapsed>b.betTimer?(this.showPreResolving(!0),this.timeUp=!0):(this.showPreResolving(!1),this.timeUp=!1)};e.prototype.updateNameText=function(){if(this.offerDetails){var a=!0===this.offerDetails.name.startsWith("STR_")?null==this.offerDetails.stringTokens||0===this.offerDetails.stringTokens.length?c.string.getString(this.offerDetails.name):c.string.getStringReplaceTokens(this.offerDetails.name,this.offerDetails.stringTokens):this.offerDetails.name;
var b=0;do{var e=a.indexOf("[",b);if(-1<e){var d=a.indexOf("]",e);if(-1<d){b=!1;if(0<e&&d<a.length-2){var l=a[e-1];l!==a[d+1]||"*"!==l&&"^"!==l&&"~"!==l&&"|"!==l||(b=!0)}var m=a.substring(e+1,d).toLowerCase();(l=peSync.knownGlobalState.keywords[m])?(b=b?"":"^",b=b+l+b,a=a.substring(0,e)+b+a.substring(d+1)):"time"===m&&(b=b?"":"~",b=b+this.convertTimeFormat(this.displayTimeLeft)+b,a=a.substring(0,e)+b+a.substring(d+1));b=e+1}}}while(0<=e&&0<=d);a=ui.formatText(a);this.setTextValue(a)}};e.prototype.updateSummaryDisplay=
function(){var a=this.offerDetails;if(a&&a.summary){this.useSummaryIcon=!1;for(var b=[{names:["survive","death","STR_OFFER_SUM_SURVIVE"],resource:"category_death"},{names:["get a kill","kill","STR_OFFER_SUM_KILL"],resource:"category_kill"},{names:["kill count","STR_OFFER_SUM_KILL_COUNT"],resource:"category_kill_total"},{names:["rank","ranking","STR_OFFER_SUM_RANK"],resource:"category_ranking"}],c=0;c<b.length;c++){var e=b[c];0<=e.names.indexOf(a.summary)&&(this.summaryIcon.useImageRef(gfx.getImage(e.resource)),
this.useSummaryIcon=!0)}this.summaryText.setTextValue(a.summary)}};e.prototype.animateIn=function(){c.ui.killAnimatorsForElement(this);audio.playSound("offer_arrive");this.slideInFrom("right",.3);var a=this.pulseOffer(.3);this.pulseMultiplier(.3+a)};e.prototype.pulseOffer=function(a,b){if(game.hud.suppressAnimation("pulseOffer"))return 0;var e=this;b=b||"new_offer";var f=new c.ui.Animator(c.ui.Animator.scaler,this);f.setDelay(a+.1);f.setTimer(.1);f.setStartEnd(1,1.2);f.setDelayDoneCallback(function(){e.gradientLayer&&
(e.gradientLayer.gradColorSet=ui.config.BUTTON_FLASHY,e.gradientLayer.updateGradients())});f=new c.ui.Animator(c.ui.Animator.scaler,this);f.setDelay(a+.1+.1);f.setDelayDoneCallback(function(){audio.playSound(b);e.gradientLayer&&("web"===app.platform&&"mobile"!==app.platform&&"mouse"===c.input.lastUIInputType?ui.setButtonNon(e):(e.gradientLayer.gradColorSet=ui.config.BUTTON_PURPLE,e.gradientLayer.updateGradients()))});f.setDoneCallback(function(){1!==e.scale.y&&c.console.log("offer pane still scaled up!")});
f.setTimer(.1);f.setStartEnd(1.2,1);return.1+.2};e.prototype.pulseMultiplier=function(a){if(this.offerDetails&&!(2>=this.offerDetails.multiplier)){var b=this,e=this.multiplierTab;e.setVisible(!0);e.pulsing=!0;var f=new c.ui.Animator(c.ui.Animator.scaler,e);f.setDelay(a+.1);f.setTimer(.1);f.setStartEnd(1,2);f=new c.ui.Animator(c.ui.Animator.scaler,e);f.setDelay(a+.1+.1);f.setDoneCallback(function(){var a=b.isFullyOpen();e.setVisible(a);e.pulsing=!1});f.setTimer(.1);f.setStartEnd(2,1)}};e.prototype.flagsChanged=
function(a){e.prototype.parentPrototype.flagsChanged.call(this,a);game.hud.offerHolder.updateAllActions()};e.prototype.drawSelfPost=function(a,b){};e.prototype.toggleActions=function(){this.actionsVisible?this.hideActions():this.showActions()};e.prototype.showActions=function(){this.actionPanel||this.createActions();this.updateActions(this.offerDetails,this.playerBet);this.actionPanel.setVisible(!0);this.actionPanel.setNeedsUpdate(!0);this.actionsVisible=!0};e.prototype.hideActions=function(){this.actionsVisible=
!1;this.actionPanel&&(this.actionPanel.setVisible(!1),this.actionPanel.setNeedsUpdate(!1))};e.prototype.deleteActions=function(){this.actionPanel&&(this.getContainer().parent.removeSubElement(this.actionPanel),this.actionsVisible=!1,this.actionPanel=null)};e.prototype.createActions=function(){function a(a,b,e,f,d,g){a=ui.makeButtonAt(h,a,b,e,ui.config.betButtonWidth,ui.config.betButtonHeight,ui.config.BUTTON_PURPLE);a.setStateTextColors([{state:c.ui.Element.enabledFlag,textColor:c.graphics.black},
{state:c.ui.Element.enabledFlag|c.ui.Element.pressedFlag|c.ui.Element.highlightedFlag,textColor:c.graphics.black}]);b=new c.ui.Shape(a,"roundrect");b.setSize(a.getWidth()-48,a.getHeight()-48);b.setPos(24,24);b.setColor(f);b.setCornerRadius(5);f=a.getTextBox();a.moveSubElementToFront(f);f.setPosY(16);f.setHeight(50);f=new c.ui.Sprite(a);f.useImageRef(gfx.getImage(d));f.setSize(52,52);f.setPos((a.getWidth()-52)/2,57);a.setCallback(g);return a}function e(a,b){a=ui.makeText(h,"9999",a,b,130,30,ui.config.tinyInfoFont);
a.centerText();a.setColor(ui.config.mainFont.color);return a}var d=this,h=this.actionPanel=new c.ui.Shape(null,"rect");this.getContainer().parent.insertSubElement(h,0);var l=game.hud.offerHolder.getSlotTopLeft(this.slotIndex,!1).y-10;0>l&&(l=0);h.setPos(0,l);var m=880;"mobile"===app.platform&&(m+=c.graphics.SCREEN_WIDTH+100);b&&(m+=270);this.actionPanelWidth=m;h.setSize(m,176);h.setColor(ui.config.darkBoxColor);h.buttonIcon=new ui.ButtonIcon(h,"dleft_button",6);h.buttonIcon.reposition(6,{size:{x:m+
32,y:176}});h.closeIcon=new ui.ButtonIcon(h,"pull_tab_left",6);var n=450;l=78;var t=ui.makeText(h,"Guess Made",n-ui.config.betButtonWidth/2,l-ui.config.betButtonHeight/2,2.5*ui.config.betButtonWidth,ui.config.betButtonHeight,ui.config.labelFont);t.setAlignment("center");t.setAutoWrap(!0);h.betStatusText=t;var p=game.hud.playerCredits.getGlobalPos(),q=this.currencyText,v=game.hud.playerCredits;t=new app.types.ValueSelector(h);t.setPos(n-ui.config.betButtonWidth/2,l-ui.config.betButtonWidth/2+7);t.nonMod();
h.creditSelector=t;h.creditSelector.parentOffer=d;t.setDefaultValue();h.creditSelector.upperButtonIcon=new ui.ButtonIcon(h.creditSelector,"rt_button",9,null,16);h.creditSelector.lowerButtonIcon=new ui.ButtonIcon(h.creditSelector,"lt_button",1,null,16);h.yesCountText=e(540,136);h.noCountText=e(700,136);n+=ui.config.betButtonWidth+ui.config.betButtonGap;h.yesButton=a(this.betStrings[0],n,l,ui.config.yesColor,ui.iconTable.getIconSet(this.betCodes[0]).iconLarge,function(a,b){if(h.placedBet)return!1;a=
h.creditSelector.getAmount();effects.betMultiTicketEffect(p,q,a,v);peSync.sendPlaceBet({slotIndex:d.slotIndex,offerID:d.offerDetails.offerID,bet:d.betCodes[0],amount:a});h.placedBet=!0;audio.playSound("made_bet");return!0});n+=ui.config.betButtonWidth+ui.config.betButtonGap;h.yesButton.buttonIcon=new ui.ButtonIcon(h.yesButton,"lb_button",7,null,16);h.yesButton.parentOffer=d;h.noButton=a(this.betStrings[1],n,l,ui.config.noColor,ui.iconTable.getIconSet(this.betCodes[1]).iconLarge,function(a,b){if(h.placedBet)return!1;
a=h.creditSelector.getAmount();effects.betMultiTicketEffect(p,q,a,v);peSync.sendPlaceBet({slotIndex:d.slotIndex,offerID:d.offerDetails.offerID,bet:d.betCodes[1],amount:a});h.placedBet=!0;audio.playSound("made_bet");return!0});n+=ui.config.betButtonWidth+ui.config.betButtonGap;h.noButton.buttonIcon=new ui.ButtonIcon(h.noButton,"rb_button",9,null,9);h.noButton.parentOffer=d;if(b){t=function(a,b,e,f,d,g,k){f=f||ui.config.modActionButtonWidth;d=d||ui.config.modActionButtonHeight;a=ui.makeButtonAt(h,a,
b,e,f,d,ui.config.BUTTON_MOD);a.setCallback(k);g&&(k=new c.ui.Sprite(a),k.useImageRef(gfx.getImage(g)),k.setSize(42,32),k.setPos((a.getWidth()-42)/2,12),g=a.getTextBox(),g.setFontSize(30),g.setPosY(18));return a};n=930;l=50;t("Edit",n,l,null,null,"icon_edit",function(a,b){makeEditWindow(d.slotIndex,d.offerDetails);return!0});n+=ui.config.modActionButtonWidth+20;var r="Lock";d.offerDetails.isLocked&&(r="Unlock");h.lockButton=t(r,n,l,null,null,"icon_lock",function(a,b){peSync.sendMessageWithCode("lock_offer",
{slotIndex:d.slotIndex,offerID:d.offerDetails.offerID,lock:!d.offerDetails.isLocked});return!0});l+=ui.config.modActionButtonHeight-5;t("Resolve",990,l,152,null,"icon_call",function(a,b){makeCallWindow(d.slotIndex,d.offerDetails);return!0});t=ui.makeText(h,"",m-500-10,176,500,40,ui.config.smallOfferInfoFont);t.setAlignment("right");h.creatorText=t}};e.prototype.updateActions=function(a,b){var e=this.actionPanel,f="";if(b&&b.betString){var d=!1;b=b.betString===this.betCodes[0]?0:1;f=c.string.getString("STR_ACTION_GUESSMADE")+
" "+this.betStrings[b]}else a.isLocked||a.isResolving||a.isModifying?(d=!1,a.isResolving?f=c.string.getString("STR_ACTION_RESOLVING"):a.isLocked?f=c.string.getString("STR_ACTION_LOCKED"):a.isModifying&&(f="Offer is being modified")):1>peSync.knownPlayerState.creditCount?(d=!1,f=c.string.getString("STR_ACTION_NOFUNDS")):d=!0;d?0>=e.creditSelector.getAmount()&&e.creditSelector.setDefaultValue():(e.yesButton.mouseLeave(),e.noButton.mouseLeave(),e.creditSelector.letGoDammit());e.placedBat=!d;e.yesButton.setEnabled(d);
e.yesButton.setVisible(d);e.noButton.setEnabled(d);e.noButton.setVisible(d);e.creditSelector.setEnabled(d);e.creditSelector.setVisible(d);e.yesCountText&&e.noCountText&&(a.betCounts.yes?e.yesCountText.setTextValue(""+a.betCounts.yes+" "+this.betStrings[0]):e.yesCountText.setTextValue(""),a.betCounts.no?e.noCountText.setTextValue(""+a.betCounts.no+" "+this.betStrings[1]):e.noCountText.setTextValue(""));f?(e.betStatusText.setTextValue(f),e.betStatusText.setVisible(!0),e.yesButton.setVisible(!1),e.yesButton.setEnabled(!1),
e.noButton.setVisible(!1),e.noButton.setEnabled(!1),e.creditSelector.setVisible(!1),e.creditSelector.setEnabled(!1),game.hud.needsInputMapRebuild=!0):e.betStatusText.setVisible(!1);e.lockButton&&(d="Lock",a.isLocked&&(d="Unlock"),e.lockButton.setTextValue(d));e.creatorText&&a.editor&&e.creatorText.setTextValue("edited by "+a.editor.username)};e.prototype.setResultsMode=function(){this.resultsMode=!0;this.setEnabled(!1);this.setTracksMouse(!1);var a={normal:ui.config.BUTTON_PURPLE.normal,highlighted:ui.config.BUTTON_PURPLE.normal,
disabled:ui.config.BUTTON_PURPLE.normal,pressed:ui.config.BUTTON_PURPLE.normal};this.gradientLayer.gradColorSet=a;this.gradientLayer.updateGradients();this.setTextColors(a.normal.textColor);this.buttonImage.setVisible(!1);this.setFrame(3,"black",-7)};e.prototype.setPreviewMode=function(){this.setResultsMode();this.previewMode=!0;this.setFrame(5,ui.config.popBorderColor,-7);var a=new c.ui.Shape(this.getContainer());a.setPos(-63,0);a.setSize(68,e.offerPaneHeight);a.setShapeType("rect");a.setColor(ui.config.popBackColor);
this.makeSummaryVisuals(a,30);this.arrowPane=new c.ui.Element(this.getContainer());this.arrowPane.setSize(e.offerPaneHeight,e.offerPaneHeight);this.arrowPane.setPos(e.offerPaneWidth+5,0);this.arrowPane.drawSelf=function(a){a=e.offerPaneHeight/2;c.graphics.drawArrow(100,a,0,a,ui.config.popBackColor,ui.config.popBorderColor,5)}};e.prototype.showPreResolving=function(a){this.preResolvingPane.setVisible(a)};makeCallWindow=function(a,b){game.hud.offerHolder.hideAllActions();game.hud.offerHolder.resolveOfferScreen=
app.types.ResolveOfferScreen.makeNew(a,b)};makeEditWindow=function(a,b){game.hud.offerHolder.hideAllActions();game.hud.offerHolder.EditOfferScreen=app.types.EditOfferScreen.makeNew(a,b)};app.types.OfferPane=e});
rat.modules.add("js.ui.error_screen",[{name:"rat.ui.r_screen",processBefore:!0},"js.ui.ui"],function(c){var d=function(){d.prototype.parentConstructor.call(this);this.setSize(1200,223);var a=new c.ui.Shape(this);a.setShapeType("rect");a.setColor(new c.graphics.Color(0,0,0,.8));a.setStroke(4,new c.graphics.Color("#D0D0D0"));var b=ui.makeText(this,"",0,0,1200,50);b.setFontSize(40);b.setColor("#D0D0D0");b.centerText();this.titleTextBox=b;b=ui.makeText(this,"",50,60,1100,200);b.setFontSize(34);b.setColor("#D0D0D0");
b.setAutoWrap(!0);b.setAlignment("center");b.setBaseline("top");this.messageTextBox=b;this.setModal(!0);b=ui.makeButtonAt(this,"Retry",600,183);b.setCallback(function(a,b){c.system.reloadLocation()});this.retryButton=b;this.centerInDisplay();this.setPosY(0);a.fitToParentSize()};c.utils.inheritClassFrom(d,c.ui.Screen);d.make=function(){var a=new d;c.screenManager.pushScreen(a);return a};d.prototype.screenActivate=function(){};d.prototype.screenDeactivate=function(){};d.prototype.onWindowResize=function(){};
d.prototype.setError=function(a){var b=a.stateMessage||"Error";a.error&&(b+="  :  "+a.error);this.titleTextBox.setTextValue(b);this.messageTextBox.setTextValue(a.errorMessage||"");a=a.retryButton;void 0===a&&(a=!0);a?this.retryButton.setVisible(!0):this.retryButton.setVisible(!1)};d.prototype.updateSelf=function(a){};d.prototype.drawSelfPost=function(a,b){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return!1};app.types.ErrorScreen=d});
rat.modules.add("js.ui.mod_menu",[{name:"rat.ui.r_screen",processBefore:!0},"js.ui.ui"],function(c){var d=function(){d.prototype.parentConstructor.call(this);this.setSize(400,400);var a=new c.ui.Shape(this);a.setShapeType("rect");a.setColor(new c.graphics.Color(0,0,0,.8));var b=ui.makeText(this,"Mod Menu",0,0,400,50);b.setFontSize(40);b.setFontStyle("bold");b.setColor("#D0D0D0");b.centerText();this.setModal(!0);this.setAllowClickAway(!0);this.setAllowClickBodyClose(!0);this.setAllowBackClose(!0);
b=this.makeButtons(this);this.setSize(400,b);this.centerInDisplay();a.fitToParentSize()};c.utils.inheritClassFrom(d,c.ui.Screen);d.make=function(){var a=new d;c.screenManager.pushScreen(a);return a};d.commands=[];d.addCommand=function(a){d.commands.push(a)};d.enableCustomizeUI=function(){d.commands.push({name:"customize ui",callback:function(a,b){c.screenManager.popScreen();app.types.Customizer.startup();return!0}})};d.prototype.myScreenActivate=function(){};d.prototype.myScreenDeactivate=function(){};
d.prototype.onWindowResize=function(){};d.prototype.makeButtons=function(a){var b=c.utils.copyObject(d.commands,!0);b.push({name:""});b.push({name:"close",callback:function(a,b){c.screenManager.popScreen();return!0}});for(var e=130,f=0;f<b.length;f++){var g=b[f];if(g.name&&""!==g.name){var k=ui.makeButtonAt(a,g.name,200,e,380);g.callback&&k.setCallback(g.callback);e+=100}else e+=50}return e-25};d.prototype.updateSelf=function(a){};d.prototype.drawSelfPost=function(a,b){};d.prototype.mouseDown=function(a,
b){return!1};d.prototype.handleKeyDown=function(a){return!1};app.types.ModMenu=d});
rat.modules.add("js.ui.help_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(){d.prototype.parentConstructor.call(this);this.onLine=0;this.setSize(1024<.8*app.config.IDEAL_W?1024:.8*app.config.IDEAL_W,768);this.centerInDisplay();this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(c.string.getString("STR_HELP_TITLE")));this.titleBox.enableDefaultSpecialFormatting();
this.bodyText=ui.makeText(this,"",0,this.size.y/2);this.bodyText.setSize(this.size.x-128,this.size.y-32);this.bodyText.setPos(64,32);this.bodyText.setAutoWrap(!0);this.bodyText.centerText();this.bodyText.enableDefaultSpecialFormatting();this.makeButtons(this);this.setModal(!0);this.setAllowClickAway(!0);this.setAllowBackClose(!0);c.screenManager.pushScreen(this);this.languageUpdated()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.makeButtons=function(a){var b=this,e=a.size.x/2,f=a.size.y-ui.config.buttonHeight/
2-16;"mobile"!==app.platform&&(f-=30);var d=c.string.getString("STR_HELP_CLOSE");d=ui.makeText(this,d,16,f,a.size.x-32,ui.config.buttonHeight);d.setAlignment("right");d.enableDefaultSpecialFormatting();d.setVisible(!1);this.closePrompt=d;!0===game.hud.useButtonIcons&&d.setVisible(!0);"xbox"!==app.platform&&(a=ui.makeButtonAt(a,c.string.getString("STR_MENU_EXIT"),e,f+16),ui.applyTooltip(a,c.string.getString("STR_MENU_EXIT_TOOLTIP")),a.setCallback(function(){b.close()}),this.closeButton=a,!0===game.hud.useButtonIcons&&
(a.setVisible(!1),a.setEnabled(!1)))};d.prototype.getLines=function(a){var b="";a>this.helpLines.length-1&&(console.warn("help_screen told to to get up to entry "+a+" in helpLines when the last entry in helpLine is index "+(this.helpLines.length-1)),a=this.helpLines.length-1);for(i=0;i<=a;i++)b+=this.helpLines[i],b+="\n\n";a!==this.helpLines.length-1&&(b+=this.continueMessage);return b};d.prototype.trigger=function(a){this.onLine<this.helpLines.length-1&&this.onLine++;this.bodyText.setTextValue(ui.formatText(this.getLines(this.onLine)))};
d.prototype.close=function(){c.screenManager.popScreen(self)};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"help screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"help screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay()};d.prototype.updateSelf=function(a){a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=
function(){!0===game.hud.useButtonIcons?"web"===app.platform&&(this.continueMessage=this.platformContinueMessage.xbox,this.bodyText.setTextValue(ui.formatText(this.getLines(this.onLine))),this.closePrompt.setVisible(!0),this.closeButton.setVisible(!1),this.closeButton.setEnabled(!1)):"web"===app.platform&&(this.continueMessage=this.platformContinueMessage.pc,this.bodyText.setTextValue(ui.formatText(this.getLines(this.onLine))),this.closePrompt.setVisible(!1),this.closeButton.setVisible(!0),this.closeButton.setEnabled(!0))};
d.prototype.mouseDown=function(a,b){d.prototype.parentPrototype.mouseDown.call(this,a,b);return!1};d.prototype.handleKeyDown=function(a){return!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_A:return this.trigger(),!0;case c.input.BUTTON_B:case c.input.BUTTON_SELECT:return null!=this.closeButton?this.closeButton.trigger():this.close(),!0}return!1};d.prototype.languageUpdated=function(){this.titleBox.setTextValue(c.string.getString("STR_HELP_TITLE"));
null!=this.closeButton&&(this.closeButton.setTextValue(c.string.getString("STR_MENU_EXIT")),ui.applyTooltip(this.closeButton,c.string.getString("STR_MENU_EXIT_TOOLTIP")));this.platformHelpLines={pc:[c.string.getString("STR_HELP_1_PC"),c.string.getString("STR_HELP_2"),c.string.getString("STR_HELP_3"),c.string.getString("STR_HELP_4"),c.string.getString("STR_HELP_5"),c.string.getString("STR_HELP_6")],mobile:[c.string.getString("STR_HELP_1_MOBILE"),c.string.getString("STR_HELP_2"),c.string.getString("STR_HELP_3"),
c.string.getString("STR_HELP_4"),c.string.getString("STR_HELP_5"),c.string.getString("STR_HELP_6")],xbox:[c.string.getString("STR_HELP_1_XBOX"),c.string.getString("STR_HELP_2"),c.string.getString("STR_HELP_3"),c.string.getString("STR_HELP_4"),c.string.getString("STR_HELP_5"),c.string.getString("STR_HELP_6")]};this.helpLines=this.platformHelpLines.pc;"mobile"===app.platform?this.helpLines=this.platformHelpLines.mobile:"xbox"===app.platform&&(this.helpLines=this.platformHelpLines.xbox);this.platformContinueMessage=
{pc:c.string.getString("STR_HELP_MORE_PC"),mobile:c.string.getString("STR_HELP_MORE_MOBILE"),xbox:c.string.getString("STR_HELP_MORE_XBOX")};this.continueMessage=this.platformContinueMessage.pc;!0===game.hud.useButtonIcons&&(this.continueMessage=this.platformContinueMessage.xbox);"mobile"===app.platform?this.continueMessage=this.platformContinueMessage.mobile:"xbox"===app.platform&&(this.continueMessage=this.platformContinueMessage.xbox);this.bodyText.setTextValue(ui.formatText(this.getLines(this.onLine)));
this.titleBox.setTextValue(ui.formatText(c.string.getString("STR_HELP_TITLE")))};d.open=function(){this.screen?c.screenManager.pushScreen(this.screen):this.screen=new d};d.languageUpdated=function(){this.screen&&this.screen.languageUpdated()};window.ui.HelpScreen=d});
rat.modules.add("js.ui.settings_menu",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"js.ui.keyword_screen","js.ui.mod_permission_screen","rat.utils.r_string","rat.ui.r_ui_droplist",{name:"js.app",processBefore:!0},"js.ui.toggle_control","js.ui.settings_sub_menu"],function(c){var d=function(){d.prototype.parentConstructor.call(this);var a=c.string.getString("STR_SETTINGS_TITLE");app.isOwner()?a=c.string.getString("STR_OWNER_SETTINGS_TITLE"):app.isModAny()&&(a=c.string.getString("STR_MOD_SETTINGS_TITLE"));
this.setSize(984,980);this.centerInDisplay();this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);"xbox"===app.platform&&this.setAllowBackClose(!0);this.setAllowClickAway(!0);this.makeButtons();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=function(){c.screenManager.removeScreen(this)};d.prototype.gotDisplayState=function(a){null!=
this.uiToggle&&this.uiToggle.updateDisplay("show"===a);"hide"===a&&!1===app.isModConfig()?this.setVisible(!1):!1===this.isVisible()&&this.setVisible(!0)};d.controls={audioToggle:{control:function(a){return this.button=a=ui.makeToggleButtonAt(a,c.string.getString("STR_SETTINGS_AUDIO"),0,0,{callback:window.ui.SettingsMenu.toggleAudio,param:app.settings.soundOn},app.settings.soundOn,"STR_SETTING_AUDIO_TOOLTIP")},view:"all"},actionLogToggle:{control:function(a){return this.button=a=ui.makeToggleButtonAt(a,
c.string.getString("STR_SETTINGS_ACTIONLOG"),0,0,{callback:window.ui.SettingsMenu.toggleElementVisibility,param:game.hud.actionLogPanel},game.hud.actionLogPanel.isVisible(),"STR_SETTING_ACTIONLOG_TOOLTIP")},view:"owner"},giveCreditsToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_GIVE_CURRENCY_UI"),0,0,{callback:window.ui.SettingsMenu.toggleElementVisibility,param:game.hud.giveCreditsPanel},game.hud.giveCreditsPanel.isVisible(),"STR_GIVE_CURRENCY_UI_TOOLTIP")},view:"modEdit"},
modViewToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_MOD_VIEW"),0,0,{callback:window.ui.SettingsMenu.toggleModView,param:a},app.settings.modView,"STR_MOD_VIEW_TOOLTIP")},view:"all"},roundControlsToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_ROUND_CONTROLS"),0,0,{callback:window.ui.SettingsMenu.toggleElementVisibility,param:game.hud.roundControlPanel},game.hud.roundControlPanel.isVisible(),"STR_ROUND_CONTROLS_TOOLTIP")},view:"modEdit"},
statsBarToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_STATS_BAR"),0,0,{callback:window.ui.SettingsMenu.toggleElementVisibility,param:game.hud.statBarPanel},game.hud.statBarPanel.isVisible(),"STR_STATS_BAR_TOOLTIP")},view:"modAny"},creditsSourceToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_CREDITS_SOURCE"),0,0,{callback:window.ui.SettingsMenu.toggleElementVisibility,param:game.hud.creditSourcePanel},game.hud.creditSourcePanel.isVisible(),
"STR_CREDITS_SOURCE_TOOLTIP")},view:"modConfig"},watchForToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_ALLOW_AUTOFEED"),0,0,{callback:window.ui.SettingsMenu.toggleWatchFor,param:app.settings.watchFor&&app.settings.watchFor.enabled},app.settings.watchFor&&app.settings.watchFor.enabled,"STR_ALLOW_AUTOFEED_TOOLTIP")},view:"owner"},enableBotToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_ENABLE_BOT"),0,0,{callback:window.ui.SettingsMenu.toggleChatBot,
param:app.settings.chatBot.active},app.settings.chatBot.active,"STR_ENABLE_BOT_TOOLTIP")},view:"modConfig"},BotRoundStartToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_BOT_ROUND_START"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"newRound"},app.settings.chatBot.settings.newRound,"STR_BOT_ROUND_START_TOOLTIP")},view:"modConfig"},BotRoundEndToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_BOT_ROUND_END"),0,0,
{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"endRound"},app.settings.chatBot.settings.endRound,"STR_BOT_ROUND_END_TOOLTIP")},view:"modConfig"},BotNewOfferToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_BOT_NEW_OFFER"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"newOffer"},app.settings.chatBot.settings.newOffer,"STR_BOT_NEW_OFFER_TOOLTIP")},view:"modConfig"},BotResolveOfferToggle:{control:function(a){return ui.makeToggleButtonAt(a,
c.string.getString("STR_BOT_RESOLVE_OFFER"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"resolution"},app.settings.chatBot.settings.resolution,"STR_BOT_RESOLVE_OFFER_TOOLTIP")},view:"modConfig"},BotReminderToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_BOT_REMINDER"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"reminder"},app.settings.chatBot.settings.reminder,"STR_BOT_REMINDER_TOOLTIP")},view:"modConfig"},enableCurrencyAwardsToggle:{control:function(a){return ui.makeToggleButtonAt(a,
c.string.getString("STR_AWARD_CURRENCY"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"awardCurrencyToWinners"},app.settings.chatBot.settings.awardCurrencyToWinners,"STR_AWARD_CURRENCY_TOOLTIP")},view:"modConfig"},whisperAwardToBotToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_WHISPER_AWARD"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"whisperAwardToBot"},app.settings.chatBot.settings.whisperAwardToBot,"STR_WHISPER_AWARD_TOOLTIP")},
view:"modConfig"},channelCurrencyBotName:{control:function(a){return ui.makeTextSettingBox(a,c.string.getString("STR_CURRENCY_BOT_NAME"),{setting:app.settings.chatBot.settings.channelCurrencyBot,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"channelCurrencyBot",tooltip:c.string.getString("STR_CURRENCY_BOT_NAME_TOOLTIP")})},view:"modConfig"},channelCurrencyBotCommand:{control:function(a){var b=app.settings.chatBot.active?"":c.string.getString("STR_CHAT_BOT_DISABLED"),
e=app.settings.chatBot.active;a=ui.makeTextSettingBox(a,c.string.getString("STR_GIVE_CURRENCY_COMMAND")+" "+b,{setting:app.settings.chatBot.settings.channelCurrencyCommand,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"channelCurrencyCommand",tooltip:c.string.getString("STR_GIVE_CURRENCY_COMMAND_TOOLTIP")});a.setValid(e);return a},view:"modConfig"},channelCurrencyAwardFirst:{control:function(a){return ui.makeTextSettingBox(a,c.string.getString("STR_CURRENCY_AWARD_1_AMOUNT"),
{setting:app.settings.chatBot.settings.channelCurrencyAwardFirst,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"channelCurrencyAwardFirst",tooltip:c.string.getString("STR_CURRENCY_AWARD_1_AMOUNT_TOOLTIP")})},view:"modConfig"},channelCurrencyWinnerRequireValidation:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_WINNER_VALIDATION"),0,0,{callback:window.ui.SettingsMenu.toggleChatBotSetting,param:"requireWinnerValidation"},
app.settings.chatBot.settings.requireWinnerValidation,"STR_WINNER_VALIDATION_TOOLTIP")},view:"modConfig"},playerActionButtonType:{control:function(a){var b=app.settings.playerActionButtons[a.buttonIndex].type,e=0,d=["standard","space"];for(i=0;i<d.length;i++)d[i]===b&&(e=i);var g=new c.ui.Element(a);g.setBounds(0,0,ui.config.menuButtonWidth,ui.config.menuButtonHeight);var k=new c.ui.DropList(g);k.setBounds(12,8,ui.config.TOGGLE_CONTROL_W-24,ui.config.menuButtonHeight);k.buildFromListText(d,{fontHeight:40,
selectCallback:function(b){b=d[b];app.settings.playerActionButtons[a.buttonIndex].type=b;peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:"type",value:b});a.exitButton.callback();window.ui.CustomizePlayerActionButton.open(a.title,a.buttonIndex,a.offset)},listShowCallback:function(a,b,c){ui.setDropButtonState(l,b?"open":closed)},listColorStates:ui.pullDownColorStates});k.setCurrentItem(e);ui.applyTooltip(k,c.string.getString("STR_SELECT_BUTTON_TYPE_TOOLTIP"));setTimeout(function(){a.moveSubElementToFront(g);
k.setCurrentItem(e)},1);b=ui.config.TOGGLE_CONTROL_W;var h=ui.config.menuButtonHeight,l=ui.makeDropButtonAt(g,"",0,0,b,h);l.setBounds(0,12,b,h);ui.setStandardButtonProperties(l);ui.setDropButtonState(l,"closed");k.replaceButton(l);l.getTextBox().setWidth(b-60);return g},view:"modConfig"},playerActionInUI:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_SHOW_IN_UI"),0,0,{callback:window.ui.SettingsMenu.toggleSparkButtonSetting,param:{settingName:"inUI",buttonIndex:a.buttonIndex}},
app.settings.playerActionButtons[a.buttonIndex].inUI,"STR_SHOW_IN_UI_TOOLTIP")},view:"modConfig"},playerActionSparkSpendEffectToggle:{control:function(a){var b=a.buttonIndex;return ui.makeToggleButtonAt(a,c.string.getString("STR_SPARK_SPEND_EFFECT_TOGGLE"),0,0,{callback:window.ui.SettingsMenu.toggleSparkButtonSetting,param:{settingName:"sparkSpendEffect",buttonIndex:b}},app.settings.playerActionButtons[b].sparkSpendEffect,"STR_SPARK_SPEND_EFFECT_TOGGLE_TOOLTIP")},view:"modConfig"},playerActionButtonText:{control:function(a){var b=
a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_BUTTON_TEXT"),{setting:app.settings.playerActionButtons[b].label,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"label",tooltip:c.string.getString("STR_BUTTON_LABEL_TOOLTIP")},"doubleWide")},view:"modConfig"},playerActionButtonTooltip:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_BUTTON_TOOLTIP"),
{setting:app.settings.playerActionButtons[b].toolTip,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"toolTip",tooltip:c.string.getString("STR_BUTTON_TOOLTIP_TOOLTIP")},"doubleWide")},view:"modConfig"},playerActionButtonCost:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_SPARK_COST"),{setting:app.settings.playerActionButtons[b].sparkCost,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,
settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"sparkCost",tooltip:c.string.getString("STR_SPARK_COST_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},playerActionButtonIcon:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_BUTTON_ICON"),{setting:app.settings.playerActionButtons[b].icon,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,
settingName:"icon",tooltip:c.string.getString("STR_BUTTON_ICON_TOOLTIP")},"single")},view:"modConfig"},playerActionChatMessage:{control:function(a){var b=a.buttonIndex,e=app.settings.chatBot.active,d=app.settings.chatBot.active?"":c.string.getString("STR_CHAT_BOT_DISABLED");a=ui.makeTextSettingBox(a,c.string.getString("STR_CHAT_MESSAGE")+" "+d,{setting:app.settings.playerActionButtons[b].chatMessage,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,
value:a.setting})},buttonIndex:b,settingName:"chatMessage",tooltip:c.string.getString("STR_CHAT_MESSAGE_TOOLTIP")},"doubleWide");a.setValid(e);return a},view:"modConfig"},playerActionButtonCommand:{control:function(a){var b=ui.makeButtonAt(a,c.string.getString("STR_BUTTON_COMMAND"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(b,c.string.getString("STR_BUTTON_COMMAND_TOOLTIP"));b.setCallback(function(){var b=c.string.getString("STR_EDIT_BUTTON_COMMAND");window.ui.CustomizePlayerActionCommand.open(b,
a.buttonIndex,{x:8,y:8});return!0});return b},view:"modConfig"},playerActionButtonCooldown:{control:function(a){var b=ui.makeButtonAt(a,c.string.getString("STR_BUTTON_COOLDOWN"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(b,c.string.getString("STR_BUTTON_COOLDOWN_TOOLTIP"));b.setCallback(function(){var b=c.string.getString("STR_EDIT_BUTTON_COOLDOWN");window.ui.CustomizePlayerActionCooldown.open(b,a.buttonIndex,{x:8,y:8});return!0});return b},view:"modConfig"},whisperActionCommandToggle:{control:function(a){var b=
a.buttonIndex;return ui.makeToggleButtonAt(a,c.string.getString("STR_WHISPER_COMMAND"),0,0,{callback:window.ui.SettingsMenu.toggleSparkButtonSetting,param:{settingName:"whisperCommand",buttonIndex:a.buttonIndex}},app.settings.playerActionButtons[b].whisperCommand,"STR_WHISPER_COMMAND_TOOLTIP")},view:"modConfig"},whisperActionCommandTarget:{control:function(a){var b=a.buttonIndex;""!==app.settings.playerActionButtons[b].commandTarget&&void 0!==app.settings.playerActionButtons[b].commandTarget||!app.settings.chatBot.settings.channelCurrencyBot||
(app.settings.playerActionButtons[b].commandTarget=app.settings.chatBot.settings.channelCurrencyBot,peSync.sendSparkButtonSetting({buttonIndex:b,settingName:"commandTarget",value:app.settings.playerActionButtons[b].commandTarget}));return ui.makeTextSettingBox(a,c.string.getString("STR_WHISPER_COMMAND_TARGET"),{setting:app.settings.playerActionButtons[b].commandTarget,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,
settingName:"commandTarget",tooltip:c.string.getString("STR_WHISPER_COMMAND_TARGET_TOOLTIP")},"regular")},view:"modConfig"},actionCommand:{control:function(a){var b=a.buttonIndex,e=app.settings.chatBot.active,d=app.settings.chatBot.active?"":c.string.getString("STR_CHAT_BOT_DISABLED");a=ui.makeTextSettingBox(a,c.string.getString("STR_BUTTON_COMMAND_STRING")+" "+d,{setting:app.settings.playerActionButtons[b].buttonCommand,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,
settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"buttonCommand",tooltip:c.string.getString("STR_BUTTON_COMMAND_STRING_TOOLTIP")},"doubleWide");a.setValid(e);return a},view:"modConfig"},actionCommandDelay:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_BUTTON_COMMAND_DELAY_STRING"),{setting:app.settings.playerActionButtons[b].buttonCommandDelay,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,
value:a.setting})},buttonIndex:b,settingName:"buttonCommandDelay",tooltip:c.string.getString("STR_BUTTON_COMMAND_DELAY_STRING_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},actionRequiredUserCount:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_REQUIRED_USER_COUNT"),{setting:app.settings.playerActionButtons[b].requiredUserCount,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},
buttonIndex:b,settingName:"requiredUserCount",tooltip:c.string.getString("STR_REQUIRED_USER_COUNT_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},actionRequiredUserTimer:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_REQUIRED_USER_TIMER"),{setting:app.settings.playerActionButtons[b].requiredUserTimer,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"requiredUserTimer",
tooltip:c.string.getString("STR_REQUIRED_USER_TIMER_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},playerActionCooldownGlobalToggle:{control:function(a){var b=a.buttonIndex;return ui.makeToggleButtonAt(a,c.string.getString("STR_GLOBAL_COOLDOWN_TOGGLE"),0,0,{callback:window.ui.SettingsMenu.toggleSparkButtonSetting,param:{settingName:"globalCooldownToggle",buttonIndex:a.buttonIndex}},app.settings.playerActionButtons[b].globalCooldownToggle,"STR_GLOBAL_COOLDOWN_TOGGLE_TOOLTIP")},view:"modConfig"},
playerActionCooldownValue:{control:function(a){var b=a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_COOLDOWN_VALUE"),{setting:app.settings.playerActionButtons[b].cooldownValue,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"cooldownValue",tooltip:c.string.getString("STR_COOLDOWN_VALUE_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},playerActionGlobalCooldownValue:{control:function(a){return app.settings.playerActionButtons[a.buttonIndex].globalCooldownToggle?
ui.makeTextSettingBox(a,c.string.getString("STR_GLOBAL_COOLDOWN_VALUE"),{setting:app.settings.playerActionButtonGlobalCooldownValue,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:null,settingName:"playerActionButtonGlobalCooldownValue",tooltip:c.string.getString("STR_GLOBAL_COOLDOWN_VALUE_TOOLTIP"),numberOnly:!0},"regular"):new c.ui.Element(a)},view:"modConfig"},playerActionUserCooldownValue:{control:function(a){var b=
a.buttonIndex;return ui.makeTextSettingBox(a,c.string.getString("STR_USER_COOLDOWN_VALUE"),{setting:app.settings.playerActionButtons[b].userCooldownValue,callback:function(a){peSync.sendSparkButtonSetting({buttonIndex:a.buttonIndex,settingName:a.settingName,value:a.setting})},buttonIndex:b,settingName:"userCooldownValue",tooltip:c.string.getString("STR_USER_COOLDOWN_VALUE_TOOLTIP"),numberOnly:!0},"regular")},view:"modConfig"},editKeywordsButton:{control:function(a){var b=ui.config.TOGGLE_CONTROL_W;
a=ui.makeButtonAt(a,c.string.getString("STR_KEYWORDS"),0,0,b,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_VIEW_KEYWORDS_TOOLTIP"));a.setCallback(function(a,b){ui.KeywordScreen.make();return!0});return a},view:"modAny"},autoFeedTestToggle:{control:function(a){return app.isIntegratedMode()?ui.makeToggleButtonAt(a,"Test AutoFeed",0,0,{callback:window.ui.SettingsMenu.toggleAutoFeed,param:"test"},app.settings.autoFeeds.test&&app.settings.autoFeeds.test.enabled):!1},view:"owner"},
uiToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_PARTICIPANT_UI"),0,0,{callback:toggleUI=function(){if("show"===peSync.knownGlobalState.displayState)return peSync.sendMessageWithCode("set_display_state",{state:"hide"}),!1;peSync.sendMessageWithCode("set_display_state",{state:"show"});return!0}},"show"===peSync.knownGlobalState.displayState,"STR_PARTICIPANT_UI_TOOLTIP")},view:"modConfig"},personalDataToggle:{control:function(a){return ui.makeToggleButtonAt(a,c.string.getString("STR_SAVE_PLAYER_INFO"),
0,0,{callback:toggle=function(){if(peSync.integratedSync&&!0===peSync.integratedSync.savePlayerData)return peSync.sendMessageWithCode("set_save_data",{state:!1}),!1;peSync.sendMessageWithCode("set_save_data",{state:!0});return!0}},peSync.integratedSync?!0===peSync.integratedSync.savePlayerData:!1,"STR_SAVE_PLAYER_INFO_TOOLTIP")},view:"owner"},blankSpace:{control:function(a){a=new c.ui.Element(a);a.setSize(ui.config.menuButtonWidth,ui.config.menuButtonHeight);return a},view:"all"},giveCreditChatPreview:{control:function(a){var b=
new c.ui.Element(a);b.setSize(2.75*ui.config.menuButtonWidth,ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=function(){var a=c.string.getString("STR_CRED_CHAT_BOT_PREVIEW");a+="\n";app.settings.chatBot.settings.whisperAwardToBot&&(a+="/whisper @"+app.settings.chatBot.settings.channelCurrencyBot+" ");a+=app.settings.chatBot.settings.channelCurrencyCommand+" [winnerName] "+app.settings.chatBot.settings.channelCurrencyAwardFirst;b.textDisplay.setTextValue(a)};
return b},view:"all"},giveCreditsStaticInformationText:{control:function(a){a=new c.ui.Element(a);a.setSize(2*ui.config.menuButtonWidth,ui.config.menuButtonHeight);a.textDisplay=ui.makeText(a,"",0,0,a.size.x,a.size.y)},view:"all"},permButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_MOD_PERMISSIONS"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_MOD_PERMISSIONS_TOOLTIP"));a.setCallback(function(){ui.ModPermissionScreen.make();
return!0});return a},view:"owner"},customizePlayerActionButtonsButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_CUSTOMIZE_SPARK_BUTTONS"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_CUSTOMIZE_SPARK_BUTTONS_TOOLTIP"));a.setCallback(function(){window.ui.CustomizePlayerActionMenu.open();return!0});return a},view:"modConfig"},customizeButton:{control:function(a){return"xbox"!==app.platform?(this.button=a=ui.makeButtonAt(a,
c.string.getString("STR_SETTINGS_CUSTOMIZEUI"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight),ui.applyTooltip(a,c.string.getString("STR_SETTINGS_CUSTOMIZEUI_TOOLTIP")),a.setCallback(function(a,e){c.screenManager.popScreen();app.types.Customizer.startup();return!0}),a):!1},view:"modAny"},botSettingsButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_BOT_SETTINGS_BUTTON"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_BOT_SETTINGS_TOOLTIP"));
a.setCallback(function(){window.ui.SettingsSubMenu.open(c.string.getString("STR_CHAT_BOT_SETTINGS"),[ui.SettingsMenu.controls.enableBotToggle,ui.SettingsMenu.controls.chatbotIcon,ui.SettingsMenu.controls.BotRoundStartToggle,ui.SettingsMenu.controls.BotRoundEndToggle,ui.SettingsMenu.controls.BotNewOfferToggle,ui.SettingsMenu.controls.BotResolveOfferToggle,ui.SettingsMenu.controls.channelCurrencySettingsButton,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.BotReminderToggle,ui.SettingsMenu.controls.chatBotReminderInterval,
ui.SettingsMenu.controls.chatBotMessagePart1,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.chatBotMessagePart2,ui.SettingsMenu.controls.blankSpace],{x:64,y:-24})});return a},view:"modConfig"},autoFeedSettingsButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_AUTOFEED_SETTINGS"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_AUTOFEED_SETTINGS_TOOLTIP"));a.setCallback(function(){window.ui.SettingsSubMenu.open(c.string.getString("STR_AUTOFEED_SETTINGS"),
[ui.SettingsMenu.controls.watchForToggle,ui.SettingsMenu.controls.autoFeedTestToggle,ui.SettingsMenu.controls.autofeedAccuracyStats])});return a},view:"owner"},autofeedAccuracyStats:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_AUTOFEED_ACCURACY_BUTTON"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_AUTOFEED_ACCURACY_BUTTON_TOOLTIP"));a.setCallback(function(){window.ui.SettingsSubMenu.open(c.string.getString("STR_AUTOFEED_ACCURACY"),
[ui.SettingsMenu.controls.autofeedAccuracyIntro,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.autofeedElimAccuracy,ui.SettingsMenu.controls.autofeedPlayersAliveAccuracy,ui.SettingsMenu.controls.autofeedCleanStart,ui.SettingsMenu.controls.autofeedCleanEnd])});return a},view:"owner"},autofeedAccuracyIntro:{control:function(a){var b=new c.ui.Element(a);b.setSize(2*ui.config.TOGGLE_CONTROL_W+96,ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=
function(){b.textDisplay.setTextValue("An accuracy value is assigned to your channel by looking at how well information was collected\nduring the last ten games played on your channel. If your are having poor accuracy, the values\nbelow may help find a solution.")};return b},view:"all"},autofeedElimAccuracy:{control:function(a){var b=new c.ui.Element(a);b.setSize(ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=function(){var a=
getAutofeedSetting("KillsAccuracy");isNaN(a)||null===a||(a=a.toFixed(3));b.textDisplay.setTextValue("PlayersElimAccuracy: "+a+"\nAnything above 0.8 is a good value.")};return b},view:"all"},autofeedPlayersAliveAccuracy:{control:function(a){var b=new c.ui.Element(a);b.setSize(ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=function(){var a=getAutofeedSetting("PlayersAliveAccuracy");isNaN(a)||null===a||(a=a.toFixed(3));b.textDisplay.setTextValue("PlayersAliveAccuracy: "+
a+"\nanything above 0.7 is a good value.")};return b},view:"all"},autofeedCleanStart:{control:function(a){var b=new c.ui.Element(a);b.setSize(ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=function(){var a="Last Game Clean Start: "+getAutofeedSetting("CleanStart");b.textDisplay.setTextValue(a+"\nSaw the flying icon last game.")};return b},view:"all"},autofeedCleanEnd:{control:function(a){var b=new c.ui.Element(a);b.setSize(ui.config.TOGGLE_CONTROL_W,
ui.config.menuButtonHeight);b.textDisplay=ui.makeText(b,"",0,0,b.size.x,b.size.y);b.updateSelf=function(){var a="Last Game Clean End: "+getAutofeedSetting("CleanEnd");b.textDisplay.setTextValue(a+"\nSaw the game over screen last game.")};return b},view:"all"},hideShowUIButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_SHOW_HIDE_UI"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_SHOW_HIDE_UI_TOOLTIP"));a.setCallback(function(){window.ui.SettingsSubMenu.open(c.string.getString("STR_SHOW_HIDE_UI"),
[ui.SettingsMenu.controls.actionLogToggle,ui.SettingsMenu.controls.giveCreditsToggle,ui.SettingsMenu.controls.roundControlsToggle,ui.SettingsMenu.controls.statsBarToggle,ui.SettingsMenu.controls.creditsSourceToggle])});return a},view:"modAny"},channelCurrencySettingsButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_CHANNEL_CURRENCY_INTEGRATION"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_CHANNEL_CURRENCY_INTEGRATION_TOOLTIP"));
a.setCallback(function(){window.ui.SettingsSubMenu.open(c.string.getString("STR_CHANNEL_CURRENCY_SETTINGS"),[ui.SettingsMenu.controls.enableCurrencyAwardsToggle,ui.SettingsMenu.controls.channelCurrencyBotCommand,ui.SettingsMenu.controls.whisperAwardToBotToggle,ui.SettingsMenu.controls.channelCurrencyBotName,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.channelCurrencyAwardFirst,ui.SettingsMenu.controls.giveCreditChatPreview],{x:10,y:10})});return a},view:"modConfig"},chatbotIcon:{control:function(a){return ui.makeTextSettingBox(a,
c.string.getString("STR_CHAT_BOT_ICON"),{setting:app.settings.chatBot.settings.chatBotIdentifier,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"chatBotIdentifier",tooltip:c.string.getString("STR_CHAT_BOT_ICON_TOOLTIP")},"single")},view:"modConfig"},chatBotReminderInterval:{control:function(a){return textEntry=ui.makeTextSettingBox(a,c.string.getString("STR_CHAT_BOT_REMINDER_INTERVAL"),{setting:app.settings.chatBot.settings.reminderInterval,
callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"reminderInterval",tooltip:c.string.getString("STR_CHAT_BOT_REMINDER_INTERVAL_TOOLTIP")},"time")},view:"modConfig"},chatBotMessagePart1:{control:function(a){return textEntry=ui.makeTextSettingBox(a,c.string.getString("STR_CHAT_BOT_REMINDER_PART_1"),{setting:app.settings.chatBot.settings.reminderMessagePt1,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},
settingName:"reminderMessagePt1",tooltip:c.string.getString("STR_CHAT_BOT_REMINDER_PART_1_TOOLTIP")},"doubleWide")},view:"modConfig"},chatBotMessagePart2:{control:function(a){return textEntry=ui.makeTextSettingBox(a,c.string.getString("STR_CHAT_BOT_REMINDER_PART_2"),{setting:app.settings.chatBot.settings.reminderMessagePt2,callback:function(a){peSync.sendChatBotSetting({settingName:a.settingName,value:a.setting})},settingName:"reminderMessagePt2",tooltip:c.string.getString("STR_CHAT_BOT_REMINDER_PART_2_TOOLTIP")},
"doubleWide")},view:"modConfig"},feedbackButton:{control:function(a){a=ui.makeButtonAt(a,c.string.getString("STR_FEEDBACK"),0,0,ui.config.TOGGLE_CONTROL_W,ui.config.menuButtonHeight);ui.applyTooltip(a,c.string.getString("STR_FEEDBACK_TOOLTIP"));a.setCallback(function(){app.openFeedback()});return a},view:"all"}};getAutofeedSetting=function(a){var b=null,c=(gameState=peSync.knownAutoFeedState)?Object.keys(gameState):null;if(gameState&&void 0!==gameState[c[0]])void 0!==gameState[c[0]].state&&(b=gameState[c[0]].state);
else return"no gamefeed";return b&&void 0!==b[a]?b[a]:"not available"};d.prototype.makeButtons=function(){var a=this,b=app.isModAny()?ui.SettingsMenu.controls.hideShowUIButton:ui.SettingsMenu.controls.actionLogToggle,e=[];!0===peSync.isOriginallyMod()&&e.push(ui.SettingsMenu.controls.modViewToggle);e.push(ui.SettingsMenu.controls.audioToggle,b,ui.SettingsMenu.controls.permButton,ui.SettingsMenu.controls.customizeButton,ui.SettingsMenu.controls.uiToggle,ui.SettingsMenu.controls.autoFeedSettingsButton,
ui.SettingsMenu.controls.editKeywordsButton,ui.SettingsMenu.controls.botSettingsButton,ui.SettingsMenu.controls.customizePlayerActionButtonsButton);"web"===app.platform&&e.push(ui.SettingsMenu.controls.feedbackButton);!0===app.isIntegratedMode()&&e.push(ui.SettingsMenu.controls.personalDataToggle);d.addControls(e,this);"mobile"===app.platform&&(b=new c.ui.makeCheapButton(null,new c.graphics.Color(1,1,1,0)),this.appendSubElement(b),e=this.getWidth(),b.setPos(e-50,0),b.setSize(50,50),b.setCallback(function(a,
b){c.console.activate(!c.console.state.consoleActive)}));b=c.string.getString("STR_HELP_CLOSE");b=ui.makeText(this,b,16,this.size.y-ui.config.buttonHeight,this.size.x-32,ui.config.buttonHeight);b.setAlignment("right");b.enableDefaultSpecialFormatting();b.setVisible(!1);this.closePrompt=b;!0===game.hud.useButtonIcons&&b.setVisible(!0);"xbox"!==app.platform&&(b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),this.size.x/2,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight),
ui.applyTooltip(b,c.string.getString("STR_MENU_EXIT_TOOLTIP")),b.setCallback(function(){a.controlArray.forEach(function(a){"function"===typeof a.paneAutoSaveContentOnExit&&a.paneAutoSaveContentOnExit()});a.closeScreen()}),this.exitButton=b);this.autoBuildInputMap(!0,!0,2,4);d.setDefaultTarget(this,this.controlArray);this.inputMap.navigateSound="navigate"};d.setDefaultTarget=function(a,b){"xbox"===app.platform&&(b=b[0],"function"===typeof b.getTargetObject&&(b=b.getTargetObject()),a.setCurrentTarget(b))};
d.addControls=function(a,b){for(var c=128,d=b.size.x/4+16-ui.config.TOGGLE_CONTROL_W/2,g=b.size.x-b.size.x/4-16-ui.config.TOGGLE_CONTROL_W/2,k=d,h=[],l=0;l<a.length;l++)if(void 0===a[l])console.error("An invalid control was passed to SettingsMenu.addControls() in index "+l);else if(void 0===a[l].control||void 0===a[l].view)console.error("A control passed to SettingsMenu.addControls() contained an undefined control or view");else if("modConfig"!==a[l].view||app.isModConfig())if("modEdit"!==a[l].view||
app.isModEdit())if("modAny"!==a[l].view||app.isModAny())if("owner"!==a[l].view||app.isOwner()){getNewRowY=function(a){a=void 0===a?ui.config.TOGGLE_MARGIN:a;return c=c+ui.config.TOGGLE_CONTROL_H+a};var m=a[l].control(b);m&&(h.push(m),h[h.length-1].setPos(k,c),k===d?k=g:(k=d,getNewRowY()))}b.controlArray=h;b.setSize(b.size.x,(ui.config.TOGGLE_CONTROL_H+ui.config.TOGGLE_MARGIN)*Math.ceil(h.length/2)+256+("xbox"===app.platform?-64:0));b.backgroundBox.fitToParentSize();b.centerInDisplay();b.offset&&b.setPos(b.getPosX()+
b.offset.x,b.getPosY()+b.offset.y);for(i=0;i<h.length;i++)h[i].updatePos&&h[i].updatePos()};d.toggleAudio=function(a){app.settings.soundOn=!app.settings.soundOn;audio.updateFromSettings();app.writeSettings();peSync.sendSettingsReport();return app.settings.soundOn};d.toggleElementVisibility=function(a){a.setVisible(!a.isVisible());return a.isVisible()};d.toggleModView=function(a){app.settings.modView=!app.settings.modView;game.hud.gotModStatusChange();a.closeScreen();app.writeSettings();peSync.sendSettingsReport();
return app.settings.modView};d.toggleAutoFeed=function(a){var b=app.settings.autoFeeds[a];b||(b=app.settings.autoFeeds[a]={enabled:!1});b.enabled=!b.enabled;peSync.sendAutoFeedOptions(a,b);app.writeSettings();return b.enabled};d.toggleWatchFor=function(){var a=app.settings.watchFor;a||(a=app.settings.watchFor={enabled:!1});a.enabled=!a.enabled;peSync.sendAutoFeedToggle(a);app.writeSettings();return a.enabled};d.toggleChatBot=function(){app.settings.chatBot.active=!app.settings.chatBot.active;peSync.sendActivateChatBot(app.settings.chatBot.active);
app.writeSettings();return app.settings.chatBot.active};d.toggleChatBotSetting=function(a){var b=app.settings.chatBot.settings;b[a]=!b[a];peSync.sendChatBotSetting({settingName:a,value:b[a]});app.writeSettings();return b[a]};d.toggleSparkButtonSetting=function(a){settingName=a.settingName;buttonIndex=a.buttonIndex;a=app.settings.playerActionButtons[buttonIndex];a[settingName]=!a[settingName];peSync.sendSparkButtonSetting({buttonIndex:buttonIndex,settingName:settingName,value:a[settingName]});app.writeSettings();
return a[settingName]};d.toggleSparkBoard=function(){app.settings.sparkBoardActive=!app.settings.sparkBoardActive;peSync.sendActivateSparkBoard(app.settings.sparkBoardActive);return app.settings.sparkBoardActive};d.prototype.onRebuild=function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen deactivated.")};d.prototype.onWindowResize=
function(){this.centerInDisplay();this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(i=0;i<this.controlArray.length;i++)this.controlArray[i].updatePos&&(console.log("check passed"),this.controlArray[i].updatePos())};d.prototype.updateSelf=function(a){a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=function(){!0===game.hud.useButtonIcons?"web"===app.platform&&this.closePrompt.setVisible(!0):
"web"===app.platform&&this.closePrompt.setVisible(!1)};d.languageUpdated=function(){if(this.screen){var a=c.string.getString("STR_SETTINGS_TITLE");app.isOwner()?a=c.string.getString("STR_OWNER_SETTINGS_TITLE"):app.isModAny()&&(a=c.string.getString("STR_MOD_SETTINGS_TITLE"));this.screen.titleBox.setTextValue(a);this.screen.exitButton.setTextValue(c.string.getString("STR_MENU_EXIT"));ui.applyTooltip(this.screen.exitButton,c.string.getString("STR_MENU_EXIT_TOOLTIP"))}this.controls&&(this.controls.audioToggle&&
this.controls.audioToggle.button&&(this.controls.audioToggle.button.toggleButton.setTextValue(c.string.getString("STR_SETTINGS_AUDIO")),ui.applyTooltip(this.controls.audioToggle.button.toggleButton,c.string.getString("STR_SETTING_AUDIO_TOOLTIP"))),this.controls.actionLogToggle&&this.controls.actionLogToggle.button&&(this.controls.actionLogToggle.button.toggleButton.setTextValue(c.string.getString("STR_SETTINGS_ACTIONLOG")),ui.applyTooltip(this.controls.actionLogToggle.button.toggleButton,c.string.getString("STR_SETTING_ACTIONLOG_TOOLTIP"))),
this.controls.customizeButton&&this.controls.customizeButton.button&&(this.controls.customizeButton.button.setTextValue(c.string.getString("STR_SETTINGS_CUSTOMIZEUI")),ui.applyTooltip(this.controls.customizeButton.button,c.string.getString("STR_SETTINGS_CUSTOMIZEUI_TOOLTIP"))))};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;
switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.closeScreen(),!0}return!1};d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.open=function(){this.screen=new d};window.ui.SettingsMenu=d});
rat.modules.add("js.ui.exit_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string","js.app",{name:"js.ui.ui",processBefore:!0}],function(c){var d=2*ui.config.buttonWidth+128,a=function(b){this.mainScreenRef=b;a.prototype.parentConstructor.call(this);this.setSize(d,420);this.centerInDisplay();this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(c.string.getString("STR_EXIT_TITLE")));this.titleBox.enableDefaultSpecialFormatting();
this.bodyText=ui.makeText(this,ui.formatText(this.getMainTextString()),0,this.size.y/2);this.bodyText.setSize(this.size.x-128,this.size.y/2);this.bodyText.setPos(64,64);this.bodyText.setAutoWrap(!0);this.bodyText.centerText();this.bodyText.enableDefaultSpecialFormatting();this.makeClosePrompt(this);this.makeButtons(this);this.autoBuildInputMap();this.setCurrentTarget(this.closeButton);this.setModal(!0);app.xboxMixerPreventExit();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(a,c.ui.Screen);
a.prototype.myScreenActivate=function(){};a.prototype.myScreenDeactivate=function(){};a.prototype.onWindowResize=function(){this.setSize(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);this.black.setSize(c.graphics.SCREEN_WIDTH,c.graphics.SCREEN_HEIGHT);this.updateUIPos()};a.prototype.makeClosePrompt=function(a){var b=c.string.getString("STR_HELP_CLOSE");a=ui.makeText(a,b,16,a.size.y-ui.config.buttonHeight,a.size.x-32,ui.config.buttonHeight);a.setAlignment("right");a.enableDefaultSpecialFormatting()};
a.prototype.makeButtons=function(a){var b=this,d=ui.config.buttonWidth/1.5,g=a.size.y-(ui.config.buttonHeight+32),k=ui.makeButtonAt(a,c.string.getString("STR_ACTION_NO"),a.size.x-d,g);k.setCallback(function(){b.close()});this.closeButton=k;a=ui.makeButtonAt(a,c.string.getString("STR_ACTION_YES"),d,g);a.setCallback(function(){app.xboxMixerExitInteractive()});this.quitButton=a};a.prototype.getMainTextString=function(){return ui.formatText(c.string.getString("STR_QUIT_MESSAGE"))};a.prototype.updateUIPos=
function(){this.pane.setPos((this.size.x-this.pane.size.x)/2,(this.size.y-this.pane.size.y)/2);if(this.icon){var a=this.mainScreenRef.playerIcon.getGlobalPos();this.icon.setPos(a.x,a.y)}};a.prototype.close=function(){c.screenManager.popScreen(self)};a.prototype.updateSelf=function(a){};a.prototype.drawSelfPost=function(a,c){};a.prototype.mouseDown=function(a,c){return!1};a.prototype.handleKeyDown=function(a){return!1};a.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;
switch(a.which){case c.input.BUTTON_B:return this.closeButton.trigger(),!0}return!1};a.open=function(){new a};window.ui.ExitScreen=a});
rat.modules.add("js.ui.edit_reason_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(){d.prototype.parentConstructor.call(this);this.setSize(2*ui.config.buttonWidth+128,356);this.centerInDisplay();this.inputBoxes=[];this.inputIndex=0;this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(c.string.getString("STR_EDIT_REASON_TITLE")));
this.titleBox.enableDefaultSpecialFormatting();this.makeButtons(this);this.setModal(!0);this.setAllowClickAway(!0);c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.makeEditBox=function(a,b,e,d,g,k){k=k||"textarea";var f=this,l=this.editDiv;l||(l=this.editDiv=c.graphics.layerDiv.make(app.canvasElement));"textarea"===k?k=document.createElement(k):(k=document.createElement("input"),k.type="text");k.className="myInputBox";k.style.position="absolute";k.style.resize=
"none";k.style.display="block";var m=f.getGlobalPos(b,e);k.style.top=""+(m.y|0)+"px";k.style.left=""+(m.x|0)+"px";k.style.width=""+d+"px";k.style.height=""+g+"px";this.inputBoxes.push({element:k,rect:{x:b,y:e,w:d,h:g}});k.setAttribute("type","text");k.value=a;k.maxLength=32;k.wrap="off";k.addEventListener("keydown",function(a){37!==a.keyCode&&38!==a.keyCode&&39!==a.keyCode&&40!==a.keyCode||a.stopPropagation();9===a.keyCode&&a.preventDefault();13===a.keyCode&&(a.stopPropagation(),a.preventDefault(),
f.closeButton.press());27===a.keyCode&&(a.preventDefault(),f.cancelButton.press());191===a.keyCode&&a.stopPropagation()},!1);k.addEventListener("focus",function(a){a.target&&void 0!==a.target.inputIndex&&(f.inputIndex=a.target.inputIndex)},!1);l.appendChild(k);return k};d.prototype.makeButtons=function(a){var b=this,e=ui.config.buttonWidth/1.5,d=a.size.y-ui.config.buttonHeight,g=ui.makeButtonAt(a,c.string.getString("STR_DONE"),a.size.x-e,d);g.setCallback(function(){app.settings.reasonText=b.editBox.value;
app.writeSettings();game.hud.reasonText.setTextValue(b.editBox.value);b.close()});this.closeButton=g;a=ui.makeButtonAt(a,c.string.getString("STR_CANCEL"),e,d);a.setCallback(function(){b.close()});this.cancelButton=a};d.prototype.deleteEditBox=function(){this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null);this.inputBoxes=[]};d.prototype.destroy=function(){app.canvasElement.focus();this.deleteEditBox()};d.prototype.close=function(){this.deleteEditBox();c.screenManager.popScreen(self)};
d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"edit reason screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"edit reason screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(var a=0;a<this.inputBoxes.length;a++){var b=this.inputBoxes[a],e=this.getGlobalPos(b.rect.x,b.rect.y);b.element.style.top=""+(e.y|0)+"px";
b.element.style.left=""+(e.x|0)+"px";b.element.style.width=""+b.rect.w+"px";b.element.style.height=""+b.rect.h+"px"}};d.prototype.updateSelf=function(a){};d.open=function(){this.screen?c.screenManager.pushScreen(this.screen):this.screen=new d;this.reasonText="Bonus stars!";app.settings.reasonText&&(this.reasonText=app.settings.reasonText);this.screen.editBox=this.screen.makeEditBox(this.reasonText,28,128,this.screen.size.x-64,64);this.screen.editBox.focus();this.screen.editBox.select()};window.ui.EditReason=
d});
rat.modules.add("js.ui.leaderboard",[{name:"rat.ui.r_ui",processBefore:!0},"js.ui.ui"],function(c){var d=function(a){var b=new c.ui.Shape(a,c.ui.squareShape);b.setColor(new c.graphics.Color(0,0,0,ui.config.LOG_BACKGROUND_OPACITY));b.setBounds(0,0,a.size.x,a.size.y);this.background=b;this.entries=[]};d.prototype.updateBoardState=function(a,b,e){function d(a,b,d,f,g,k){b=ui.makeText(m,b,5,v,43,u,r);b.setAlignment("right");k&&((k=ui.PlayerActionMenu.getSparkIconForAmount(k))||(k=""),k=ui.makeText(m,k,
q,v,40,u,r),k.setAlignment("right"),ui.applyTooltip(k,c.string.getString(a?"STR_SPARK_LEVEL_TOOLTIP_CURRENT":"STR_SPARK_LEVEL_TOOLTIP")));a=ui.makeText(m,d,87,v,t,u,r);f=ui.makeText(m,""+f,p,v,120,u,r);f.setAlignment("right");d===e.username&&(b.setColor(x),a.setColor(x),f.setColor(x));if(void 0!==g){var h=app.types.avatarIcon.make(m);h.setSize(34,34);h.clearFlag(c.ui.Element.autoSizeAfterLoadFlag);h.setFlag(c.ui.Element.autoScaleAfterLoadFlag);h.setPos(50,v-3+(!0===(null!=peSync.integratedSync||"xbox"===
app.platform)?6:0));gfx.getUserAvatar(g,function(a){h.useImageRef(a)})}v+=u}function g(a){for(var b=0;b<a.length;b++)if(a[b].username===e.username)return!0;return!1}function k(a,b,c,e){e=void 0===e?"credits":e;for(var f=0;f<b.length&&f<c;f++){var g=b[f],k=0<f?b[f-1]:null;null!=k&&k[e]===g[e]?k="":(y=f+1,k=""+y+".");d(a,k,g.username,g[e],g.userID,g.sparkLevel)}}function h(c,e,d){c=void 0===c?a.creditsLeaderboard:c;e=void 0===e?"credits":e;d=b[void 0===d?"rank":d];if(0>d)return d;var f="credits"==e?
b.creditCount+b.creditsInBets:b[e],g=f,k=c.length-1;return 0<k&&(g=c[k][e],g===f)?y:d<=y&&f<g?y+1:d}function l(a,b,c,f,g){void 0!==b&&-1!==b&&(d(a,"","...","",void 0,0),d(a,""+b+".",e.username,c,f,g))}if(a&&b&&e){this.background.setDirty(!0,!0);var m=this.background;m.removeAllSubElements();this.entryList=[];var n=m.getWidth()-5,t=n-87-120-10-40,p=n-120-40,q=n-40,v=30,r=ui.config.leaderboardFont,u=1*r.size|3,x=new c.graphics.Color(235,235,135),y=0;if(a.creditsLeaderboard&&0<a.creditsLeaderboard.length){var w=
ui.makeText(m,c.string.getString("STR_LEADERBOARD_SCORE"),5,v,n,u,ui.config.labelFont);w.setAlignment("center");this.roundLeaderboardTitle=w;v+=u+5;w=g(a.creditsLeaderboard);y=0;k(!0,a.creditsLeaderboard,w?10:8);if(!w){w=b.creditCount+b.creditsInBets;var B=h();l(!0,B,w,e.userID,b.sparkLevel)}}a.dailyLeaderboard&&0<a.dailyLeaderboard.length&&(v+=30,w=ui.makeText(m,c.string.getString("STR_LEADERBOARD_ROUNDWINS"),5,v,n,u,ui.config.labelFont),w.setAlignment("center"),this.dailyLeaderboardTitle=w,v+=u+
5,w=g(a.dailyLeaderboard),y=0,k(!1,a.dailyLeaderboard,w?10:8,"wins"),w||(w=h(a.dailyLeaderboard,"wins","winRank"),l(!1,w,b.wins,e.userID,b.winSparkLevel)),!0===app.isModConfig()&&this.makeClearDailyButton(m,.6*n,v+u))}};d.prototype.makeClearDailyButton=function(a,b,e){b=b||a.size.x-(ui.config.smallButtonWidth/2+rowWidth);e=e||this.dailyLeaderboardTitle.getPos().y+this.dailyLeaderboardTitle.size.y/2;a=ui.makeButtonAt(a,"",b,e,ui.config.smallButtonWidth,ui.config.smallButtonHeight);e=new c.ui.Sprite(a);
e.useImageRef(gfx.getImage("trash_icon_mod"));e.setPos(a.size.x/2,a.size.y/2);a.setCallback(function(){var a=new ui.ConfirmPopup("Clear Leaderboard","Are you sure you wish to clear the Round Wins leaderboard?",function(){peSync.sendMessageWithCode("clear_daily_leaderboard",{})},function(){});a.setAllowClickAway(!1);a.setAllowBackClose(!1);a.setAllowClickBodyClose(!1)});ui.applyTooltip(a,"Clear Round Wins Leaderboard");ui.setStandardButtonProperties(a,ui.config.BUTTON_MOD)};app.types.Leaderboard=d});
rat.modules.add("js.ui.game_info_pane",["js.ui.ui"],function(c){var d=function(a){this.state="waitForAutoRound";this.preventStateString=!1;var b=new c.ui.Element(a);b.fitToParentSize();var e=new c.ui.Shape(a,c.ui.roundRectShape);e.setColor(new c.graphics.Color(133,200,135));e.setOpacity(.2);e.setSize(a.size.x,a.size.y);e.cornerRadius=12;this.background=e;this.displayString=ui.makeStateText(b,"");this.showState(this.state)};d.prototype.showStats=function(a){};d.prototype.lockCustomText=function(a){(this.preventDefaultText=
void 0===a?!0:a)||this.showState(state)};d.prototype.showState=function(a,b){var e="";this.state=a;this.background.setVisible(!0);if(!this.preventStateString)switch(this.state){case "waitForAutoRound":e=c.string.getString("STR_STATE_WAITROUNDSTART");break;case "waitForAutoOffer":e=c.string.getString("STR_STATE_WAITOFFERS");break;case "waitForModRound":e=c.string.getString("STR_STATE_WAITROUNDSTART_MOD");break;case "waitForModOffer":e=c.string.getString("STR_STATE_WAITOFFERS_MOD");break;case "endOfRound":e=
c.string.getString("STR_STATE_ENDROUND");break;case "waitForW4":e=c.string.getString("STR_STATE_WAITAUTOFEED");break;case "warmingUp":e=c.string.getString("STR_STATE_AUTOFEEDWARMING");break;case "waitForActive":e=c.string.getString("STR_STATE_WAITACTIVE");break;case "showInfo":this.showStats();this.background.setVisible(!1);break;case "badW4data":e=c.string.getString("STR_BAD_W4_DATA");break;case "streamerOffline":e=c.string.getString("STR_STREAMER_OFFLINE");break;default:console.error("invalid state in GameInfoPane.showState(): "+
this.state+" - defaulting to showInfo"),this.showState("showInfo")}void 0!==b&&(e=b);this.displayString.setTextValue(e)};app.types.GameInfoPane=d});
rat.modules.add("js.ui.status_info_pane",[{name:"rat.ui.r_ui",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=ui.config.smallButtonHeight,a=function(b,c,f){this.open=!1;a.prototype.parentConstructor.call(this,b);this.setBounds(c,f,1080,d);this.setClipped(!0);this.makeStatusText();this.makeButtons();peSync.sendGetSupportedGamesList()};c.utils.inheritClassFrom(a,c.ui.Element);a.prototype.makeButtons=function(){var a=this,e=ui.makeButtonAt(this,"",ui.config.smallButtonWidth/2,
this.size.y/2,ui.config.smallButtonWidth,ui.config.smallButtonHeight);ui.setStandardButtonProperties(e,ui.config.BUTTON_MOD);var d=new c.ui.Sprite(e);d.useImageRef(gfx.getImage("info_menu_icon"));d.setPos(e.size.x/2,e.size.y/2);ui.applyTooltip(e,"Autofeed Status Info");e.setCallback(function(){a.open=!a.open;a.open?a.hideDisplay():a.showDisplay()});if("mobile"!==app){var g=ui.config.SMALL_BUTTON_BOUNDS_SCALE;e.adjustBoundsForPointer=function(a,b){b=e.size.x*g;var c=e.size.y*g;a.x=(e.size.x-b)/2;a.y=
(e.size.y-c)/2;a.w=b;a.h=c;return a}}this.button=e};a.prototype.makeStatusText=function(){this.offset=.7*ui.config.smallButtonWidth+4;this.textWidth=this.size.x-this.offset-4;var a=new c.ui.Shape(this,c.ui.roundRectShape);a.setBounds(this.offset,ui.config.smallButtonMargin+4,this.textWidth,this.size.y-2*ui.config.smallButtonMargin-6);a.setColor(ui.config.infoBoxColor);a.cornerRadius=12;this.textBackground=a;a=ui.makeStateText(a,"Waiting for the host to press the 'Start' button on the client");a.enableDefaultSpecialFormatting();
a.setTracksMouse(!0);ui.applyTooltip(a,"Displays information about the game and channel being watched.\nThis information is used by the automated offer system.");this.displayString=a};a.prototype.updateDisplay=function(a,c){if(a.state){var b=this.displayString;var e=a.watchingStreamer.streamerName;a=a.watchingStreamer.gameName;var d=null;if(c){var h=Object.keys(c)[0];c&&void 0!==c[h]&&void 0!==c[h].state&&(d=c[h].state)}h=c=!1;var l=Object.values(app.supportedGamesList);if(0<l.length){h=!0;for(var m=
0;m<l.length;m++)a===l[m]&&(c=!0,m=l.length)}l=". Autofeed is |not| enabled.";app.settings.watchFor.enabled?(l=". Autofeed is enabled.",null!==d&&(void 0===d.haveData&&d.haveData?l=". The autofeed is enabled and waiting for information.":void 0===d.active&&d.active||(l=d.isWarmingUp?". The autofeed is waiting for a new match to start...":d.active?". The autofeed sees the player as *Active*.":". The Autofeed sees the player as *Inactive*.")),!0===c?(b.setTextValue(ui.formatText("Watching ^"+e+"^ play *"+
a+"*"+l)),app.settings.watchFor.enabled&&this.ownerToolTip(b,"The channel is streaming a game supported by Autofeed and Autofeed has been enabled. If you wish to disable the automatic offers creation and resolution you can do so from the settings menu using the 'Allow Autofeed' button.")):h?(b.setTextValue(ui.formatText("^"+e+"^ is playing *"+a+"*. Autofeed is |not| compatible.")),this.ownerToolTip(b,"The channel is streaming "+a+", a game that is not supported by Autofeed. If this is not the game being played please update the game shown in the Mixer channel description. The game shown in MixGuess will update shortly after.")):
(b.setTextValue(ui.formatText("^"+e+"^ is playing *"+a+"*.")),this.ownerToolTip(b,"The channel is streaming "+a+". We should have info on autofeed support shortly."))):c?(b.setTextValue(ui.formatText("Watching ^"+e+"^ play *"+a+"*"+l)),h?this.ownerToolTip(b,"The channel is streaming a game supported by Autofeed but Autofeed has been disabled. If you wish to enable Autofeed you can do so by opening the setting menu and clicking on the 'Allow Autofeed' button."):this.ownerToolTip(b,"The channel is streaming a game that is not supported by Autofeed, and Autofeed is not enabled. If this is not the game appearing in the mixer channel description you can update the UI by going to settings and pressing the 'Check Game On Channel' button.")):
(b.setTextValue(ui.formatText("Watching ^"+e+"^ play *"+a+"*")),this.ownerToolTip(b,"We can see the game this channel is streaming, but don't have our list of supported game to check against yet."));this.lastWatchForOn=l;this.lastIsW4Compatible=c;this.lastAutoFeed=d}};a.prototype.ownerToolTip=function(a,c){app.isOwner()&&ui.applyTooltip(a,c)};a.prototype.showDisplay=function(){c.ui.killAnimatorsForElement(this.textBackground);var a=new c.ui.Animator(c.ui.Animator.mover,this.textBackground);a.setDoneCallback(function(){});
a.setTimer(.25);var e={x:this.offset,y:ui.config.smallButtonMargin+4};a.setStartEndVectors(this.textBackground.getPos(),e)};a.prototype.hideDisplay=function(){c.ui.killAnimatorsForElement(this.contentTray);var a=new c.ui.Animator(c.ui.Animator.mover,this.textBackground);a.setDoneCallback(function(){});a.setTimer(.25);var e={x:-this.textWidth,y:ui.config.smallButtonMargin+4};a.setStartEndVectors(this.textBackground.getPos(),e)};app.types.StatusInfoPane=a});
rat.modules.add("js.ui.alert_info_pane",[{name:"rat.ui.r_ui",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=ui.config.smallButtonHeight,a=function(b){a.prototype.parentConstructor.call(this,b);this.open=!0;this.setSize(1080,d);this.setClipped(!0);this.alertStrings=[];this.makeAlertText();this.makeButtons()};c.utils.inheritClassFrom(a,c.ui.Element);a.prototype.makeButtons=function(){var a=this,c=ui.makeButtonAt(this,"!",0,this.height/2,ui.config.smallButtonWidth,ui.config.smallButtonHeight);
ui.setStandardButtonProperties(c,ui.config.BUTTON_MOD);ui.applyTooltip(c,"Alert!");c.setCallback(function(){a.open=!a.open;a.open?a.hideDisplay():a.showDisplay()});this.button=c};a.prototype.makeAlertText=function(){this.offset=ui.config.smallButtonWidth+4;this.textWidth=this.size.x-this.offset-4;var a=new c.ui.Shape(this,c.ui.roundRectShape);a.setBounds(this.offset,ui.config.smallButtonMargin+4,this.textWidth,this.size.y-2*ui.config.smallButtonMargin-8);a.setColor(new c.graphics.Color(133,200,135,
.4));a.cornerRadius=12;this.textBackground=a;a=ui.makeStateText(a,ui.formatText("|This is a warning!|"));a.enableDefaultSpecialFormatting();this.displayString=a};a.prototype.updateDisplay=function(a){};a.prototype.showDisplay=function(){c.ui.killAnimatorsForElement(this.textBackground);var a=new c.ui.Animator(c.ui.Animator.mover,this.textBackground);a.setDoneCallback(function(){});a.setTimer(.25);var e={x:this.offset,y:ui.config.smallButtonMargin};a.setStartEndVectors(this.textBackground.getPos(),
e)};a.prototype.hideDisplay=function(){c.ui.killAnimatorsForElement(this.contentTray);var a=new c.ui.Animator(c.ui.Animator.mover,this.textBackground);a.setDoneCallback(function(){});a.setTimer(.25);var e={x:-this.textWidth,y:ui.config.smallButtonMargin};a.setStartEndVectors(this.textBackground.getPos(),e)};a.prototype.alert=function(){this.isVisible()||this.setVisible(!0);var a=new c.ui.Animator(c.ui.Animator.scaler,this.button.text);a.setInterpFilter(c.ui.Animator.filterEaseThereAndBack);a.setStartEnd(1,
3);a.setTimer(.25)};a.prototype.updateSelf=function(){1>this.alertStrings.length&&this.isVisible?this.hide():this.isVisible||this.alert()};a.prototype.hide=function(){this.setVisible(!1)};app.types.AlertInfoPane=a});
rat.modules.add("js.ui.stat_bar",["js.ui.ui"],function(c){var d=function(a){var b=new c.ui.Element(a);b.setSize(a.size.x,a.size.y);a=new c.ui.Shape(b,c.ui.squareShape);a.setColor(new c.graphics.Color(10,25,45));a.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);a.sizeToParent();a=new c.ui.Element(b);a.setBounds(16,8,b.size.x-32,b.size.y-16);this.makeStats(a);this.pages=[{title:"Autofeed Status",statsToShow:[this.watchForData,this.watchForPlayerStatus,this.watchForRoundStatus,this.killErrors,this.playerCountErrors]},
{title:"Gameplay Stats",statsToShow:[this.averageBank,this.numBankrupt,this.numActive,this.numUnresponsive,this.numChat]},{title:"Connection Stats",statsToShow:[this.platConnectedStat,this.numConnectedStat,this.playerOne,this.playerTwo,this.playerThree,this.playerFour,this.playerFive,this.playerSix]}];this.showing=[];this.tabs=[];this.setupPages(a);this.statsPane=a};d.prototype.setupPages=function(a){var b=this,c=ui.config.menuButtonWidth,d=ui.config.menuButtonHeight,g={};for(i=0;i<this.pages.length;g=
{but:g.but},i++)g.but=ui.makeButtonAt(a,this.pages[i].title,c*i+c/2,-(d/2),c,d),this.tabs.push(g.but),g.but.page=this.pages[i],g.but.setCallback(function(e){return function(){var d=a.size.x/2+4,f=0,g=0,k=(a.size.y-4)/4,t=(c-.8*c)/2;b.tabs.forEach(function(a,b){a.setScale(.8,.8);a.setPos(c*b+42,-(.8*a.size.y))});e.but.setScale(1,1);e.but.setPos(e.but.getPosX()-t,-e.but.size.y);0<b.showing.length&&(b.showing.forEach(function(a){a.setVisible(!1)}),b.showing.splice(0,b.showing.length));for(j=0;j<e.but.page.statsToShow.length;j++)3<
j&&(g=d),4===j&&(f=0),e.but.page.statsToShow[j].setPos(g,f),f+=k,e.but.page.statsToShow[j].setVisible(!0),b.showing.push(e.but.page.statsToShow[j])}}(g)),g.but.trigger();this.tabs[0].trigger()};d.prototype.makeStats=function(a){var b=a.size.x/2-8,c=a.size.y/3,d=ui.makeStatBarDisplayAt(a,"Receiving W4 Data",0,0,b,c);d.setVisible(!1);this.watchForData=d;d=ui.makeStatBarDisplayAt(a,"W4 Player Active/Fully",0,0,b,c);d.setVisible(!1);this.watchForPlayerStatus=d;d=ui.makeStatBarDisplayAt(a,"W4 In Round Status",
0,0,b,c);d.setVisible(!1);this.watchForRoundStatus=d;d=ui.makeStatBarDisplayAt(a,"W4 Kill Errors",0,0,b,c);d.setVisible(!1);this.killErrors=d;d=ui.makeStatBarDisplayAt(a,"W4 Player Count Errors",0,0,b,c);d.setVisible(!1);this.playerCountErrors=d;d=ui.makeStatBarDisplayAt(a,"Average Player Bank",0,0,b,c);d.setVisible(!1);this.averageBank=d;d=ui.makeStatBarDisplayAt(a,"Bankrupt Players",0,0,b,c);d.setVisible(!1);this.numBankrupt=d;d=ui.makeStatBarDisplayAt(a,"Active Players",0,0,b,c);d.setVisible(!1);
this.numActive=d;d=ui.makeStatBarDisplayAt(a,"Unresponsive Players",0,0,b,c);d.setVisible(!1);this.numUnresponsive=d;d=ui.makeStatBarDisplayAt(a,"Active Chatters",0,0,b,c);d.setVisible(!1);this.numChat=d;d=ui.makeStatBarDisplayAt(a,"Platforms",0,0,b,c);d.setVisible(!1);this.platConnectedStat=d;d=ui.makeStatBarDisplayAt(a,"Connected Players",0,0,b,c);d.setVisible(!1);this.numConnectedStat=d;d=ui.makeStatBarDisplayAt(a,"",0,0,b,c);d.setVisible(!1);this.playerOne=d;d=ui.makeStatBarDisplayAt(a,"",0,0,
b,c);d.setVisible(!1);this.playerTwo=d;d=ui.makeStatBarDisplayAt(a,"",0,0,b,c);d.setVisible(!1);this.playerThree=d;d=ui.makeStatBarDisplayAt(a,"",0,0,b,c);d.setVisible(!1);this.playerFour=d;d=ui.makeStatBarDisplayAt(a,"",0,0,b,c);d.setVisible(!1);this.playerFive=d;d=ui.makeStatBarDisplayAt(a,"",0,0,b,c);d.setVisible(!1);this.playerSix=d};d.prototype.updateStatsAnchorStats=function(a){void 0===a||null===a?console.warn("the gameState object passed to StatsBar.updateStatsAnchorStats() was undefined or null"):
0===Object.keys(a).length?console.warn("the gameState object passed to StatsBar.updateStatsAnchorStats() was empty"):(void 0!==a.playersThisRound?this.numActive.statValue.setTextValue(a.playersThisRound):this.numActive.statValue.setTextValue("NA"),void 0!==a.unresponsiveConnectedPlayers?this.numUnresponsive.statValue.setTextValue(a.unresponsiveConnectedPlayers):this.numUnresponsive.statValue.setTextValue("NA"),void 0!==a.playersChatting?this.numChat.statValue.setTextValue(a.playersChatting):this.numChat.statValue.setTextValue("NA"),
void 0!==a.bankruptPlayersCount?this.numBankrupt.statValue.setTextValue(a.bankruptPlayersCount):this.numBankrupt.statValue.setTextValue("NA"),void 0!==a.averageCreditsInBank?this.averageBank.statValue.setTextValue(Math.round(a.averageCreditsInBank)):this.averageBank.statValue.setTextValue("NA"),void 0!==a.platformCounts?this.platConnectedStat.statValue.setTextValue("web: "+a.platformCounts.web+" mobile: "+a.platformCounts.mobile+" xbox: "+a.platformCounts.xbox):this.platConnectedStat.statValue.setTextValue("NA"),
void 0!==a.playersConnected?this.numConnectedStat.statValue.setTextValue(a.playersConnected):this.numConnectedStat.statValue.setTextValue("NA"),a.mostSeniorConnectedPlayers[0]?this.playerOne.statValue.setTextValue(a.mostSeniorConnectedPlayers[0]):this.playerOne.statValue.setTextValue(""),a.mostSeniorConnectedPlayers[1]?this.playerTwo.statValue.setTextValue(a.mostSeniorConnectedPlayers[1]):this.playerTwo.statValue.setTextValue(""),a.mostSeniorConnectedPlayers[2]?this.playerThree.statValue.setTextValue(a.mostSeniorConnectedPlayers[2]):
this.playerThree.statValue.setTextValue(""),a.mostSeniorConnectedPlayers[3]?this.playerFour.statValue.setTextValue(a.mostSeniorConnectedPlayers[3]):this.playerFour.statValue.setTextValue(""),a.mostSeniorConnectedPlayers[4]?this.playerFive.statValue.setTextValue(a.mostSeniorConnectedPlayers[4]):this.playerFive.statValue.setTextValue(""),a.mostSeniorConnectedPlayers[5]?this.playerSix.statValue.setTextValue(a.mostSeniorConnectedPlayers[5]):this.playerSix.statValue.setTextValue(""))};d.prototype.updateAnchorStats=
function(a,b){void 0===a||null===a?console.warn("the gameState object passed to GameInfoPane.updateAnchorStats() was undefined or null"):0===Object.keys(a).length?console.warn("the gameState object passed to GameInfoPane.updateAnchorStats() was empty"):(a=d.getAutoFeedDataFromState(b),null!==a&&(void 0!==a.haveData?this.watchForData.statValue.setTextValue(a.haveData):this.watchForData.statValue.setTextValue("false"),void 0!==a.active?this.watchForPlayerStatus.statValue.setTextValue(a.active+"/"+a.fullyActive):
this.watchForPlayerStatus.statValue.setTextValue("false/false"),void 0!==a.isInRound?this.watchForRoundStatus.statValue.setTextValue(a.isInRound):this.watchForRoundStatus.statValue.setTextValue("false"),void 0!==a.killDataErrorCount?this.killErrors.statValue.setTextValue(a.killDataErrorCount):this.killErrors.statValue.setTextValue("0"),void 0!==a.playerCountDataErrorCount?this.playerCountErrors.statValue.setTextValue(a.playerCountDataErrorCount):this.playerCountErrors.statValue.setTextValue("0")))};
d.getAutoFeedDataFromState=function(a,b){b=b||0;var c=null;a&&(feedName=Object.keys(a)[b],void 0!==a[feedName]&&void 0!==a[feedName].state&&(c=a[feedName].state));return c};app.types.StatBar=d});
rat.modules.add("js.ui.action_log",[{name:"rat.ui.r_ui",processBefore:!0}],function(c){var d=function(a,b,e){d.prototype.parentConstructor.call(this,a);this.parent=a;this.belowPane=b;this.logEntryY="16";this.entryArray=[];pane=new c.ui.Element(a);pane.setSize(a.size.x,a.size.y);pane.setClipped(!0);this.pane=pane;a=new c.ui.Shape(this.pane,c.ui.squareShape);a.setColor(new c.graphics.Color(10,25,45));a.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);a.setSize(this.pane.size.x,this.pane.size.y);this.background=
a;a=new c.ui.Element(this.pane);a.setBounds(16,0);this.textFrame=a;this.adjustActionLog()};c.utils.inheritClassFrom(d,c.ui.Element);d.prototype.rebuildLogs=function(){var a=this;setTimeout(function(){a.updateLogs(peSync.knownActionLogState,!0)},250)};d.prototype.updateLogs=function(a,b){!0!==Array.isArray(a)&&(a=Object.keys(a).map(function(b){return a[b]}));var c=16;this.entryArray[0]&&(c=this.entryArray[0].getPosY());this.logEntryY=c;if(0<this.entryArray.length)for(i=this.entryArray.length-1;0<=
i;i--)this.entryArray[i].setTextValue(""),this.entryArray[i].timeStampText.setTextValue("");for(i=0;i<a.length;i++)this.processLogEntry(a[i],i,a.length-1,b)};d.prototype.processLogEntry=function(a,b,c,d){var e="";if(void 0===a.action)this.log("The action log was given an object with no action. Every object must have a valid action."),console.error("The action log was given an object with no action. Every object must have a valid action");else{if(void 0===a.timeStamp){var f="invalid - log object missing time stamp";
console.error("The action log was given an object with no timestamp. Every object should have one.")}else f=a.timeStamp;var h="";a.offerName&&(h=a.offerName.replace(/\^|~|\*|\|/g,""),h='"'+h.replace(/\[time\]/,"XX")+'"');switch(a.action){case "round_ended":e+=ui.formatText("Round "+a.roundID+" Ended by ^"+a.modName+"^");break;case "round_started":e+=ui.formatText("Round "+a.roundID+" Started by ^"+a.modName+"^");break;case "offer_resolved":var l="yes"===a.resolution||"STR_ACTION_YES"===a.resolution?
"~":"|";e+=ui.formatText("Offer "+h+" "+l+"resolved "+a.resolution+l+" added multiplier X"+a.additionalMultiplier+" by ^"+a.modName+"^");break;case "offer_created":e+=ui.formatText("Offer "+h+" created by ^"+a.modName+"^");break;case "credits_given":e+=ui.formatText("^"+a.modName+"^ gifted every player with ~"+a.credits+'~ credits with the message: "'+a.reason+'"');break;case "offer_edited":e+=ui.formatText("Offer Edited from  "+a.oldOfferName+" to "+h+" by ^"+a.modName+"^");a.editorChanged&&(e+=
ui.formatText("\n^"+a.modName+"^ is the new owner of this offer."));break;case "offer_lock":e=!0===a.lock?e+ui.formatText("Offer "+h+" locked by ^"+a.modName+"^"):e+ui.formatText("Offer "+h+" unlocked by ^"+a.modName+"^");break;case "winner_validated":l=a.value?"~":"|";e+=ui.formatText("Award round winners validated as "+l+a.value+l+" by ^"+a.modName+"^");break;case "player_given_channel_currency":e+=ui.formatText("^"+a.playerName+"^ given ~"+a.count+"~ in channel currency.");break;default:e=ui.formatText("There was an error processing a log entry with the action: "+
a.action+". Jeremy needs to fix it to handle it correctly or provide a more useful error if needed.")}newEntry=this.log(e,b,f);b===c&&(this.adjustActionLog(),d||this.newEntry(newEntry))}};d.prototype.log=function(a,b,c){if(this.entryArray[b]){var e=this.entryArray[b];e.setTextValue(a);e.setPos(0,this.logEntryY)}else e=ui.makeActionLogTextAt(this.textFrame,a,0,this.logEntryY),this.entryArray[b]=e;e.setSize(e.size.x,e.textHeight+24);this.logEntryY+=e.size.y;e.timeStampText?e.timeStampText.setPos(6,
-20):(e.timeStampText=ui.makeText(e,"",6,-20),e.timeStampText.setFontSize(14));e.timeStampText.setTextValue("timestamp: "+c);return e};d.prototype.newEntry=function(a){a=new c.ui.Animator(c.ui.Animator.scaler,a);a.setTimer(.25);a.setStartEndVectors({x:0,y:1},{x:1,y:1})};d.prototype.scrollEntry=function(a,b){var e=new c.ui.Animator(c.ui.Animator.mover,a);e.setTimer(.5);b={x:a.getPosX(),y:a.getPosY()-b};e.setStartEndVectors(a.getPos(),b)};d.prototype.adjustActionLog=function(){var a=this,b=this.pane.getPosX();
this.pane.setPos(b,this.belowPane.size.y/2-8);this.pane.setSize(this.pane.size.x,app.config.IDEAL_H-app.config.STRIP_H/2-this.parent.parent.getGlobalPos().y-this.pane.getPosY()-8-8);this.background.setSize(this.pane.size.x,this.pane.size.y+8);this.textFrame.setSize(this.pane.size.x-32,this.pane.size.y-16);b=this.textFrame.getPosY()+this.textFrame.size.y;if(0<this.entryArray.length){var c=this.entryArray[this.entryArray.length-1];c=c.getPosY()+c.size.y;if(c>this.entryArray[0].getPosY()-b){var d=c-
b;this.entryArray.forEach(function(b){a.scrollEntry(b,d)})}}};app.types.ActionLog=d});
rat.modules.add("js.ui.value_selector",[{name:"rat.ui.r_ui_button",processBefore:!0},"js.ui.ui"],function(c){var d={UP:"arrow_green_up",DOWN:"arrow_green_down",UP_HIGHLIGHT:"arrow_green_up_highlight",UP_DISABLED:"arrow_green_up_disabled",DOWN_HIGHLIGHT:"arrow_green_down_highlight",DOWN_DISABLED:"arrow_green_down_disabled"},a={UP:"arrow_purple_up",DOWN:"arrow_purple_down",UP_HIGHLIGHT:"arrow_purple_up_highlight",UP_DISABLED:"arrow_purple_up_disabled",DOWN_HIGHLIGHT:"arrow_purple_down_highlight",DOWN_DISABLED:"arrow_purple_down_disabled"},
b={UP:"off_button_up",DOWN:"off_button_down",UP_HIGHLIGHT:"off_button_up_highlight",UP_PRESSED:"off_button_up_highlight",UP_DISABLED:"off_button_up_disabled",DOWN_HIGHLIGHT:"off_button_down_highlight",DOWN_PRESSED:"off_button_up_highlight",DOWN_DISABLED:"off_button_down_disabled"},e=function(a){e.prototype.parentConstructor.call(this,a);this.setSize(ui.config.betButtonWidth,ui.config.betButtonHeight);this.amount=10;this.isCapped=!1;this.maxCap=100;this.directionUp=this.canGoDown=this.canGoUp=!0;this.changeAmount=
10;this.mousePos={x:0,y:0};ui.setStandardButtonProperties(this,ui.config.BUTTON_MOD);this.arrows=d;(new c.ui.Element(this)).setSize(ui.config.betButtonWidth,ui.config.betButtonHeight);a=new c.ui.Shape(this,c.ui.squareShape);a.setColor(new c.graphics.Color(0,0,0,ui.config.LOG_BACKGROUND_OPACITY));a.setSize(105,40);a.setPos((this.size.x-a.size.x)/2,(this.size.y-a.size.y)/2);this.background=a;a=ui.makeText(this.background,""+this.amount,0,0,a.size.x,a.size.y);a.centerText();a.setColor(ui.config.creditsColor);
this.valueText=a;a=new c.ui.Element(this.background);a.setSize(20,20);var b=new c.ui.Sprite(a);b.setSize(40,40);b.setFlag(c.ui.Element.autoScaleAfterLoadFlag);b.useImageRef(gfx.getImage("ticket"));b.setScale(.5,.5);b.setPos(a.size.x/2,(this.background.size.y-a.size.x)/2);this.icon=a;this.baseArrowScale=.8;b=new c.ui.Sprite(this);b.useImageRef(gfx.getImage(this.arrows.UP));b.setPos(this.size.x/2,b.size.y/2+16);this.upArrow=b;b=new c.ui.Sprite(this);b.useImageRef(gfx.getImage(this.arrows.DOWN));b.setPos(this.size.x/
2,this.size.y-b.size.y/2-16);this.downArrow=b;this.addExtendedUI();this.useExtendedArrows(!1);this.clickSound="click";this.focusSound=void 0;this.autoRepeatValues={initialDelay:.25,startDelay:.15,delayMultiplier:.9,minimumDelay:2.5E-4};this.setAutoRepeat(this.autoRepeatValues);this.setValue(this.amount);this.setCallback(function(){});this.setupButton.apply(this,[c.ui.Button.bubbleType,ui.config.BUTTON_IMAGE,ui.config.BUTTON_IMAGE_HIGHLIGHTED,ui.config.BUTTON_IMAGE_PRESSED,ui.config.BUTTON_IMAGE_DISABLED])};
c.utils.inheritClassFrom(e,c.ui.Button);e.prototype.adjustBoundsForPointer=function(a,b){var c=a.w,d=4*a.h;a.y=this.size.y/2-d/2;a.w=c;a.h=d;return e.prototype.parentPrototype.adjustBoundsForPointer.call(this,a,b)};e.prototype.setDirectionUp=function(a){this.directionUp=a};e.prototype.trigger=function(a){this.arrow&&(app.playerActionInfo.adjustedValues++,1===app.playerActionInfo.adjustedValues&&(app.settings.adjustedBetValues=!0,peSync.sendSettingsReport()));a&&"mouseup"===a.eventType||(!this.canGoUp&&
this.directionUp?(a&&(audio.playSound("error"),audio.playSound("hitcap")),this.autoRepeat&&this.autoRepeat.pressCount&&audio.playSound("hitcap"),this.resetAutoRepeat(),this.stopAutoRepeat()):this.canGoDown||this.directionUp?e.prototype.parentPrototype.trigger.call(this,a)&&(this.directionUp?this.valueUp():this.valueDown()):(a&&(audio.playSound("error"),audio.playSound("hitcap")),this.autoRepeat&&this.autoRepeat.pressCount&&audio.playSound("hitcap"),this.resetAutoRepeat(),this.stopAutoRepeat()))};
e.prototype.mouseDown=function(a,b){this.mousePos.y=a.y;this.mousePos.y>this.size.y/2?this.setDirectionUp(!1):this.setDirectionUp(!0);return e.prototype.parentPrototype.mouseDown.call(this,a,b)};e.prototype.mouseLeave=function(a){if(!this.isPressed())return e.prototype.parentPrototype.mouseLeave.call(this,a)};e.prototype.updateSelf=function(a){var b=this;if(this.isCapped){var d=this.maxCap/10;100>=this.maxCap?d=10<this.maxCap?10:1:(10>d&&(d=10),incrementExponent=d.toString().length-1,this.changeAmount=
Math.pow(10,incrementExponent));this.arrow&&(1>app.playerActionInfo.adjustedValues?3<app.playerActionInfo.acceptedOfferCount&&this.showArrow():this.hideArrow())}this.amount<=this.changeAmount?this.canGoDown=!1:(this.downArrow.useImageRef(gfx.getImage(this.arrows.DOWN)),this.canGoDown=!0);this.canGoUp=this.isCapped&&this.amount>=this.maxCap?!1:!0;d=function(){b.upArrow.useImageRef(gfx.getImage(b.arrows.UP_HIGHLIGHT));b.ExtendedUpArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.UP_HIGHLIGHT));
b.ExtendedUpArrow.setOpacity(1);b.downArrow.useImageRef(gfx.getImage(b.arrows.DOWN));b.ExtendedDownArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.DOWN));b.ExtendedDownArrow.setOpacity(.8);b.setDirectionUp(!0)};var f=function(){b.downArrow.useImageRef(gfx.getImage(b.arrows.DOWN_HIGHLIGHT));b.ExtendedDownArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.DOWN_HIGHLIGHT));b.ExtendedDownArrow.setOpacity(1);b.upArrow.useImageRef(gfx.getImage(b.arrows.UP));b.ExtendedUpArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.UP));
b.ExtendedUpArrow.setOpacity(.8);b.setDirectionUp(!1)};"mouse"===c.input.lastUIInputType&&(this.isHighlighted()||this.isPressed())?this.mousePos.y>this.size.y/2?f():d():this.autoRepeat&&this.autoRepeat.isTracking?this.directionUp?d():f():(b.upArrow.useImageRef(gfx.getImage(b.arrows.UP)),b.ExtendedUpArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.UP)),b.ExtendedUpArrow.setOpacity(.8),b.downArrow.useImageRef(gfx.getImage(b.arrows.DOWN)),b.ExtendedDownArrow.useImageRef(gfx.getImage(b.extendedButtonArrows.DOWN)),
b.ExtendedDownArrow.setOpacity(.8));!1===this.canGoDown&&(this.downArrow.useImageRef(gfx.getImage(this.arrows.DOWN_DISABLED)),this.ExtendedDownArrow.useImageRef(gfx.getImage(this.extendedButtonArrows.DOWN_DISABLED)),this.ExtendedDownArrow.setOpacity(.2));!1===this.canGoUp&&(this.upArrow.useImageRef(gfx.getImage(this.arrows.UP_DISABLED)),this.ExtendedUpArrow.useImageRef(gfx.getImage(this.extendedButtonArrows.UP_DISABLED)),this.ExtendedUpArrow.setOpacity(.2));this.isCapped&&(this.updateCap(),this.amount>
this.maxCap&&(this.amount=this.maxCap,this.updateValueDisplay()));e.prototype.parentPrototype.updateSelf.call(this,a)};e.prototype.letGoDammit=function(){this.clearFlag(c.ui.Element.pressedFlag);this.clearFlag(c.ui.Element.trackingMouseDownFlag);this.clearFlag(c.ui.Element.highlightedFlag)};e.prototype.valueUp=function(){this.isCapped?(this.amount+=this.changeAmount,this.amount=this.amount<this.maxCap?this.amount:this.maxCap):this.amount+=this.changeAmount;this.updateValueDisplay()};e.prototype.valueDown=
function(){this.amount-=this.changeAmount;this.amount=this.amount>this.changeAmount?this.amount:this.changeAmount;this.updateValueDisplay()};e.prototype.updateValueDisplay=function(){this.valueText.setTextValue(""+this.amount);var a=this.valueText,b=this.icon,c=a.getPosY(),e=this.background.size.x-b.size.x-8,d=a.getRawTextWidth();a.setSize(d>e?e:d,a.size.y);a.setPos(this.background.size.x/2+b.size.x/2-a.size.x/2,c);b.setPos(a.getPosX()-b.size.x,c+a.size.y/2-b.size.y/2);this.canGoDown||this.canGoUp?
this.isEnabled()||this.setEnabled(!0):this.setEnabled(!1)};e.prototype.setValue=function(a){this.amount=a;this.updateValueDisplay()};e.prototype.setDefaultValue=function(){this.updateCap();var a=.1*this.maxCap;a=100>=this.maxCap?this.changeAmount:10*Math.ceil(a/10);a=Math.max(a,this.changeAmount);a=Math.min(a,this.maxCap);this.setValue(a)};e.prototype.addCap=function(){this.isCapped=!0};e.prototype.updateCap=function(){this.maxCap=game.hud.playerCreditsActual};e.prototype.nonMod=function(b){this.setSize(ui.config.betButtonWidth,
ui.config.betButtonHeight);ui.setStandardButtonProperties(this,ui.config.BUTTON_PURPLE);this.arrows=a;this.upArrow.useImageRef(gfx.getImage(this.arrows.UP));this.downArrow.useImageRef(gfx.getImage(this.arrows.DOWN));this.addCap();"xbox"!==this.platform&&this.useExtendedArrows(!0);this.makeArrow()};e.prototype.makeArrow=function(){var a=new c.ui.Sprite(this);a.useImageRef(gfx.getImageCopy("help_arrow"));a.setScale(1,1);a.setPos(this.size.x+32,-30);this.arrow=a;this.hideArrow()};e.prototype.showArrow=
function(){this.arrow.setVisible(!0)};e.prototype.hideArrow=function(){this.arrow.setVisible(!1)};e.prototype.addExtendedUI=function(){var a=new c.ui.Element;this.insertSubElementBefore(a,this.gradientLayer);a.setSize(ui.config.betButtonWidth,3*ui.config.betButtonHeight);a.setPos((this.size.x-a.size.x)/2,(this.size.y-a.size.y)/2);this.extendedUI=a;var e=new c.ui.Sprite(a);e.sizeToParent();e.setPos(a.size.x/2,a.size.y/2);e.useImageRef(gfx.getImage("off_button_box"));this.extendedButtonArrows=b;e=new c.ui.Sprite(a);
e.useImageRef(gfx.getImage(this.extendedButtonArrows.UP));e.setPos(a.size.x/2,a.size.y/2-106);e.setOpacity(.8);this.ExtendedUpArrow=e;e=new c.ui.Sprite(a);e.useImageRef(gfx.getImage(this.extendedButtonArrows.DOWN));e.setPos(a.size.x/2,a.size.y/2+106);e.setOpacity(.8);this.ExtendedDownArrow=e};e.prototype.useExtendedArrows=function(a){a=void 0===a?!0:a;this.extendedUI?this.extendedUI.setVisible(a):console.warn("tried to set visibility on non existent extended arrows");this.upArrow&&this.downArrow?
(this.upArrow.setVisible(!a),this.downArrow.setVisible(!a)):console.warn("tried to set visibility on non existent button arrows")};e.prototype.getAmount=function(){return this.amount};app.types.ValueSelector=e});
rat.modules.add("js.ui.drop_down",["js.ui.ui"],function(c){var d=function(a,b,e,d,g,k,h){var f=this;h=void 0===h?!1:h;this.state="open";this.moves=!1;this.marginX=16;var m=g-32,n=app.config.IDEAL_H,t=e-m/2,p="mobile"===app.platform?d+16:d;this.parent=a;this.closedPos={x:this.parent.getPosX(),y:this.parent.getPosY()};this.openPos={x:this.parent.getPosX(),y:this.parent.getPosY()};this.openScale={x:1,y:1};var q=new c.ui.Element(a);q.setBounds(t,p,m,n);q.setClipped(!0);this.clipPane=q;t=new c.ui.Element(q);
t.setBounds(0,0,m,n);this.contentTray=t;a=ui.makeDropButtonAt(a,b,e,d,g,k);this.closedSize=this.openSize={x:g,y:k};a.setTextInset(0);a.setCallback(function(){"open"===f.state?f.close():f.open();f.callback&&f.callback(f,f.callbackInfo,f.state)});icon=new c.ui.Sprite(a);icon.useImageRef(gfx.getImage("icon_leaderboard"));icon.setPos((a.size.x-icon.size.x)/2,(a.size.y-icon.size.y)/2);icon.setVisible(!1);a.icon=icon;this.button=a;h&&this.autoClose()};d.prototype.setCallback=function(a,b){this.callback=
a;"undefined"!==typeof b&&(this.callbackInfo=b)};d.prototype.showIcon=function(){this.button.icon.setVisible(!0)};d.prototype.getCloseTarget=function(){return{x:this.contentTray.getPosX(),y:0-this.contentTray.size.y}};d.prototype.autoClose=function(){this.state="close";var a=this.getCloseTarget();this.contentTray.setPos(a.x,a.y);this.contentTray.setVisible(!1);this.button.dropArrow.useImageRef(gfx.getImage("button_tab_down"));this.parent.setPos(this.closedPos.x,this.closedPos.y);if(this.moves&&(this.button.dropArrow.setVisible(!1),
this.button.dropArrow.setRotation(-1.5708),this.button.dropArrow.setPos(this.button.dropArrow.getPosX(),(this.button.size.y+this.button.dropArrow.size.x)/2),this.button.text.setVisible(!1),this.button.setSize(ui.config.smallButtonWidth,ui.config.smallButtonHeight),this.button.icon.setPos((this.button.size.x-this.button.icon.size.x)/2,(this.button.size.y-this.button.icon.size.y)/2),this.updateButtonGradient(),"mobile"!==app)){var b=ui.config.SMALL_BUTTON_BOUNDS_SCALE,c=this.button;this.button.adjustBoundsForPointer=
function(a,e){e=c.size.x*b;var d=c.size.y*b;a.x=c.getPosX()+(c.size.x-e)/2;a.y=c.getPosY()+(c.size.y-d)/2;a.w=e;a.h=d;return a}}};d.prototype.updateButtonGradient=function(){if(this.button.gradientLayer){var a=this.button,b=this.button.gradientLayer,c=ui.config.GRADIENT_INSET;b.setPos(c,c);b.setSize(a.size.x-2*c,a.size.y-2*c);b.updateGradients()}};d.prototype.setThisMoves=function(a){this.moves=a};d.prototype.setCloseTarget=function(a,b,c,d){this.setThisMoves(!0);this.closedPos.x=void 0==a?this.closedPos.x:
a;this.closedPos.y=void 0==b?this.closedPos.y:b;this.state="close";this.autoClose()};d.prototype.setOpenTarget=function(a,b,c,d){this.setThisMoves(!0);this.openPos.x=void 0==a?this.openPos.x:a;this.openPos.y=void 0==b?this.openPos.y:b};d.prototype.setCloseTargetObject=function(a){this.targetObject=a};d.prototype.setOpenTargetObject=function(a){this.openTargetObject=a};d.prototype.open=function(){var a=this;"undefined"!==typeof this.openTargetObject&&(this.openPos=this.openTargetObject.getPos());this.state=
"open";c.ui.killAnimatorsForElement(this.contentTray);this.contentTray.setVisible(!0);var b=new c.ui.Animator(c.ui.Animator.mover,this.contentTray);b.setDoneCallback(function(){a.button.icon.setPos((ui.config.smallButtonWidth-a.button.icon.size.x)/2,(a.button.size.y-a.button.icon.size.y)/2);a.moves&&(a.button.dropArrow.setVisible(!0),a.button.resizeTextBox(),a.button.text.setVisible(!0),"mobile"!==app&&(a.button.adjustBoundsForPointer=function(a,b){if(b&&b.isFromTouch){var c=b.touchRadiusX;b=b.touchRadiusY;
a.x-=c;a.y-=b;a.w+=2*c;a.h+=2*b}return a}))});b.setTimer(ui.config.DROP_DOWN_ANIM_TIME);var e={x:this.contentTray.getPosX(),y:0};b.setStartEndVectors(this.contentTray.getPos(),e);this.button.dropArrow.useImageRef(gfx.getImage("button_tab_up"));this.moves&&(this.moveAndSize(this.parent.getPos(),this.openPos,this.closedSize,this.openSize,{x:0,y:1},{x:1,y:1}),this.button.setSize(ui.config.pulldownButtonWidth,ui.config.pulldownButtonHeight))};d.prototype.close=function(){var a=this;"undefined"!==typeof this.closeTargetObject&&
(this.closedPos=this.closeTargetObject.getPos());this.state="close";c.ui.killAnimatorsForElement(this.contentTray);var b=new c.ui.Animator(c.ui.Animator.mover,this.contentTray);b.setDoneCallback(function(){a.contentTray.setVisible(!1);a.moves&&"mobile"!==app&&(a.button.adjustBoundsForPointer=function(a,b){a.x=this.getPosX()+(this.size.x-.8*this.size.x)/2;a.y=this.getPosY()+(this.size.y-.8*this.size.y)/2;a.w=.8*this.size.x;a.h=.8*this.size.y;return a})});b.setTimer(ui.config.DROP_DOWN_ANIM_TIME);var e=
this.getCloseTarget();b.setStartEndVectors(this.contentTray.getPos(),e);this.button.dropArrow.useImageRef(gfx.getImage("button_tab_down"));this.moves&&(this.moveAndSize(this.parent.getPos(),this.closedPos,this.openSize,this.closedSize,{x:1,y:1},{x:0,y:1}),this.button.dropArrow.setVisible(!1),this.button.text.setVisible(!1),this.button.setSize(ui.config.smallButtonWidth,ui.config.smallButtonHeight),this.button.icon.setPos((this.button.size.x-this.button.icon.size.x)/2,(this.button.size.y-this.button.icon.size.y)/
2),this.updateButtonGradient())};d.prototype.moveAndSize=function(a,b,e,d,g,k){var f=this;c.ui.killAnimatorsForElement(this.parent);c.ui.killAnimatorsForElement(this.button);c.ui.killAnimatorsForElement(this.button.gradientLayer);var l=new c.ui.Animator(c.ui.Animator.mover,this.parent);l.setTimer(ui.config.DROP_DOWN_ANIM_TIME);l.setStartEndVectors(a,b);a=new c.ui.Animator(c.ui.Animator.scaler,this.contentTray);a.setTimer(ui.config.DROP_DOWN_ANIM_TIME);a.setStartEndVectors(g,k);g=new c.ui.Animator(c.ui.Animator.resizer,
this.button);g.setTimer(ui.config.DROP_DOWN_ANIM_TIME);g.setStartEndVectors(e,d);e={x:e.x-ui.config.GRADIENT_INSET,y:e.y-2*ui.config.GRADIENT_INSET};d={x:d.x-ui.config.GRADIENT_INSET,y:d.y-2*ui.config.GRADIENT_INSET};g=new c.ui.Animator(c.ui.Animator.resizer,this.button.gradientLayer);g.setTimer(ui.config.DROP_DOWN_ANIM_TIME);g.setStartEndVectors(e,d);l.setDoneCallback(function(){f.updateButtonGradient()})};d.prototype.reposition=function(){this.moves&&"open"===this.state&&(console.log("moving"),
this.parent.setPos(this.openTargetObject.getPos()))};d.prototype.setTooltip=function(a){ui.applyTooltip(this.button,a)};app.types.DropDown=d});
rat.modules.add("js.ui.avatar_icon",["rat.ui.r_ui_sprite","rat.graphics.r_image"],function(c){var d={make:function(a,b,e){a=new c.ui.Sprite(a);var f=a.drawSelf;a.drawSelf=function(a){if(this.imageRef){var c=this.size.x,g=c/2-this.center.x,l=c/2-this.center.x;d.startUserAvatar(a,g,l,c);f.call(this,a);d.endUserAvatar(a,g,l,c,b,e)}};return a},drawUserAvatar:function(a,b,c,f,g,k,h){d.startUserAvatar(a,c,f,g);b.draw(a,c-g/2,f-g/2,g,g);d.endUserAvatar(a,c,f,g,k,h)},startUserAvatar:function(a,b,c,d){a.save();
a.beginPath();a.arc(b,c,d/2,0,2*Math.PI);a.clip()},endUserAvatar:function(a,b,c,d,g,k){a.restore();g&&(a.lineWidth=k||3,a.strokeStyle=g.toString(),a.beginPath(),a.arc(b,c,d/2+1,0,2*Math.PI),a.stroke())}};app.types.avatarIcon=d});
rat.modules.add("js.ui.player_action_menu",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.customize_player_action_menu"],function(c){var d=0,a={},b=function(){b.prototype.parentConstructor.call(this);var a=c.string.getString("STR_PLAYER_ACTION_TITLE");this.setSize(984,560);this.centerInDisplay();this.lastKnownSparkBoardActive=app.settings.sparkBoardActive;this.onlyDuringRoundButtons=[];this.buttons=[];this.lastKnowModStatus=
app.isModConfig();this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);this.setAllowClickAway(!0);this.setAllowBackClose(!0);getSparkCount(this);this.makeButtons();app.settings.rebuildSparkBoard=!1;c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(b,c.ui.Screen);b.prototype.closeScreen=function(){c.screenManager.popScreen()};b.prototype.placeButtons=function(a){var b=128,
e=32,d=(this.size.x-64)/3,h=d-ui.config.sparkButtonWidth+ui.config.sparkButtonHeight;if(0===a.length)a=ui.makeText(this,c.string.getString("STR_SPARK_BOARD_DISABLED"),0,0,this.size.x,this.size.y),peSync.playerInfo.isAnonymous&&a.setTextValue(c.string.getString("STR_SPARK_BOARD_NOT_AVAILABLE_ANON")),a.setFontSize(ui.config.buttonFont.size),a.centerText(),this.boardMessage=a;else{var l=0;for(i=0;i<a.length;i++)a[i].inUI&&(0===l%3&&0!==l&&(e=32,b+=h),a[i].setPos(e,b),e+=d,a[i].butGlobalPos=a[i].getGlobalPos(),
"space"===app.settings.playerActionButtons[i].type?a[i].setVisible(!1):a[i].setEnabled(!0),l++);this.setSize(this.size.x,b+ui.config.sparkButtonHeight+h);this.backgroundBox.fitToParentSize();this.centerInDisplay();this.autoBuildInputMap(!0,!0,1,2)}};getSparkCount=function(a){return new Promise(function(a,b){mixer||(d=125E3,a());c.utils.restGetJSONAsync("https://mixer.com/api/v1/users/"+peSync.playerInfo.userID,function(c,e,f){c&&e&&e.sparks?(d=e.sparks,a()):(f&&console.error(f),b())})})};b.prototype.makeSparkButton=
function(a,f,g){var e={},h={},l="mixguess-sparkSpend"+g,m=f.onlyDuringRound||!1,n=f.chatMessage||"",t=void 0===f.sparkSpendEffect?!0:f.sparkSpendEffect;console.log(t);"giveCredits"===f.type?(e={callback:b.giftSuccess,params:{}},h={callback:b.defaultError,params:{}},m=!0):(e={callback:b.defaultSuccess,params:{chatMessage:n,showEffect:t}},h={callback:b.defaultError,params:{}});n=ui.config.sparkButtonWidth;t=ui.config.sparkButtonHeight;f.buttonSize&&(n=f.buttonSize.x,t=f.buttonSize.y);var p=ui.makeButtonAt(a,
f.label+"\n",0,2*c.graphics.SCREEN_HEIGHT,n,t);n=new c.ui.Sprite(p);n.useImageRef(gfx.getImage("button_cooldown_icon"));n.setPos(p.size.x/2,p.size.y/2);n.setVisible(!1);p.cooldownIcon=n;p.setEnabled(!1);p.index=g;p.inUI=f.inUI;"mobile"===app.platform?p.costText=ui.makeSparkCostText(p,"\u26a1"+f.sparkCost,8,.6*p.size.y,p.size.x-16,24):(p.costText=ui.makeSparkCostText(p,c.string.replaceTokens("{SPARK} "+f.sparkCost,[{key:"{SPARK}",value:c.ui.TextBox.makeSpecialImageString("mixer_spark_emblem")}]),8,
.6*p.size.y,p.size.x-16,24),p.costText.enableDefaultSpecialFormatting());p.setCallback(function(){getSparkCount(a);if(d>=f.sparkCost){peSync.giveControlInput(l,f.chatMessage,g);var b=e.params;e.params.cost=f.sparkCost;e.params.buttonPos={x:p.butGlobalPos.x+p.size.x/2,y:p.butGlobalPos.y+p.size.y/2};e.callback(b);0<f.userCooldownValue&&(app.playerActionButtonsUserCooldown[p.index]=!0,setTimeout(function(){app.playerActionButtonsUserCooldown[p.index]=!1},1E3*f.userCooldownValue));a.closeScreen()}else h.callback(h.params)});
f.toolTip&&""!==f.toolTip&&ui.applyTooltip(p,f.toolTip);a.buttons.push(p);m&&this.addButtonToOnlyDuringRoundButtons(p);p.updateCooldown=function(){var a=!1,b=peSync.knownGlobalState.individualTimers[p.index],c=peSync.knownGlobalState.shareOnCooldown,e=app.settings.playerActionButtons[p.index];app.playerActionButtonsUserCooldown[p.index]&&(a=app.playerActionButtonsUserCooldown[p.index]);f.globalCooldownToggle&&c&&!a?a=c:!a&&b.numPresses>=e.requiredUserCount?a=!0:a||(a=b.onCooldown);updateActiveState(p,
!a,!0);p.lastIsCoolingDown=a};p.updateCooldown();return p};b.buildSparkIconTable=function(){var b={};for(i=0;i<Object.keys(app.settings.playerActionButtons).length;i++){var c=app.settings.playerActionButtons[i];""!==c.icon&&c.inUI&&(b[c.sparkCost]=c.icon)}a=b};b.getSparkIconForAmount=function(b){return 0>=Object.keys(a).length?(console.log("there are no icons specified for badges"),""):(b=a[b])?b:""};b.defaultSuccess=function(a){var b=a.buttonPos,e={x:c.graphics.SCREEN_WIDTH/2,y:"web"===app.platform?
c.graphics.SCREEN_HEIGHT:0},d=Math.floor(a.cost/1E4+1);0<a.cost&&a.showEffect&&(effects.giveSparksEffect(b,e,d),audio.playSound("give_sparks"))};b.defaultError=function(a){audio.playSound("error")};b.giftSuccess=function(a){a.showEffect&&(effects.giveSparksEffect(startPos,endPos,count),audio.playSound("gift_credits"))};b.prototype.makeButtons=function(){var a=this;app.isModConfig()&&(this.enableSparkBoardButton=ui.makeToggleButtonAt(this,c.string.getString("STR_ALLOW_SPARK_BOARD"),-3,-86,{callback:window.ui.SettingsMenu.toggleSparkBoard,
param:app.settings.sparkBoardActive},app.settings.sparkBoardActive,"STR_SETTING_SPARK_BOARD_ACTIVE_TOOLTIP"));var b=Object.keys(app.settings.playerActionButtons).length;for(i=0;i<b;i++)this.makeSparkButton(this,app.settings.playerActionButtons[i],i);b=[];app.settings.sparkBoardActive&&!peSync.playerInfo.isAnonymous&&(b=this.buttons);this.placeButtons(b);b=c.string.getString("STR_HELP_CLOSE");b=ui.makeText(this,b,16,this.size.y-ui.config.buttonHeight,this.size.x-32,ui.config.buttonHeight);b.setAlignment("right");
b.enableDefaultSpecialFormatting();b.setVisible(!1);this.closePrompt=b;!0===game.hud.useButtonIcons&&b.setVisible(!0);"xbox"!==app.platform&&(b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),this.size.x/2,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight),ui.applyTooltip(b,c.string.getString("STR_MENU_EXIT_TOOLTIP")),b.setCallback(function(){a.closeScreen()}),this.exitButton=b);this.autoBuildInputMap(!0,!0,2,4);this.inputMap.navigateSound="navigate"};
b.prototype.addButtonToOnlyDuringRoundButtons=function(a){updateActiveState(a,peSync.knownGlobalState.roundIsActive);this.onlyDuringRoundButtons.push(a)};updateActiveState=function(a,b,c){c=void 0===c?!1:c;var e=b?1:.5;a.setEnabled(b);a.text.setOpacity(e);a.costText.setOpacity(e);c&&a.cooldownIcon.setVisible(!b)};b.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen activated.")};b.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,
"settings screen deactivated.")};b.prototype.onWindowResize=function(){this.centerInDisplay();this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement)};b.prototype.updateSelf=function(a){a=app.isModConfig();var b=game.hud.useButtonIcons;b!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=b;for(i=0;i<this.buttons.length;i++)this.buttons[i].updateCooldown();if(0<this.onlyDuringRoundButtons.length)for(i=0;i<this.onlyDuringRoundButtons.length;i++)updateActiveState(this.onlyDuringRoundButtons[i],
peSync.knownGlobalState.roundIsActive);this.lastKnownSparkBoardActive!==app.settings.sparkBoardActive&&(app.settings.rebuildSparkBoard=!0);a!==this.lastKnowModStatus&&(app.settings.rebuildSparkBoard=!0);app.settings.rebuildSparkBoard&&c.screenManager.isTopScreen(this)&&(this.closeScreen(),window.ui.PlayerActionMenu.open(!0));this.lastKnowModStatus=a};b.prototype.updateUIIcons=function(){!0===game.hud.useButtonIcons?"web"===app.platform&&this.closePrompt.setVisible(!0):"web"===app.platform&&this.closePrompt.setVisible(!1)};
b.prototype.mouseDown=function(a,b){return!1};b.prototype.handleKeyDown=function(a){return!1};b.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.closeScreen(),!0}return!1};b.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};b.open=function(a){app.isModConfig()!==this.lastKnowModStatus&&
(a=!0);!this.screen||a?this.screen=new b:c.screenManager.pushScreen(this.screen)};window.ui.PlayerActionMenu=b});
rat.modules.add("js.ui.autofeed_data_accuracy_display",[{name:"rat.ui.r_ui",processBefore:!0},{name:"js.ui.ui",processBefore:!0}],function(c){var d=new c.graphics.Color(0,0,0,0),a=new c.graphics.Color("#EAEB87"),b=ui.config.badTextColor,e="",f=function(a){this.cleanEnd=this.cleanStart=this.elimAccuracyGood=this.playersAliveGood=null;this.AccuracyWarning="";this.state="waiting";this.lastState="";this.fadeOutInTimer=setTimeout(function(){});this.sameStateTimer=setTimeout(function(){});this.lastKnowAutofeedState=
null;f.prototype.parentConstructor.call(this,a);this.parent=a;this.setSize(350,30);this.setClipped(!1);this.setPos(a.size.x-this.size.x-32,32);a=new c.ui.Shape(this,c.ui.squareShape);a.setColor(d);a.setSize(this.size.x,30);this.background=a;a=ui.makeText(this,"Average Autofeed Quality: ",8,0);a.setColor(ui.config.stateFont.color);a.setSize(this.size.x-16,a.size.y);a.centerText();this.mainText=a;a=this.size.x-8;var b=new c.ui.Element(this);b.setBounds(0,0,this.size.x,30);var e=new c.ui.Shape(b,c.ui.squareShape);
e.setColor(new c.graphics.Color(10,25,45));e.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);e.setBounds(0,0,this.size.x,30);b.stats=ui.makeStatBarDisplayAt(b,"ElimAccuracy",8,0,a-8,e.size.y);b.setVisible(!1);this.elimAccuracy=b;b=new c.ui.Element(this);b.setBounds(0,0,this.size.x,30);e=new c.ui.Shape(b,c.ui.squareShape);e.setColor(new c.graphics.Color(10,25,45));e.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);e.setBounds(0,0,this.size.x,30);b.stats=ui.makeStatBarDisplayAt(b,"AliveAccuracy",8,0,a-8,e.size.y);
b.setVisible(!1);this.aliveAccuracy=b;b=new c.ui.Element(this);b.setBounds(0,0,this.size.x,30);e=new c.ui.Shape(b,c.ui.squareShape);e.setColor(ui.config.infoBoxColor);e.setOpacity(ui.config.LOG_BACKGROUND_OPACITY);e.setBounds(0,0,this.size.x,30);b.stats=ui.makeStatBarDisplayAt(b,"cleanEnd",8,0,a-8,e.size.y);b.setVisible(!1);this.cleanEndAccuracy=b;ui.applyTooltip(this,"A display in this corner lets you know how well the automated system sees this stream. A blank display means everything is good.")};
c.utils.inheritClassFrom(f,c.ui.Element);f.prototype.updateDisplay=function(f){var g=this;this.waitingForInfo=!1;if(void 0===f||null===f)console.warn("the autofeed object passed to AutofeedDataAccuracyDisplay.updateDisplay() was undefined or null");else if(0===Object.keys(f).length)console.warn("the autofeedState object passed to AutofeedDataAccuracyDisplay.updateDisplay() was empty");else{this.lastKnowAutofeedState=f;var h=null,l=f?Object.keys(f):null;f&&l&&void 0!==f[l[0]]&&void 0!==f[l[0]].state&&
(h=f[l[0]].state);if(null!==h&&app.settings.watchFor.enabled){this.isVisible()||this.setVisible(!0);truncateValue=function(a){return isNaN(a)||null===a?0:a=a.toFixed(3)};this.elimAccuracy.stats.statValue.setTextValue(truncateValue(h.KillsAccuracy));this.aliveAccuracy.stats.statValue.setTextValue(truncateValue(h.PlayersAliveAccuracy));void 0!==h.TotalGames&&null!==h.TotalGames&&1>h.TotalGames&&(this.waitingForInfo=!0);void 0!==h.CleanEnd&&(this.cleanEnd=null===h.PlayersAliveAccuracy?!1:h.CleanEnd);
void 0!==h.cleanStart&&(this.cleanStart=h.cleanStart);f=30;void 0===h.PlayersAliveAccuracy||null===h.PlayersAliveAccuracy||this.waitingForInfo?(this.playersAliveGood=!1,this.waitingForInfo=!0,this.aliveAccuracy.setVisible(!1)):(this.playersAliveGood=.7<h.PlayersAliveAccuracy?!0:!1,this.aliveAccuracy.setVisible(!this.playersAliveGood),!1===this.playersAliveGood?(this.aliveAccuracy.setPos(0,f),f+=30):this.aliveAccuracy.setVisible(!1));void 0===h.KillsAccuracy||null===h.KillsAccuracy||this.waitingForInfo?
(this.elimAccuracyGood=!1,this.waitingForInfo=!0,this.elimAccuracy.setVisible(!1)):(this.elimAccuracyGood=.8<h.KillsAccuracy?!0:!1,this.elimAccuracy.setVisible(!this.elimAccuracyGood),!1===this.elimAccuracyGood?(this.elimAccuracy.setPos(0,f),f+=30):this.elimAccuracy.setVisible(!1));void 0===peSync.knownGlobalState.roundIsActive||peSync.knownGlobalState.roundIsActive?this.showBadEnd=!1:(this.showBadEnd===this.cleanEnd&&(this.resetState=!0),this.showBadEnd=!this.cleanEnd);this.showBadEnd?(this.cleanEndAccuracy.setVisible(!0),
this.cleanEndAccuracy.stats.statValue.setTextValue("false"),this.cleanEndAccuracy.setPos(0,f),f+=30,e='\n"CleanEnd False" means the system didn\'t see the game over screen at the end of the last game. This may mean a faulty round end in MixGuess.'):(this.cleanEndAccuracy.setVisible(!1),e="");this.state=this.waitingForInfo?"waiting":this.playersAliveGood&&this.elimAccuracyGood?"good":this.playersAliveGood||this.elimAccuracyGood?"poor":"bad";if(this.state!==this.lastState)switch(c.ui.killAnimatorsForElement(this.mainText),
c.ui.killAnimatorsForElement(this.background),clearTimeout(this.fadeOutInTimer),clearTimeout(this.sameStateTimer),this.mainText.setOpacity(1),this.sameStateTimer=setTimeout(function(){"good"===g.state&&(g.resetState=!0)},6E4),this.state){case "waiting":this.mainText.setTextValue("Collecting Autofeed Quality Info...");this.mainText.setColor(ui.config.stateFont.color);this.background.setVisible(!1);ui.applyTooltip(this,"We are collecting info about the quality of this stream. Any errors from the watch system will be reported here.");
break;case "good":this.mainText.setTextValue("Average Autofeed Quality: Good");this.mainText.setColor(ui.config.stateFont.color);this.background.setColor(d);this.background.setVisible(!1);h=new c.ui.Animator(c.ui.Animator.fader,this.mainText);h.setTimer(2);h.setDoneCallback(function(){});h.setStartEnd(0,1);this.fadeOutInTimer=setTimeout(function(){var a=new c.ui.Animator(c.ui.Animator.fader,g.mainText);a.setTimer(2);a.setDoneCallback(function(){});a.setStartEnd(1,0)},7E3);this.showBadEnd?ui.applyTooltip(this,
"Something is wrong with the stream.\n"+e):ui.applyTooltip(this,"Any errors in the watch system will be shown here.");break;case "poor":this.mainText.setTextValue("Average Autofeed Quality: Subpar");this.mainText.setColor(c.graphics.black);this.background.setColor(a);this.background.setVisible(!0);h=new c.ui.Animator(c.ui.Animator.fader,this.background);h.setTimer(1);h.setDoneCallback(function(){});h.setStartEnd(0,1);ui.applyTooltip(this,"Something is wrong with the stream.\n"+(this.playersAliveGood?
"\nelimAccuracy is lower than 0.8. The system is having a hard time reading the number of eliminations in the UI.\n":"\naliveAccuracy is lower than 0.7. The system is having a hard time reading the number of remaining players in the UI.\n")+"\nAccuracy may be low due to poor stream quality, elements blocking or too close to the UI, or UI elements at less than 100% scale.\n"+e);break;case "bad":this.mainText.setTextValue("Average Autofeed Quality: Bad");this.background.setColor(b);this.mainText.setColor(c.graphics.white);
this.background.setVisible(!0);h=new c.ui.Animator(c.ui.Animator.fader,this.background);h.setTimer(1);h.setDoneCallback(function(){});h.setStartEnd(0,1);ui.applyTooltip(this,"Something is wrong with the stream.\n\nelimAccuracy is lower than 0.8. The system is having a hard time reading the number of eliminations in the UI.\n\naliveAccuracy is lower than 0.7. The system is having a hard time reading the number of remaining players in the UI.\n\nAccuracy may be low due to poor stream quality, elements blocking or too close to the UI, or UI elements at less than 100% scale.\n"+
e);break;default:console.log("invalid state in autofeed_data_accuracy_display")}this.lastState=this.state;this.resetState&&(this.resetState=!1,this.lastState=null)}else this.isVisible()&&this.setVisible(!1)}};f.prototype.roundStatusChanged=function(){null!==this.lastKnowAutofeedState&&this.updateDisplay(this.lastKnowAutofeedState)};f.prototype.reposition=function(){this.setPos(this.parent.size.x-this.size.x-32,32)};app.types.AutofeedDataAccuracyDisplay=f});
rat.modules.add("js.ui.customizer",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.ui"],function(c){var d=function(){d.prototype.parentConstructor.call(this);localOnlyBoxColor=c.graphics.white;sharedLocBoxColor=c.graphics.green;var a=c.graphics.SCREEN_WIDTH,b=c.graphics.SCREEN_HEIGHT;this.setSize(a,b);var e=new c.ui.Shape(this);e.setShapeType("rect");e.fitToParentSize();e.setColor(new c.graphics.Color(0,0,0,.6));a=ui.makeText(this,c.string.getString("STR_SETTINGS_CUSTOMIZEUI"),
0,.65*b-ui.config.menuButtonHeight,a,50);a.setFontSize(40);a.setFontStyle("bold");a.setColor("#D0D0D0");a.centerText();this.setModal(!0);this.setAllowBackClose(!0);this.makeProxies(this);this.makeButtons(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.startup=function(){var a=new d;c.screenManager.pushScreen(a);return a};d.proxies=[];d.applyRemotely=!0;d.clearProxies=function(){d.proxies=[]};d.addProxy=function(a){var b=c.graphics.SCREEN_WIDTH,e=c.graphics.SCREEN_HEIGHT,f=a.bounds;void 0===f.w&&
(f.w=f.tw);void 0===f.h&&(f.h=f.th);void 0===f.nw&&(f.nw=f.w/b);void 0===f.nh&&(f.nh=f.h/e);void 0===f.nx&&(f.nx=f.x/b);void 0===f.ny&&(f.ny=f.y/e);d.proxies.push(a)};d.handleProxyChange=function(a){a.elements&&(a=a.elements);for(var b=!1,c=0;c<d.proxies.length;c++){var f=d.proxies[c],g=a[f.name];g&&(g.x||g.y)&&(b=!0,f.bounds.nx=g.x,f.bounds.ny=g.y)}b&&d.changeCallback&&d.changeCallback()};d.calculatePlace=function(a){var b=c.graphics.SCREEN_WIDTH,e=c.graphics.SCREEN_HEIGHT;b={x:void 0!==a.nx?b*a.nx:
a.tx,y:void 0!==a.ny?e*a.ny:a.ty,w:void 0!==a.nw?b*a.nw:a.tw,h:void 0!==a.nh?e*a.nh:a.th};b.scale=a.tw/b.w;void 0!==a.ax&&(b.x=a.ax+b.w/2);void 0!==a.ay&&(b.y=a.ay+b.h/2);return b};d.prototype.myScreenActivate=function(){};d.prototype.myScreenDeactivate=function(){};d.prototype.onWindowResize=function(){};d.prototype.makeButtons=function(a){var b=c.graphics.SCREEN_WIDTH/2,e=.65*c.graphics.SCREEN_HEIGHT;ui.makeButtonAt(a,c.string.getString("STR_MENU_EXIT"),b,e).setCallback(function(a,b){c.screenManager.popScreen();
window.ui.SettingsMenu.open()})};d.prototype.makeProxies=function(a){for(var b=0;b<d.proxies.length;b++){var e=d.proxies[b];if("mod"!==e.bounds.customizerGroup||app.isModMixer()){e.cBounds={x:e.bounds.nx*c.graphics.SCREEN_WIDTH,y:e.bounds.ny*c.graphics.SCREEN_HEIGHT,w:e.bounds.w,h:e.bounds.h};e.cBounds.x-=e.cBounds.w/2;e.cBounds.y-=e.cBounds.h/2;var f=new c.ui.Shape(a);f.setShapeType("rect");f.setBounds(e.cBounds);f.setColor(new c.graphics.Color(255,255,255,.1));void 0===e.bounds.applyRemotely&&(e.bounds.applyRemotely=
d.applyRemotely);f.setStroke(4,e.bounds.applyRemotely?sharedLocBoxColor:localOnlyBoxColor);e.bounds.applyRemotely?ui.applyTooltip(f,c.string.getString("STR_CUSTOMIZE_SHARED")):ui.applyTooltip(f,c.string.getString("STR_CUSTOMIZE_LOCAL"));e.shape=f;e=ui.makeText(f,e.name,0,-25,e.cBounds.w,25);e.setFontSize(25);e.setColor(c.graphics.white)}}};d.prototype.updateSelf=function(a){};d.prototype.drawSelfPost=function(a,b){};d.prototype.getProxyFromPos=function(a){for(var b=0;b<d.proxies.length;b++){var c=
d.proxies[b];if(c.cBounds&&a.x>=c.cBounds.x&&a.y>=c.cBounds.y&&a.x<=c.cBounds.x+c.cBounds.w&&a.y<=c.cBounds.y+c.cBounds.h)return b}return-1};d.prototype.mouseDown=function(a,b){if(!this.tracking){b=this.getProxyFromPos(a);if(0<=b){var c=d.proxies[b];this.tracking={proxyIndex:b,pInfo:c,relativeGrab:{x:a.x-c.cBounds.x,y:a.y-c.cBounds.y}}}return!1}};d.prototype.mouseMove=function(a,b){if(this.tracking)b=a.x-this.tracking.relativeGrab.x,a=a.y-this.tracking.relativeGrab.y,this.tracking.pInfo.cBounds.x=
b,this.tracking.pInfo.cBounds.y=a,this.tracking.pInfo.shape.setPos(b,a);else for(a=this.getProxyFromPos(a),b=0;b<d.proxies.length;b++){var c=d.proxies[b];if(c.shape){var f=c.bounds.applyRemotely?sharedLocBoxColor:localOnlyBoxColor;b===a?c.shape.setStroke(8,f):c.shape.setStroke(4,f)}}return!1};d.prototype.mouseUp=function(a,b){if(this.tracking)return a=this.tracking.pInfo,this.applyChanges(a.name,{x:(a.cBounds.x+a.cBounds.w/2)/c.graphics.SCREEN_WIDTH,y:(a.cBounds.y+a.cBounds.h/2)/c.graphics.SCREEN_HEIGHT},
a.bounds.applyRemotely),this.tracking=null,!1};d.prototype.applyChanges=function(a,b,c){c?peSync&&(c={},peSync.sendUXMessage({code:"customize",uxState:(c[a]=b,c)})):(c={},d.handleProxyChange((c[a]=b,c)))};d.prototype.handleKeyDown=function(a){return!1};app.types.Customizer=d});
rat.modules.add("js.ui.one_string_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string","rat.ui.r_ui_listbox","rat.ui.r_ui_edittext","rat.ui.r_ui_domedittext",{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(a,b,e,f){d.prototype.parentConstructor.call(this);this.acceptCallback=e;this.cancelCallback=f;this.setSize(850,500);this.centerInDisplay();e=this.getPos();this.setPos(e.x+32,e.y+32);ui.makeStandardModPopupBackground(this);this.setModal(!0);this.setAllowClickAway(!0);
ui.makeTitleBox(this,a);this.editDiv=c.graphics.layerDiv.make(app.canvasElement);this.makeStringUI(b);this.makeButtons()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.prototype.makeStringUI=function(a){var b=new c.ui.DOMEditText(this,this.editDiv,{className:"myInputBox"});b.setTextValue(a);b.setPos(100,160);b.setSize(650,50);ui.setFontProperties(b,ui.config.labelFont);
b.setTextChangeCallback(function(a,b){});b.getDOMElement().focus();return this.editBox=b};d.prototype.keyDown=function(a){if(a.which===c.keys.enter)return this.doAccept(),this.close(),!0;if(a.which===c.keys.esc)return this.doCancel(),this.close(),!0};d.prototype.makeButtons=function(a){a=this;var b=this.getSize(),c=b.x/2,d=b.y-90;c=ui.makeButtonAt(a,"OK",c,d);c.setCallback(function(b,c){a.doAccept();a.close();return!0});c=b.x/2;d=b.y-180;c=ui.makeButtonAt(a,"Cancel",c,d);c.setCallback(function(b,
c){a.doCancel();a.close();return!0})};d.prototype.doAccept=function(){var a=this.editBox.getDOMElement().value;this.acceptCallback&&this.acceptCallback(a)};d.prototype.doCancel=function(){this.cancelCallback&&this.cancelCallback()};d.prototype.close=function(){c.screenManager.popScreen(self)};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"onestring screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"onestring screen deactivated.")};
d.prototype.onWindowResize=function(){this.centerInDisplay()};d.prototype.updateSelf=function(a){};d.make=function(a,b,e,f){a=new d(a,b,e,f);c.screenManager.pushScreen(a)};window.ui.OneStringScreen=d});
rat.modules.add("js.utils.utils",[],function(c){var d={deepObjectToArrayChecked:function(a){if(null==a||"string"===typeof a||"number"===typeof a||"boolean"===typeof a)return a;var b=!0===a._isArray,c=Object.keys(a).length-(b?1:0);if(!0===b){delete a._isArray;for(var f=0;f<c;f++)if(void 0===a[f]){b=!1;console.error("An object meant to be an array is missing an index: "+f);break}}f=$jscomp.makeIterator(Object.keys(a));for(var g=f.next();!g.done;g=f.next())g=g.value,a[g]=d.deepObjectToArrayChecked(a[g]);
return!0===b?(a.length=c,Array.from(a)):a}};window.utils=d});
rat.modules.add("js.ui.edit_offer_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.ui.r_ui_droplist","js.ui.ui","js.ui.favorites_screen","rat.graphics.r_layer_div","rat.ui.r_ui_domedittext","js.data.offer_lists"],function(c){function d(a){var b=a.value;if(!b||""===b)return 0;b.includes(":")?(4<b.length?(b=b.replace(/:/g,""),b=b.slice(0,2)+":"+b.slice(2)):4===b.length?(b=b.replace(/:/g,""),b=b.slice(0,1)+":"+b.slice(1)):3===b.length?(b=b.replace(/:/g,""),b=":"+b):2===b.length&&(b=b.replace(/:/g,
"")),a.value=b):2===b.length&&(b=":"+b,a.value=b);b.includes(":")?(b=b.split(":"),""===b[0]&&(b[0]=0),a=parseInt(b[0]),b=parseInt(b[1]?b[1]:0),a=60*a+b):a=parseInt(b);isNaN(a)&&(a=0);return a}function a(a){a=a.value;if(!a||""===a)return 0;a=parseInt(a);isNaN(a)&&(a=0);return a}var b=[],e=0,f={x:40,y:110,w:300,h:50},g={x:360,y:110,w:300,h:50},k={x:70,y:200,w:400,h:140},h={x:635,y:200,w:95,h:44},l={x:635,y:300,w:95,h:44},m={x:500,y:300,w:120,h:50},n={x:210,y:416,w:180,h:44},t={x:610,y:416,w:80,h:44},
p=function(a,c){p.prototype.parentConstructor.call(this);this.remoteCancel=!1;app.settings.storedEdits&&Array.isArray(app.settings.storedEdits)&&0<app.settings.storedEdits.length&&(b=app.settings.storedEdits);app.offerLists.restoreSaved();this.setSize(800,750);this.centerInDisplay();this.setModal(!0);this.setAllowClickAway(!0);ui.makeStandardModPopupBackground(this);this.inputCount=this.timer=0;this.slotIndex=a;this.existingOffer=c;this.titleBox=ui.makeLabel(this,"Edit Offer "+(a+1),10,5,800,50);
this.makeFormattingHelp();this.inputBoxes=[];this.inputIndex=0;b[a]||(b[a]={});if(c)var e=c.name;else(e=b[a].name)||(e="Will [Streamer] get a *kill* in [time]?");this.makeMainEditBox(e);this.makeTimerUI(c);this.makeSummaryUI(c);this.makeMultiplierUI(c);this.makeButtons();this.makePreviewPane(a);this.makePresetUI();this.makeFavoritesButton();this.makeMainHelpButton()};c.utils.inheritClassFrom(p,c.ui.Screen);p.curScreen=null;p.prototype.start=function(){this.existingOffer?peSync.sendEditingOffer({slotIndex:this.slotIndex}):
peSync.sendCreatingOffer({slotIndex:this.slotIndex})};p.prototype.handleCancel=function(){this.existingOffer||!1===this.remoteCancel&&peSync.sendCancelCreatingOffer({slotIndex:this.slotIndex})};p.prototype.destroy=function(){this.existingOffer&&peSync.sendCancelEditingExistingOffer({slotIndex:this.slotIndex});app.canvasElement.focus();this.deleteEditBox();this.deletePreviewPane();this.sentOffer||this.handleCancel()};p.prototype.applyOfferValues=function(a){a.name&&(this.inputBox.value=a.name);a.lockTimer&&
(this.lockTimerBox.value=ui.toTime(ui.timeValToSecond(a.lockTimer)));a.betTimer&&(this.betTimerBox.value=ui.toTime(ui.timeValToSecond(a.betTimer)));a.summary&&(this.summaryBox.value=a.summary);a.multiplier?this.multiplierBox.value=""+a.multiplier:""===this.multiplierBox.value&&(this.multiplierBox.value="3");this.needPreviewUpdate=!0};p.prototype.storeValues=function(){var c=b[this.slotIndex],e=this.inputBox.value;e&&(c.name=e);if(this.lockTimerBox.value||!this.existingOffer)c.lockTimer=this.lockTimerBox.value;
if(this.betTimerBox.value||!this.existingOffer)c.betTimer=this.betTimerBox.value;c.summary=this.summaryBox.value;c.multiplier=a(this.multiplierBox);app.offerLists.addToRecentList(c);app.settings.storedEdits=b;app.writeSettings()};p.prototype.collectContent=function(){var b={slotIndex:this.slotIndex},c=this.inputBox.value;c&&(c=c.replace(/^\s+|\s+$/g,""),""!=c&&(b.name=c));var e=this.summaryBox.value;!e&&c&&(e=this.extractSummary(c));e||(e=void 0);b.summary=e;c=a(this.multiplierBox);b.multiplier=c;
c=d(this.betTimerBox);e=d(this.lockTimerBox);var f=0;this.existingOffer&&(f=(peSync.serverTimestampEstimated-this.existingOffer.timeCreated)/1E3);0<c&&(b.betTimer=c+f);0<e&&(b.lockTimer=e+f);return b};p.prototype.doAccept=function(){this.storeValues();var a=this.collectContent();a&&a.name&&("0"===this.lockTimerBox.value&&(a.lockTimer=null),"0"===this.betTimerBox.value&&(a.betTimer=null),this.existingOffer?(a.offerID=this.existingOffer.offerID,peSync.sendModifyOffer(a)):peSync.sendNewOffer(a),this.sentOffer=
!0);c.screenManager.removeScreen(this)};p.prototype.doCancel=function(a){c.screenManager.removeScreen(this)};p.prototype.extractSummary=function(a){if(a){var b=a.indexOf("*");if(-1<b){var c=a.indexOf("*",b+1);if(-1<c)return a.substring(b+1,c)}}return null};p.prototype.makePreviewPane=function(a){var b=app.types.OfferPane;a=game.hud.offerHolder.makeSlotOffer(a);var c=a.getContainer();a.setPreviewMode();var e=c.getPos();e=game.hud.offerHolder.getGlobalPos(e);e.x=b.offerPaneWidth/2+b.previewShiftX;game.hud.appendSubElement(c);
c.setPos(e);this.previewPane=a;this.updatePreviewPane()};p.prototype.deletePreviewPane=function(){this.previewPane&&(this.previewPane.removeMe(),this.previewPane=null)};p.prototype.updatePreviewPane=function(){var a=this.previewPane;if(a){var b=this.collectContent();b&&(b.name||(b.name=" "),b.summary||(b.summary=" "),b.timeCreated=this.existingOffer?this.existingOffer.timeCreated:peSync.serverTimestampEstimated,b.isLocked=!1,this.existingOffer&&(b.betTimer||(b.betTimer=this.existingOffer.betTimer),
b.lockTimer||(b.lockTimer=this.existingOffer.lockTimer)),a.setOfferDetails(b,null,!1,!1))}};p.prototype.makePresetUI=function(a){var b=this;ui.makeLabel(this,"presets",360,60,300,50).setFontSize(26);var c=[],d=[];if(a=peSync.getOfferOptions()){catIndex=Math.min(e,a.length-1);for(var h=a[catIndex].data.offers,k=0;k<h.length;k++){var l=h[k],m=l.label||l.summary;m||(m=this.extractSummary(l.name));m||(m="preset "+(k+1));d.push(l);c.push(m)}}h=b.presetDropList=b.makeSingleDropDown(f,{x:f.x+(f.w-64),y:f.y,
w:64,h:f.h},c,function(a){b.applyOfferValues(d[a])});k=h.getButton();ui.applyTooltip(k,"Fill settings from a preset offer");h.setCurrentItem(0);k.getTextBox().setVisible(!1);k.getBounds();var q=[];if(a){h=a;for(k=0;k<h.length;k++)a=h[k],(m=a.data.label||a.filename)||(m="group "+k),q.push(m);q.push("(upload new...)")}a=b.catDropList=b.makeSingleDropDown(g,null,q,function(a){a>=q.length-1?(b.uploadNewPreset(),b.catDropList.setCurrentItem(e)):(e=a,b.rebuildPresetUI())});ui.applyTooltip(a.getButton(),
"Choose a category of preset offers");a.setCurrentItem(e)};p.prototype.makeSingleDropDown=function(a,b,e,d){var f=this;b=b||a;var g=new c.ui.DropList(this);g.setBounds(a);g.buildFromListText(e,{fontName:ui.config.pulldownListFont.font,fontHeight:46,selectCallback:d,listShowCallback:function(a,b,c){f.updateEditDivVisibility();ui.setDropButtonState(h,b?"open":closed)},listColorStates:ui.pullDownColorStatesMod,listOffset:{x:0,y:10}});a=b.w+24;e=b.h+24;var h=ui.makeDropButtonAt(f,"",0,0,a,e);h.setBounds(b.x-
12,b.y-12,a,e);ui.setStandardButtonProperties(h,ui.config.BUTTON_MOD);ui.setDropButtonState(h,"closed");g.replaceButton(h);h.getTextBox().setWidth(b.w-60);return g};p.prototype.rebuildPresetUI=function(){this.presetDropList&&(this.presetDropList.hideListBox(),this.removeSubElement(this.presetDropList));this.catDropList&&(this.catDropList.hideListBox(),this.removeSubElement(this.catDropList));this.makePresetUI(this.existingOffer)};p.prototype.configStateChange=function(){this.rebuildPresetUI()};p.prototype.updateEditDivVisibility=
function(){if(this.editDiv){var a=this.presetDropList&&this.presetDropList.listBoxIsVisible()||this.catDropList&&this.catDropList.listBoxIsVisible(),b=c.screenManager.isTopScreen(this);this.editDiv.style.visibility=a||!b?"hidden":"visible"}};p.prototype.makeFormattingHelp=function(){for(var a=c.ui.TextBox.specialCharacter,b=c.ui.TextBox.specialPushColorCode,e=c.ui.TextBox.specialPopColorCode,d="format chars: ",f=ui.formatMap,g=0;g<f.length;g++){var h=f[g].color;h=String.fromCharCode(h.r,h.g,h.b);
d+=a+b+h+f[g].formatChar+a+e}a=this.formatHelpBox=ui.makeLabel(this,d,70,350,400,50);a.setFontSize(28);a.setAlignment("right");a.enableDefaultSpecialFormatting()};p.prototype.makeFavoritesButton=function(){var a=this,b=ui.makeButtonAt(this,"",760,130,ui.config.smallButtonWidth,ui.config.smallButtonHeight),e=new c.ui.Sprite(b);e.useImageRef(gfx.getImage("icon_favorites"));e.setPos(b.size.x/2,b.size.y/2);b.setCallback(function(){a.showFavorites()});ui.setStandardButtonProperties(b,ui.config.BUTTON_MOD);
ui.applyTooltip(b,"access list of favorite/recent offers")};p.prototype.makeMainHelpButton=function(){var a=ui.makeButtonAt(this,"",760,40,ui.config.smallButtonWidth,ui.config.smallButtonHeight),b=new c.ui.Sprite(a);b.useImageRef(gfx.getImage("mod_help_icon"));b.setPos(a.size.x/2,a.size.y/2);a.setCallback(function(){app.mixer.openWindowWithLocalContent("web_docs/mod_reference.html")});ui.setStandardButtonProperties(a,ui.config.BUTTON_MOD);ui.applyTooltip(a,"Get a lot more help in another window")};
p.prototype.uploadNewPreset=function(){inputBox=document.createElement("input");inputBox.type="file";inputBox.accept=".json";inputBox.addEventListener("change",function(a){if(a=a.target.files[0]){var b=new FileReader;b.onload=function(a){a=JSON.parse(a.target.result);peSync.addLocalPresetFile(a)};b.readAsText(a)}},!1);inputBox.click()};p.prototype.showFavorites=function(){ui.FavoritesScreen.make(app.offerLists,this)};p.prototype.makeMainEditBox=function(a){a=this.makeEditBox(a,k);var b=a.domElement;
b.maxLength=128;b.inputIndex=this.inputCount++;ui.applyTooltip(a.ratElement,"Offer description shown to players");b.focus();b.select();this.inputBox=b};p.prototype.makeTimerUI=function(a){var e="",d="";a||(e=b[this.slotIndex].lockTimer,void 0===e&&(e="1:00"),d=b[this.slotIndex].betTimer,void 0===d&&(d="2:00"));a=ui.makeLabel(this,"lock bets\ntimer",500,200,120,50);a.setFontSize(26);a=new c.ui.Sprite(this);a.useImageRef(gfx.getImage("icon_clock_lock"));a.setPos(750,h.y+15);e=this.makeEditBox(e,h,"input");
a=e.domElement;a.maxLength=5;a.inputIndex=this.inputCount++;this.lockTimerBox=a;ui.applyTooltip(e.ratElement,"The time players have to make a guess");a=ui.makeLabel(this,"end offer\ntimer",m);a.setFontSize(26);a=new c.ui.Sprite(this);a.useImageRef(gfx.getImage("icon_clock"));a.setPos(750,l.y+15);e=this.makeEditBox(d,l,"input");d=e.domElement;d.maxLength=5;d.inputIndex=this.inputCount++;this.betTimerBox=d;ui.applyTooltip(e.ratElement,"When we expect to resolve the offer")};p.prototype.makeSummaryUI=
function(a){startValue=a&&a.summary||b[this.slotIndex].summary||"";ui.makeLabel(this,"Summary",70,420,120,50).setFontSize(26);a=this.makeEditBox(startValue,n,"input");var c=a.domElement;c.maxLength=20;c.inputIndex=this.inputCount++;this.summaryBox=c;ui.applyTooltip(a.ratElement,"The summary shows up when the offer is minimized")};p.prototype.makeMultiplierUI=function(a){(startValue=a&&a.multiplier||b[this.slotIndex].multiplier||0)||(startValue="3");ui.makeLabel(this,"Multiplier",470,420,120,50).setFontSize(26);
a=this.makeEditBox(startValue,t,"input");var c=a.domElement;c.maxLength=2;c.inputIndex=this.inputCount++;this.multiplierBox=c;ui.applyTooltip(a.ratElement,"How much reward the player earns")};p.prototype.makeEditBox=function(a,b,e){e=e||"textarea";var d=this,f=this.editDiv;f||(f=this.editDiv=c.graphics.layerDiv.make(app.canvasElement));e=new c.ui.DOMEditText(d,this.editDiv,{class:e,className:"myInputBox"});e.setTextValue(a);a=e.getDOMElement();e.setPos(b.x,b.y);e.setSize(b.w,b.h);b={ratElement:e,
domElement:a};this.inputBoxes.push(b);e.setTextChangeCallback(function(a,b){d.needPreviewUpdate=!0});e.setFocusCallback(function(a){a.target&&void 0!==a.target.inputIndex&&(d.inputIndex=a.target.inputIndex)});return b};p.prototype.deleteEditBox=function(){this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};p.prototype.makeButtons=function(){var a=this,b=this.getSize(),c=b.x/2-ui.config.buttonWidth/2-ui.config.buttonGap;b=b.y-140;var e=ui.makeButtonAt(a,"Offer",c,b);
e.setCallback(function(b,c){a.doAccept();return!0});ui.applyTooltip(e,"Create this offer for players to act on");ui.setStandardButtonProperties(e,ui.config.BUTTON_MOD);app.connected||(e.setEnabled(!1),ui.applyTooltip(e,"Offers can't be given while disconnected from Mixer"));c+=ui.config.buttonWidth+ui.config.buttonGap;e=ui.makeButtonAt(a,"Cancel",c,b);e.setCallback(function(b,c){a.doCancel(!1);return!0});ui.applyTooltip(e,"Cancel editing this offer");ui.setStandardButtonProperties(e,ui.config.BUTTON_MOD);
this.cancelButton=e;e=ui.makeButtonAt(a,"Save (No Offer)",c,b+80);e.setCallback(function(b,c){a.storeValues();a.doCancel(!1);return!0});ui.applyTooltip(e,"Save these settings for later, but don't create this offer");ui.setStandardButtonProperties(e,ui.config.BUTTON_MOD)};p.prototype.screenActivate=function(){p.curScreen=this};p.prototype.screenDeactivate=function(){p.curScreen=null};p.prototype.movedToBackground=function(){this.updateEditDivVisibility()};p.prototype.movedToForeground=function(){this.updateEditDivVisibility()};
p.prototype.onWindowResize=function(){this.centerInDisplay();c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(var a=0;a<this.inputBoxes.length;a++)this.inputBoxes[a].ratElement.updateDOMPlacement()};p.prototype.updateSelf=function(a){var b=this.timer;this.timer+=a;(4*b|0)!==(4*this.timer|0)&&this.existingOffer&&(this.needPreviewUpdate=!0);this.needPreviewUpdate&&(this.updatePreviewPane(),this.needPreviewUpdate=!1);this.formatHelpBox.setVisible(document.activeElement===this.inputBox)};
p.prototype.drawSelfPost=function(a,b){};p.prototype.keyDown=function(a){if(a.which===c.keys.enter&&!a.sysEvent.shiftKey)return this.doAccept(),!0;if(a.which===c.keys.esc)return this.doCancel(),!0;if(a.which===c.keys.tab){var b=1;a.sysEvent.shiftKey&&(b=-1);this.inputIndex=(this.inputIndex+b+this.inputCount)%this.inputCount;this.inputBoxes[this.inputIndex].domElement.focus();this.inputBoxes[this.inputIndex].domElement.select()}return a.allowBrowserDefault=!0};p.makeNew=function(a,b){a=new p(a,b);
c.screenManager.pushScreen(a);a.start();return a};app.types.EditOfferScreen=p});
rat.modules.add("js.ui.resolve_offer_screen",[{name:"rat.ui.r_screen",processBefore:!0},"js.ui.ui"],function(c){var d=function(a,b){function e(a,b,c,e){a=ui.makeButtonAt(f,a,b,c,ui.config.buttonWidth,ui.config.smallModButtonHeight,ui.config.BUTTON_MOD);a.setCallback(e);return a}d.prototype.parentConstructor.call(this);var f=this;this.slotIndex=a;this.offerDetails=b;this.controlArray=[];this.remoteCancel=!1;f.setSize(600,580);var g=ui.makeStandardPopupBackground(f);g.setColor("black");g.setStroke(5,
ui.config.BUTTON_MOD.normal.textColor);f.centerInDisplay();this.inputBoxes=[];this.inputIndex=0;f.setModal(!0);f.setAllowClickAway(!0);f.setAllowBackClose(!0);this.titleBox=ui.makeTitleBox(f,ui.formatText(c.string.getString("STR_RESOLVE_OFFER")+" "+(a+1)));this.titleBox.enableDefaultSpecialFormatting();this.titleBox.setColor("white");var k=b.betOptions?b.betOptions:["STR_ACTION_YES","STR_ACTION_NO"];xPos=f.size.x/2;yPos=152;a=!0===k[0].startsWith("STR_")?c.string.getString(k[0]):k[0];e(a,xPos,yPos,
function(a,b){f.doResolve(k[0]);return!0});xPos=f.size.x/2;yPos+=96;a=!0===k[0].startsWith("STR_")?c.string.getString(k[1]):k[1];e(a,xPos,yPos,function(a,b){f.doResolve(k[1]);return!0});xPos=f.size.x/2-64;yPos+=96;this.refundButton=e(c.string.getString("STR_REFUND"),xPos,yPos,function(a,b){f.doResolve("refund");return!0});xPos=this.refundButton.getPosX()+this.refundButton.size.x+8;this.editMultiBox=ui.makeTextValueBox(this,c.string.getString("STR_REFUND_MULTIPLIER"),{defaultText:"1",tooltip:c.string.getString("STR_REFUND_MULTIPLIER_TOOLTIP")},
112);this.editMultiBox.tBox.setColor(ui.config.BUTTON_MOD.normal.textColor);this.editMultiBox.setPos(xPos,yPos-ui.config.buttonHeight/2-18);this.editMultiBox.updatePos();this.controlArray.push(this.editMultiBox);xPos=32;yPos+=50;this.reasonBox=ui.makeTextValueBox(this,c.string.getString("STR_REFUND_REASON_TEXT"),{defaultText:"",tooltip:c.string.getString("STR_REFUND_REASON_TEXT_TOOLTIP")},this.size.x-64);this.reasonBox.tBox.setColor(ui.config.BUTTON_MOD.normal.textColor);this.reasonBox.setPos(xPos,
yPos);this.reasonBox.updatePos();this.controlArray.push(this.reasonBox);xPos=32;yPos+=60;a=ui.makeButtonAt(f,c.string.getString("STR_CANCEL"),300,530,null,null,ui.config.BUTTON_MOD);a.setCallback(function(a,b){c.screenManager.removeScreen(f);return!0});this.exitButton=a};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.start=function(){peSync.sendResolvingOffer({slotIndex:this.slotIndex,offerID:this.offerDetails.offerID})};d.prototype.handleCancel=function(){!1===this.remoteCancel&&(game.hud.offerHolder.getOfferPane(this.slotIndex).timeUp?
peSync.sendCancelResolvingOffer({slotIndex:this.slotIndex,offerID:this.offerDetails.offerID,messageNameOnly:!0}):peSync.sendCancelResolvingOffer({slotIndex:this.slotIndex,offerID:this.offerDetails.offerID,messageNameOnly:!1}))};d.prototype.doResolve=function(a){var b=this.editMultiBox.value;b=isNaN(b)||1>b?1:Math.round(b);var e=this.reasonBox.value;1<b&&(void 0===e||null===e||""===e)&&(e=""+c.string.getString("STR_REFUND_REASON_AMOUNT")+b);!1===this.remoteCancel&&(peSync.sendResolveOffer({slotIndex:this.slotIndex,
offerID:this.offerDetails.offerID,resolution:a,why:e,additionalMultiplier:b}),this.sentResult=!0,c.screenManager.removeScreen(this))};d.prototype.doCancel=function(a){this.remoteCancel=void 0===a?!1:a;c.screenManager.removeScreen(this)};d.prototype.destroy=function(){this.sentResult||this.handleCancel();app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.prototype.close=function(){c.screenManager.popScreen(self)};d.open=function(){this.screen?
c.screenManager.pushScreen(this.screen):this.screen=new EditReason};d.prototype.myScreenActivate=function(){};d.prototype.myScreenDeactivate=function(){};d.prototype.onWindowResize=function(){this.centerInDisplay();console.log("resolve offer resize");c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(var a=0;a<this.controlArray.length;a++)this.controlArray[a].updatePos&&(console.log("check passed"),this.controlArray[a].updatePos())};d.prototype.updateSelf=function(a){};d.prototype.drawSelfPost=
function(a,b){};d.makeNew=function(a,b){a=new d(a,b);c.screenManager.pushScreen(a);a.start();return a};app.types.ResolveOfferScreen=d});
rat.modules.add("js.ui.keyword_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string","rat.ui.r_ui_listbox","rat.ui.r_ui_edittext","rat.ui.r_ui_domedittext",{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(){d.prototype.parentConstructor.call(this);this.setSize(800,950);this.centerInDisplay();var a=this.getPos();this.setPos(a.x+32,a.y+32);ui.makeStandardModPopupBackground(this);this.setModal(!0);this.setAllowClickAway(!0);this.editDiv=c.graphics.layerDiv.make(app.canvasElement);
this.inputBoxes=[];this.inputIndex=0;this.changed=!1;this.makeKeywordUI();this.makeButtons()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.prototype.makeKeywordUI=function(a,b){ui.makeLabel(this,"keywords",50,24,200,36);a=this.keywordBox=new c.ui.ScrollView(this);a.setBounds(50,60,700,600);a.setFrame(5,ui.config.modPopBorderColor);this.curYPos=10;a=[];b=peSync.knownGlobalState.keywords;
for(var e in b){var d={keyword:e,value:b[e]};if("streamer"===e||"game"===e||"credits"===e)d.builtIn=!0;a.push(d)}a.sort(function(a,b){return a.builtIn?-1:a.keyword-b.keyword});for(e=0;e<a.length;e++)this.addOneRow(a[e]);this.rows=a;this.selectFirst()};d.prototype.addOneEditBox=function(a){var b=this,e=this.inputBoxes.length,d=new c.ui.DOMEditText(this.keywordBox,this.editDiv,{className:"keywordInputBox"});d.setTextValue(a);ui.setFontProperties(d,ui.config.labelFont);d.inputIndex=e;d.setTextChangeCallback(function(a,
b){});d.setFocusCallback(function(a){a.target&&(b.inputIndex=e)});a={ratElement:d,domElement:d.getDOMElement(),inputIndex:e};this.inputBoxes.push(a);return d};d.prototype.addOneRow=function(a){var b=this.curYPos;if(a.builtIn){var c=ui.makeLabel(this.keywordBox,a.keyword,10,b+5,300,36);c.setAlignment("right");c.setColor("#808080")}else c=this.addOneEditBox(a.keyword),c.setPos(10,b),c.setSize(300,36);var d=this.addOneEditBox(a.value);d.setPos(350,b);d.setSize(300,36);a.labelBox=c;a.valueBox=d;this.curYPos+=
50;this.keywordBox.setContentSize(this.keywordBox.getWidth(),this.curYPos)};d.prototype.selectFirst=function(){var a=this.rows[0].valueBox.getDOMElement();a.focus();a.select()};d.prototype.selectRow=function(a){a=this.rows[a];a=a.labelBox.getDOMElement?a.labelBox.getDOMElement():a.valueBox.getDOMElement();a.focus();a.select()};d.prototype.keyDown=function(a){if(a.which===c.keys.enter)return this.saveValues(),this.close(),!0;if(a.which===c.keys.esc)return this.close(),!0;if(a.which===c.keys.tab){var b=
1;a.sysEvent.shiftKey&&(b=-1);a=this.inputBoxes.length;this.inputIndex=(this.inputIndex+b+a)%a;this.inputBoxes[this.inputIndex].domElement.focus();this.inputBoxes[this.inputIndex].domElement.select()}};d.prototype.makeButtons=function(a){a=this;var b=this.getSize(),c=b.x/2,d=b.y-90;c=ui.makeButtonAt(a,"Done",c,d);c.setCallback(function(b,c){a.saveValues();a.close();return!0});c=b.x/2;d=b.y-180;c=ui.makeButtonAt(a,"New Keyword",c,d);c.setCallback(function(b,c){b={keyword:"keyword",value:"value"};a.rows.push(b);
a.addOneRow(b);a.selectRow(a.rows.length-1);return!0})};d.prototype.saveValues=function(){for(var a=peSync.knownGlobalState.keywords,b=0;b<this.rows.length;b++){var c=this.rows[b];c.builtIn||(d=c.labelBox.getTextValue(),d=d.trim(),c.keyword&&c.keyword!==d&&(this.changed=!0,a[c.keyword]=null))}for(b=0;b<this.rows.length;b++){c=this.rows[b];var d=c.labelBox.getTextValue();d&&(c=c.valueBox.getTextValue(),c!==a[d]&&(this.changed=!0,a[d]=c))}this.changed&&peSync.sendMessageWithCode("set_all_keywords",
{keywords:a})};d.prototype.close=function(){c.screenManager.popScreen(self)};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"keyword screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"keyword screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay()};d.prototype.updateSelf=function(a){};d.make=function(){var a=new d;c.screenManager.pushScreen(a)};window.ui.KeywordScreen=d});
rat.modules.add("js.ui.toggle_control",[{name:"rat.ui.r_ui",processBefore:!0},"js.ui.ui"],function(c){var d=function(a,b,e,f,g,k){var h=this;k=void 0===k?"Toggles Shiz":k;d.prototype.parentConstructor.call(this,a);a=e.x;e=e.y;this.x=a;this.y=e;this.setSize(ui.config.TOGGLE_CONTROL_W,ui.config.TOGGLE_CONTROL_H);this.setPos(a,e);this.pane=this;e=new c.ui.Shape(this,c.ui.squareShape);e.setColor(ui.config.popBorderColor);e.setSize(this.size.x,this.size.y);e=new c.ui.Shape(this,c.ui.roundRectShape);e.setColor("#091728");
e.setSize(378,62);e.setPos(this.pane.size.x-e.size.x-10,this.pane.size.y/2-e.size.y/2);e.cornerRadius=ui.config.buttonCornerRadius;b=ui.makeButtonAt(this,b,ui.config.menuButtonWidth/2+4,this.pane.size.y/2,ui.config.menuButtonWidth,ui.config.menuButtonHeight);b.setCallback(function(){var a=f.callback(f.param);h.updateDisplay(a)});ui.applyTooltip(b,c.string.getString(k));this.toggleButton=b;sprite=new c.ui.Sprite(this);sprite.useImageRef(gfx.getImage("toggle_light_off"));sprite.setPos(this.toggleButton.getPosX()+
this.toggleButton.size.x-12,this.pane.size.y/2-sprite.size.y/2);this.light=sprite;this.statusImage=sprite=new c.ui.Element(this);k=ui.makeText(this,"ON",this.light.getPosX()+this.light.size.x-18,0,70,this.size.y,ui.config.toggleFont);k.centerText();this.statusText=k;this.updateDisplay(g)};c.utils.inheritClassFrom(d,c.ui.Element);d.prototype.updateDisplay=function(a){a?this.setOn():this.setOff()};d.prototype.setOn=function(){this.statusText.setTextValue("ON");this.statusText.setColor(new c.graphics.Color(235,
112,255));this.light.useImageRef(gfx.getImage("toggle_light_on"))};d.prototype.setOff=function(){this.statusText.setTextValue("OFF");this.statusText.setColor(new c.graphics.Color(115,58,170));this.light.useImageRef(gfx.getImage("toggle_light_off"))};d.prototype.trigger=function(a){this.toggleButton.press();d.prototype.parentPrototype.trigger.call(this,a)};d.prototype.getTargetObject=function(){return this.toggleButton};app.types.ToggleControl=d});
rat.modules.add("js.ui.settings_sub_menu",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.toggle_control","js.ui.settings_menu"],function(c){var d=function(a,b,e){this.offset=e||{x:64,y:64};d.prototype.parentConstructor.call(this);this.setSize(1048,980);this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=
ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);this.setAllowClickAway(!0);"xbox"===app.platform&&this.setAllowBackClose(!0);this.makeButtons(b);c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=function(){c.screenManager.removeScreen(this)};d.prototype.makeButtons=function(a){var b=this;window.ui.SettingsMenu.addControls(a,this);a=c.string.getString("STR_HELP_CLOSE");a=ui.makeText(this,a,16,this.size.y-
ui.config.buttonHeight,this.size.x-32,ui.config.buttonHeight);a.setAlignment("right");a.enableDefaultSpecialFormatting();a.setVisible(!1);this.closePrompt=a;!0===game.hud.useButtonIcons&&a.setVisible(!0);a=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),this.size.x/2,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(a,"Close this menu");a.setCallback(function(){b.controlArray.forEach(function(a){"function"===typeof a.paneAutoSaveContentOnExit&&
a.paneAutoSaveContentOnExit()});b.closeScreen()});this.autoBuildInputMap(!0,!0,2,4);window.ui.SettingsMenu.setDefaultTarget(this,this.controlArray)};d.prototype.onRebuild=function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();this.setPos(this.getPosX()+
this.offset.x,this.getPosY()+this.offset.y);this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(i=0;i<this.controlArray.length;i++)this.controlArray[i].updatePos&&this.controlArray[i].updatePos()};d.prototype.updateSelf=function(a){c.screenManager.screenStack.length!==this.lastScreenStackLength&&(this.editDiv&&(c.screenManager.isTopScreen(this)?this.editDiv.style.visibility="visible":this.editDiv.style.visibility="hidden"),this.lastScreenStackLength=c.screenManager.screenStack.length);
a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=function(){!0===game.hud.useButtonIcons?"web"===app.platform&&this.closePrompt.setVisible(!0):"web"===app.platform&&this.closePrompt.setVisible(!1)};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;
switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.exitButton.trigger(),!0}return!1};d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.open=function(a,b,c){new d(a,b,c)};window.ui.SettingsSubMenu=d});
rat.modules.add("js.ui.customize_player_action_menu",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.player_action_menu","js.ui.customize_player_action_button_screen"],function(c){var d=function(a){d.prototype.parentConstructor.call(this);this.actionButtonsRef=a;a=c.string.getString("STR_CUSTOMIZE_PLAYER_ACTION_TITLE");this.setSize(984,560);this.centerInDisplay();this.setPos(this.getPosX(),this.getPosY()-16);
this.lastKnownSparkBoardActive=app.settings.sparkBoardActive;this.lastKnownRoundActive=peSync.knownGlobalState.roundIsActive;this.onlyDuringRoundButtons=[];this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.setPos(this.titleBox.getPosX(),this.titleBox.getPosY()-16);this.setModal(!0);this.setAllowClickAway(!0);this.makeButtons();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=function(){c.screenManager.removeScreen(this)};
d.prototype.placeButtons=function(a){var b=72,c=32,d=(this.size.x-64)/3,g=d-ui.config.sparkButtonWidth+ui.config.sparkButtonHeight+ui.config.sparkButtonHeight/4+8;for(i=0;i<a.length;i++)0===i%3&&0!==i&&(c=32,b+=g),a[i].setPos(c,b),c+=d,a[i].butGlobalPos=a[i].getGlobalPos(),a[i].setVisible(!0);this.setSize(this.size.x,b+ui.config.sparkButtonHeight+g-16);this.backgroundBox.fitToParentSize();this.centerInDisplay();this.setPos(this.getPosX(),this.getPosY()-16)};makeCustomizeButton=function(a,b){var e=
app.settings.playerActionButtons[b],d=e.label,g=!0,k=1,h="\n";"space"===e.type&&(d="SPACE",g=!1,h="");var l=ui.config.sparkButtonWidth,m=ui.config.sparkButtonHeight,n=l-32,t=m+12-32,p=new c.ui.Shape(a,c.ui.roundRectShape);p.setColor(new c.graphics.Color(186,186,186,.05));p.setBounds(0,0,l,m+t/2+16-28);var q=ui.makeButtonAt(p,d+h,n/2+16,t+16-6,n,t);ui.applyTooltip(q,c.string.getString("STR_TEST_BUTTON_TOOLTIP"));p.refBut=q;a=new c.ui.TextBox("TEST");a.setBounds(q.getPosX(),q.getPosY()+8,q.size.x,q.size.y);
a.setColor(new c.graphics.Color(186,186,186,.35));a.setFontStyle("bold");a.setFontSize(120);a.centerText();a.setVisible(!1);p.appendSubElement(a);q.testLabel=a;e.inUI||(k=.35);g&&(q.costText=ui.makeSparkCostText(q,c.string.replaceTokens("{SPARK} "+e.sparkCost,[{key:"{SPARK}",value:c.ui.TextBox.makeSpecialImageString("mixer_spark_emblem")}]),8,.6*q.size.y,q.size.x-16,24),q.costText.enableDefaultSpecialFormatting());q.setOpacity(k);p.buttonIndex=b;q.setCallback(function(){var a="mixguess-sparkSpend"+
b,c=app.settings.playerActionButtons[b].chatMessage;q.getGlobalPos();q.getGlobalPos();peSync.giveControlInput(a,c,b,!0)});q.updateSelf=function(a){a=this.isHighlighted();a!==this.wasHighlighted&&(this.isHighlighted()?this.testLabel.setVisible(!0):this.testLabel.setVisible(!1),this.wasHighlighted=a)};e=ui.makeButtonAt(p,"edit",l/2,m/4,l,m/2,ui.config.BUTTON_MOD);sprite=new c.ui.Sprite(e);sprite.useImageRef(gfx.getImage("icon_edit"));sprite.setPos(12,10);e.setCallback(function(){window.ui.CustomizePlayerActionButton.open("Customize Button",
p.buttonIndex)});return p};d.prototype.makeButtons=function(){var a=this,b=[],e=Object.keys(app.settings.playerActionButtons).length;for(i=0;i<e;i++){var d=makeCustomizeButton(this,i);b.push(d)}this.placeButtons(b);this.buttonsList=b;b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),this.size.x/2,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,c.string.getString("STR_MENU_EXIT_TOOLTIP"));b.setCallback(function(){app.settings.rebuildSparkBoard=
!0;a.closeScreen()});this.exitButton=b;this.autoBuildInputMap(!0,!0,2,4);this.inputMap.navigateSound="navigate"};d.prototype.onRebuild=function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();this.setPos(this.getPosX(),this.getPosY()-16);
this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement)};d.prototype.updateSelf=function(a){a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a;if(this.lastKnownRoundActive!==peSync.knownGlobalState.roundIsActive){if(0<this.onlyDuringRoundButtons.length)for(i=0;i<this.onlyDuringRoundButtons.length;i++)updateActiveState(this.onlyDuringRoundButtons[i],peSync.knownGlobalState.roundIsActive);this.lastKnownRoundActive=peSync.knownGlobalState.roundIsActive}app.settings.rebuildCustomizeSparkBoard&&
c.screenManager.isTopScreen(this)&&(this.closeScreen(),window.ui.CustomizePlayerActionMenu.open(!0))};d.prototype.updateUIIcons=function(){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.closeScreen(),!0}return!1};d.prototype.destroy=
function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.open=function(a){app.settings.rebuildCustomizeSparkBoard=!1;!this.screen||a?this.screen=new d:c.screenManager.pushScreen(this.screen)};window.ui.CustomizePlayerActionMenu=d});
rat.modules.add("js.ui.favorites_screen",[{name:"rat.ui.r_screen",processBefore:!0},"rat.utils.r_string","rat.ui.r_ui_listbox","js.data.offer_lists",{name:"js.ui.ui",processBefore:!0}],function(c){var d=function(a,b){d.prototype.parentConstructor.call(this);this.editingLists=a;this.editScreen=b;app.offerLists.sortRecentList(a.recents);this.setSize(800,750);this.centerInDisplay();var c=this.getPos();this.setPos(c.x+32,c.y+32);ui.makeStandardModPopupBackground(this);this.setModal(!0);this.setAllowClickAway(!0);
this.setAllowBackClose(!0);this.makeRecents(a.recents,b);this.makeButtons()};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.makeRecents=function(a,b){var e=this;ui.makeLabel(this,"Favorites / Recents",50,30,200,36).setWidth(800);var d=new c.ui.Element(e);d.setBounds(50,70,700,500);d.setFrame(5,ui.config.modPopBorderColor);for(var g=[],k=[],h=0;h<a.length;h++){var l=a[h],m=l.name;m&&(k.push(l),m=m.replace(/[\n\r]+/g," "),65<m.length&&(m=m.substring(0,65),m+="\u2026"),m=ui.formatText(m),g.push(m))}l=
c.ui.Button.createStandardColorStates(new c.graphics.Color(0,0,0,0),0);a=c.ui.Button.getMatchingState(l,c.ui.Element.enabledFlag|c.ui.Element.highlightedFlag);a.color=new c.graphics.Color(128,128,128,.5);for(h=0;h<l.length;h++)l[h].textColor=new c.graphics.Color(250,250,250);d=new c.ui.ListBox(d);d.sizeToParent();d.insetBounds(5);d.buildFromListText(g,{fontHeight:40,selectCallback:function(a){0>a||(b.applyOfferValues(k[a]),e.close())},listColorStates:l});for(h=0;h<k.length;h++){g=d.getItem(h);g.setWidth(g.getWidth()-
42-10);g.setPosX(g.getPosX()+42+10);g.getTextBox().enableDefaultSpecialFormatting();1===h%2&&(a=g.getMyMatchingState(c.ui.Element.enabledFlag),a.color=new c.graphics.Color(128,128,128,.1));a=new c.ui.Button(d,c.ui.Button.spriteType);l=gfx.getImage("icon_favorites_off");m=gfx.getImage("icon_favorites_off_high");var n=gfx.getImage("icon_favorites_on"),t=gfx.getImage("icon_favorites_on_high"),p=c.ui.Element;a.setStateImages([{state:p.enabledFlag,imageRef:l},{state:p.enabledFlag|p.highlightedFlag,imageRef:m},
{state:p.enabledFlag|p.pressedFlag,imageRef:n},{state:p.enabledFlag|p.highlightedFlag|p.pressedFlag,imageRef:n},{state:p.enabledFlag|p.toggledFlag,imageRef:n},{state:p.enabledFlag|p.toggledFlag|p.highlightedFlag,imageRef:t},{state:p.enabledFlag|p.toggledFlag|p.pressedFlag,imageRef:l}]);a.setPos(5,g.getPosY()-4);a.setSize(42,42);a.setScale(.9,.9);a.setToggles(!0);k[h].isFavorite&&a.setToggled(!0);a.setCallback(function(a,b){k[b].isFavorite=a.isToggled();e.editingLists.saveToAppSettings()},h)}};d.prototype.makeButtons=
function(a){a=this;var b=this.getSize(),c=b.x/3*2+20,d=b.y-60;c=ui.makeButtonAt(a,"Close",c,d);c.setCallback(function(b,c){a.close();return!0});ui.setStandardButtonProperties(c,ui.config.BUTTON_MOD);c=b.x/3-20;d=b.y-60;c=ui.makeButtonAt(a,"Save Favorites as Preset",c,d);c.setCallback(function(a,b){app.offerLists.saveFavoritesAsPresetFile();return!0});ui.setStandardButtonProperties(c,ui.config.BUTTON_MOD)};d.prototype.close=function(){c.screenManager.popScreen(self)};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,
"favorites screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"favorites screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay()};d.prototype.updateSelf=function(a){};d.make=function(a,b,e){a=new d(a,b,e);c.screenManager.pushScreen(a)};window.ui.FavoritesScreen=d});
rat.modules.add("js.data.offer_lists",[],function(c){var d={recents:[],favorites:[],nextInSequence:0,restoreSaved:function(){app.settings.savedLists&&(d.recents=app.settings.savedLists.recents||[],d.favorites=app.settings.savedLists.favorites||[],d.nextInSequence=app.settings.savedLists.nextInSequence||0)},findSameOffer:function(a,b){for(var c=0;c<a.length;c++)if(d.sameOfferValues(b,a[c]))return c;return-1},sameOfferValues:function(a,b){return a.name===b.name&&a.lockTimer===b.lockTimer&&a.betTimer===
b.betTimer&&a.summary===b.summary&&a.multiplier===b.multiplier},addToRecentList:function(a){var b=d.recents,e=d.findSameOffer(b,a);-1<e&&b.splice(e,1);a.sequence=d.nextInSequence;a=c.utils.copyObject(a,!0);b.unshift(a);d.sortRecentList(b);30<b.length&&b.pop();d.nextInSequence++;d.saveToAppSettings(b)},saveToAppSettings:function(a){a=void 0===a?null:a;app.settings.savedLists=app.settings.savedLists||{};null!=a&&(app.settings.savedLists.recents=a);app.settings.savedLists.nextInSequence=d.nextInSequence;
app.writeSettings()},sortRecentList:function(a){a=a||d.recents;a.sort(function(a,c){return a.isFavorite&&!c.isFavorite?-1:c.isFavorite&&!a.isFavorite?1:(c.sequence||0)-(a.sequence||0)})},saveFavoritesAsPresetFile:function(){d.saveLocalPresetFile(d.recents,"favorites.json","favorites")},saveLocalPresetFile:function(a,b,c){for(var d=[],e=0;e<a.length;e++)a[e].isFavorite&&d.push({summary:a[e].summary,name:a[e].name,multiplier:a[e].multiplier,lockTimer:a[e].lockTimer,betTimer:a[e].betTimer});c=JSON.stringify({label:c,
order:100,offers:d});a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(c));a.setAttribute("download",b);document.createEvent?(b=document.createEvent("MouseEvents"),b.initEvent("click",!0,!0),a.dispatchEvent(b)):a.click()}};app.offerLists=d});
rat.modules.add("js.ui.customize_player_action_button_screen",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.toggle_control","js.ui.settings_menu","js.ui.customize_player_action_command_screen","js.ui.customize_player_action_cooldown_screen"],function(c){var d=function(a,b,e){this.title=a;this.offset=e||{x:0,y:0};this.buttonIndex=b;this.buttonRef=app.settings.playerActionButtons[b];this.lastScreenStackLength=
c.screenManager.screenStack.length;d.prototype.parentConstructor.call(this);this.setSize(1048,980);this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);this.setAllowClickAway(!0);this.makeControls();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=
function(){c.screenManager.removeScreen(this)};d.prototype.makeControls=function(){var a=this,b=[];switch(this.buttonRef.type){case "giveCredits":b=[ui.SettingsMenu.controls.playerActionInUI,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.playerActionSparkSpendEffectToggle,ui.SettingsMenu.controls.playerActionButtonCooldown,ui.SettingsMenu.controls.playerActionButtonIcon,ui.SettingsMenu.controls.playerActionButtonCommand,ui.SettingsMenu.controls.playerActionChatMessage];break;case "space":b=
[ui.SettingsMenu.controls.playerActionInUI,ui.SettingsMenu.controls.playerActionButtonType,ui.SettingsMenu.controls.blankSpace];break;default:b=[ui.SettingsMenu.controls.playerActionInUI,ui.SettingsMenu.controls.playerActionButtonType,ui.SettingsMenu.controls.playerActionSparkSpendEffectToggle,ui.SettingsMenu.controls.playerActionButtonCooldown,ui.SettingsMenu.controls.playerActionButtonIcon,ui.SettingsMenu.controls.playerActionButtonCommand,ui.SettingsMenu.controls.playerActionButtonCost,ui.SettingsMenu.controls.blankSpace,
ui.SettingsMenu.controls.playerActionButtonText,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.playerActionButtonTooltip,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.playerActionChatMessage]}window.ui.SettingsMenu.addControls(b,this);b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),.35*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,"Close this menu and save any changes");b.setCallback(function(){a.controlArray.forEach(function(a){"function"===
typeof a.paneAutoSaveContentOnExit&&a.paneAutoSaveContentOnExit()});app.settings.rebuildCustomizeSparkBoard=!0;a.closeScreen()});this.exitButton=b;b=ui.makeButtonAt(this,c.string.getString("STR_CANCEL"),.65*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,"Discard unsaved changes and close this menu");b.setCallback(function(){app.settings.rebuildCustomizeSparkBoard=!0;a.closeScreen()});this.cancelButton=b;this.autoBuildInputMap(!0,
!0,2,4)};d.prototype.onRebuild=function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"settings screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(i=
0;i<this.controlArray.length;i++)this.controlArray[i].updatePos&&(console.log("check passed"),this.controlArray[i].updatePos())};d.prototype.updateSelf=function(a){c.screenManager.screenStack.length!==this.lastScreenStackLength&&(this.editDiv&&(c.screenManager.isTopScreen(this)?this.editDiv.style.visibility="visible":this.editDiv.style.visibility="hidden"),this.lastScreenStackLength=c.screenManager.screenStack.length);a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=
a};d.prototype.updateUIIcons=function(){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.exitButton.trigger(),!0}return!1};d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),
this.editDiv=null)};d.open=function(a,b,c){new d(a,b,c)};window.ui.CustomizePlayerActionButton=d});
rat.modules.add("js.ui.customize_player_action_command_screen",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.toggle_control","js.ui.settings_menu"],function(c){var d=function(a,b,e){console.log("buttonIndex");console.log(b);this.title=a;this.offset=e||{x:0,y:0};this.buttonIndex=b;this.buttonRef=app.settings.playerActionButtons[b];d.prototype.parentConstructor.call(this);this.setSize(1048,980);this.centerInDisplay();
this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);this.setAllowClickAway(!0);this.makeControls();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=function(){c.screenManager.removeScreen(this)};d.prototype.makeControls=function(){var a=this;window.ui.SettingsMenu.addControls([ui.SettingsMenu.controls.whisperActionCommandToggle,
ui.SettingsMenu.controls.whisperActionCommandTarget,ui.SettingsMenu.controls.actionRequiredUserCount,ui.SettingsMenu.controls.actionCommandDelay,ui.SettingsMenu.controls.actionCommand],this);var b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),.35*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,"Close this menu and save any changes");b.setCallback(function(){a.controlArray.forEach(function(a){"function"===typeof a.paneAutoSaveContentOnExit&&
a.paneAutoSaveContentOnExit()});app.settings.rebuildCustomizeSparkBoard=!0;a.closeScreen()});this.exitButton=b;b=ui.makeButtonAt(this,c.string.getString("STR_CANCEL"),.65*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,"Discard unsaved changes and close this menu");b.setCallback(function(){app.settings.rebuildCustomizeSparkBoard=!0;a.closeScreen()});this.cancelButton=b;this.autoBuildInputMap(!0,!0,2,4)};d.prototype.onRebuild=
function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"customize player action command screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"customize player action command screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);
for(i=0;i<this.controlArray.length;i++)this.controlArray[i].updatePos&&(console.log("check passed"),this.controlArray[i].updatePos())};d.prototype.updateSelf=function(a){a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=function(){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();
if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.exitButton.trigger(),!0}return!1};d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.open=function(a,b,c){new d(a,b,c)};window.ui.CustomizePlayerActionCommand=d});
rat.modules.add("js.ui.customize_player_action_cooldown_screen",[{name:"rat.ui.r_screen",processBefore:!0},{name:"js.ui.ui",processBefore:!0},"rat.utils.r_string",{name:"js.app",processBefore:!0},"js.ui.toggle_control","js.ui.settings_menu"],function(c){var d=function(a,b,e){this.title=a;this.offset=e||{x:0,y:0};this.buttonIndex=b;this.buttonRef=app.settings.playerActionButtons[b];this.lastKnowGlobalCoolDownToggle=app.settings.playerActionButtons[this.buttonIndex].globalCooldownToggle;d.prototype.parentConstructor.call(this);
this.setSize(1048,980);this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,this.getPosY()+this.offset.y);this.backgroundBox=ui.makeStandardPopupBackground(this);this.titleBox=ui.makeTitleBox(this,ui.formatText(a));this.titleBox.enableDefaultSpecialFormatting();this.setModal(!0);this.setAllowClickAway(!0);this.makeControls();c.screenManager.pushScreen(this)};c.utils.inheritClassFrom(d,c.ui.Screen);d.prototype.closeScreen=function(){c.screenManager.removeScreen(this)};d.prototype.makeControls=
function(){var a=this;window.ui.SettingsMenu.addControls([ui.SettingsMenu.controls.playerActionCooldownGlobalToggle,ui.SettingsMenu.controls.playerActionGlobalCooldownValue,ui.SettingsMenu.controls.playerActionCooldownValue,ui.SettingsMenu.controls.blankSpace,ui.SettingsMenu.controls.playerActionUserCooldownValue],this);var b=ui.makeButtonAt(this,c.string.getString("STR_MENU_EXIT"),.35*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,
"Close this menu and save any changes");b.setCallback(function(){a.controlArray.forEach(function(a){"function"===typeof a.paneAutoSaveContentOnExit&&a.paneAutoSaveContentOnExit()});app.settings.rebuildCustomizeSparkBoard=!0;a.closeScreen()});this.exitButton=b;b=ui.makeButtonAt(this,c.string.getString("STR_CANCEL"),.65*this.size.x,this.size.y-ui.config.menuButtonHeight,ui.config.menuButtonWidth,ui.config.menuButtonHeight);ui.applyTooltip(b,"Discard unsaved changes and close this menu");b.setCallback(function(){app.settings.rebuildCustomizeSparkBoard=
!0;a.closeScreen()});this.cancelButton=b;this.autoBuildInputMap(!0,!0,2,4)};d.prototype.onRebuild=function(){this.closeScreen()};d.prototype.myScreenActivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"customize player action command screen activated.")};d.prototype.myScreenDeactivate=function(){console.info(logFile.LOG_TYPES.UI_EVENTS,"customize player action command screen deactivated.")};d.prototype.onWindowResize=function(){this.centerInDisplay();this.setPos(this.getPosX()+this.offset.x,
this.getPosY()+this.offset.y);this.editDiv&&c.graphics.layerDiv.updateScale(this.editDiv,app.canvasElement);for(i=0;i<this.controlArray.length;i++)this.controlArray[i].updatePos&&(console.log("check passed"),this.controlArray[i].updatePos())};d.prototype.updateSelf=function(a){app.settings.playerActionButtons[this.buttonIndex].globalCooldownToggle!==this.lastKnowGlobalCoolDownToggle&&(this.closeScreen(),d.open(this.title,this.buttonIndex,this.offset));this.lastKnowGlobalCoolDownToggle=app.settings.playerActionButtons[this.buttonIndex].globalCooldownToggle;
a=game.hud.useButtonIcons;a!==this.prevUseButtonIcons&&this.updateUIIcons();this.prevUseButtonIcons=a};d.prototype.updateUIIcons=function(){};d.prototype.mouseDown=function(a,b){return!1};d.prototype.handleKeyDown=function(a){return a.which===c.keys.esc?(this.closeScreen(),!0):!1};d.prototype.handleButtonDown=function(a){app.xboxMixerPreventExit();if(!0===ui.shouldPreventButtonInput())return!0;switch(a.which){case c.input.BUTTON_B:case c.input.BUTTON_START:return this.exitButton.trigger(),!0}return!1};
d.prototype.destroy=function(){app.canvasElement.focus();this.editDiv&&(this.editDiv.parentNode.removeChild(this.editDiv),this.editDiv=null)};d.open=function(a,b,c){new d(a,b,c)};window.ui.CustomizePlayerActionCooldown=d});app.versionInfo={};app.versionInfo.version="13451e";app.versionInfo.localMods="+m";app.versionInfo.date="2019/05/06 15:34:29";
